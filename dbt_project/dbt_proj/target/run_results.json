{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2024-12-27T12:28:17.264390Z", "invocation_id": "c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:15.840244Z", "completed_at": "2024-12-27T12:28:15.840244Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:15.855837Z", "completed_at": "2024-12-27T12:28:16.272079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4318349361419678, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.avg_duration_distance", "compiled": true, "compiled_code": "WITH CTE AS (\r\nSELECT \r\n    CASE \r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN 'Late Night'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN 'Morning'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN 'Afternoon'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN 'Evening'\r\n    END AS time_of_day,\r\n    AVG(trip_time / 60.0) AS avg_duration_minutes, -- Converts trip_time from seconds to minutes\r\n    AVG(trip_miles) AS avg_distance_miles\r\nFROM dbo.base_trip_data\r\nGROUP BY \r\n    CASE \r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN 'Late Night'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN 'Morning'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN 'Afternoon'\r\n        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN 'Evening'\r\n    END)\r\n\r\nSELECT * FROM cte;", "relation_name": "\"dbt_project\".\"dbo\".\"avg_duration_distance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:16.287701Z", "completed_at": "2024-12-27T12:28:16.287701Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:16.287701Z", "completed_at": "2024-12-27T12:28:16.572637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28493595123291016, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.base_trip_data", "compiled": true, "compiled_code": "WITH cleaned_data AS (\r\nSELECT\r\n    newid() as FHV_Trip_ID,\r\n    hvfhs_license_num,\r\n    dispatching_base_num,\r\n    originating_base_num,\r\n    CONVERT(datetime, request_datetime) AS request_datetime,\r\n    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,\r\n    CONVERT(datetime, pickup_datetime) AS pickup_datetime,\r\n    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,\r\n    PULocationID,\r\n    DOLocationID,\r\n    trip_miles,\r\n    trip_time,\r\n    base_passenger_fare,\r\n    tolls,\r\n    bcf,\r\n    sales_tax,\r\n    congestion_surcharge,\r\n    airport_fee,\r\n    tips,\r\n    driver_pay\r\nFROM [dbo].[FHV_Trip_Records]\r\nWHERE \r\n    -- Exclude rows with missing or invalid trip data\r\n    trip_miles IS NOT NULL AND trip_time IS NOT NULL\r\n    AND base_passenger_fare IS NOT NULL\r\n    -- Remove rows with zero values for key metrics\r\n    AND trip_miles > 0 AND trip_time > 0\r\n    -- Keep rows with valid PULocationID and DOLocationID\r\n    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL\r\n)\r\n\r\nSELECT * FROM cleaned_data", "relation_name": "\"dbt_project\".\"dbo\".\"base_trip_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:16.572637Z", "completed_at": "2024-12-27T12:28:16.588259Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:16.588259Z", "completed_at": "2024-12-27T12:28:16.710341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13770365715026855, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.daily_trip_trend", "compiled": true, "compiled_code": "WITH CTE AS (\r\nSELECT\r\n    FORMAT(pickup_datetime, 'yyyy-MM-dd') AS trip_month,\r\n    COUNT(FHV_Trip_ID) AS total_trips\r\nFROM dbo.base_trip_data\r\nGROUP BY  FORMAT(pickup_datetime, 'yyyy-MM-dd'))\r\n\r\nSELECT * FROM CTE", "relation_name": "\"dbt_project\".\"dbo\".\"daily_trip_trend\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:16.725995Z", "completed_at": "2024-12-27T12:28:16.725995Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:16.725995Z", "completed_at": "2024-12-27T12:28:16.843404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13306331634521484, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.location_details", "compiled": true, "compiled_code": "WITH LocationDetails AS (\r\n    SELECT \r\n    FHV_Trip_ID,  \r\n    PULocationID AS pickup_location_id,\r\n    DOLocationID AS dropoff_location_id\r\nFROM dbo.base_trip_data\r\n)\r\n-- Select distinct location details\r\nSELECT *\r\nFROM LocationDetails;", "relation_name": "\"dbt_project\".\"dbo\".\"location_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:16.859027Z", "completed_at": "2024-12-27T12:28:16.859027Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:16.859027Z", "completed_at": "2024-12-27T12:28:16.976268Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13286423683166504, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.temporal_data", "compiled": true, "compiled_code": "with cte as (\r\nSELECT \r\n    FHV_Trip_ID,  \r\n    CONVERT(DATE, request_datetime) AS request_date,\r\n    DATEPART(HOUR, request_datetime) AS request_hour,\r\n    CONVERT(DATE, pickup_datetime) AS pickup_date,\r\n    DATEPART(HOUR, pickup_datetime) AS pickup_hour,\r\n    CONVERT(DATE, dropoff_datetime) AS dropoff_date,\r\n    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour\r\nFROM dbo.base_trip_data)\r\n\r\nselect * from cte", "relation_name": "\"dbt_project\".\"dbo\".\"temporal_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:16.991919Z", "completed_at": "2024-12-27T12:28:16.991919Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:16.991919Z", "completed_at": "2024-12-27T12:28:17.077542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08662009239196777, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.top_5_pickup_locations", "compiled": true, "compiled_code": "WITH CTE AS (\r\nSELECT TOP 5\r\n    PULocationID AS pickup_location_id,\r\n    COUNT(FHV_Trip_ID) AS total_trips\r\nFROM dbo.base_trip_data\r\nGROUP BY PULocationID\r\nORDER BY total_trips DESC)\r\n\r\nSELECT * FROM CTE", "relation_name": "\"dbt_project\".\"dbo\".\"top_5_pickup_locations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-27T12:28:17.083144Z", "completed_at": "2024-12-27T12:28:17.086136Z"}, {"name": "execute", "started_at": "2024-12-27T12:28:17.086136Z", "completed_at": "2024-12-27T12:28:17.240980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1744546890258789, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_proj.trips", "compiled": true, "compiled_code": "With cte as (SELECT \r\n    FHV_Trip_ID\r\n    hvfhs_license_num,\r\n    dispatching_base_num,\r\n    originating_base_num,\r\n    trip_miles,\r\n    trip_time,\r\n    base_passenger_fare,\r\n    tolls,\r\n    bcf,\r\n    sales_tax,\r\n    congestion_surcharge,\r\n    airport_fee,\r\n    tips,\r\n    driver_pay\r\nFROM dbo.base_trip_data)\r\n\r\nselect * from cte", "relation_name": "\"dbt_project\".\"dbo\".\"trips\""}], "elapsed_time": 1.599057674407959, "args": {"macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "print": true, "profiles_dir": "C:\\Users\\mhamza\\.dbt", "introspect": true, "favor_state": false, "exclude": [], "invocation_command": "dbt run", "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "quiet": false, "select": [], "strict_mode": false, "printer_width": 80, "use_colors_file": true, "log_level_file": "debug", "use_colors": true, "log_path": "Z:\\Archives\\dbt_Project\\dbt_proj\\logs", "show_resource_report": false, "write_json": true, "indirect_selection": "eager", "defer": false, "partial_parse": true, "version_check": true, "which": "run", "log_format_file": "debug", "static_parser": true, "project_dir": "Z:\\Archives\\dbt_Project\\dbt_proj", "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "vars": {}, "empty": false, "populate_cache": true, "log_format": "default", "log_level": "info", "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false}}