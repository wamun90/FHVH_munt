[0m12:54:05.141130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E7665A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D263C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2EEA5940>]}


============================== 12:54:05.145115 | c084076b-a150-41a9-847e-d8e92c53905a ==============================
[0m12:54:05.145115 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:54:05.146084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:05.162043 [info ] [MainThread]: dbt version: 1.8.9
[0m12:54:05.163040 [info ] [MainThread]: python version: 3.12.2
[0m12:54:05.164037 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m12:54:05.166031 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:54:05.453284 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m12:54:05.454269 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m12:54:05.455043 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m12:54:05.544812 [info ] [MainThread]: Configuration:
[0m12:54:05.545809 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:54:05.546807 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:54:05.547803 [info ] [MainThread]: Required dependencies:
[0m12:54:05.548803 [debug] [MainThread]: Executing "git --help"
[0m12:54:05.589691 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:54:05.590689 [debug] [MainThread]: STDERR: "b''"
[0m12:54:05.591687 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:54:05.592683 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:54:05.593681 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:54:05.594680 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_proj", target "dev" invalid: 'schema' is a required property


[0m12:54:05.596673 [debug] [MainThread]: Command `dbt debug` failed at 12:54:05.596673 after 0.59 seconds
[0m12:54:05.596673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2F590350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2F41E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CE1EDE0>]}
[0m12:54:05.597671 [debug] [MainThread]: Flushing usage events
[0m12:58:17.201806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B19E5E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222ADF163C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B0FAF230>]}


============================== 12:58:17.205795 | 6688cc1b-a95c-4edd-999c-44ddb9fea7bb ==============================
[0m12:58:17.205795 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:17.205795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:17.222750 [info ] [MainThread]: Setting up your profile.
[0m13:06:18.505603 [info ] [MainThread]: Profile dbt_proj written to C:\Users\wmuntu\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:06:18.507596 [debug] [MainThread]: Command `dbt init` succeeded at 13:06:18.507596 after 481.54 seconds
[0m13:06:18.507596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222ADF163C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222AB915400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222AF7E8380>]}
[0m13:06:18.508594 [debug] [MainThread]: Flushing usage events
[0m13:06:27.826555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDD9563C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCE04E6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCE04E5E50>]}


============================== 13:06:27.830546 | 0105e8ab-ad3e-49f6-9003-666e7e574ca2 ==============================
[0m13:06:27.830546 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:06:27.831597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:27.846560 [info ] [MainThread]: dbt version: 1.8.9
[0m13:06:27.847557 [info ] [MainThread]: python version: 3.12.2
[0m13:06:27.848555 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:06:27.849553 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:06:28.171689 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:06:28.172687 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:06:28.174682 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:06:28.342234 [info ] [MainThread]: Configuration:
[0m13:06:28.343231 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:06:28.344228 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:06:28.345226 [info ] [MainThread]: Required dependencies:
[0m13:06:28.346223 [debug] [MainThread]: Executing "git --help"
[0m13:06:28.419028 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:06:28.420026 [debug] [MainThread]: STDERR: "b''"
[0m13:06:28.422020 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:06:28.423018 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:06:28.424014 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:06:28.425012 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_proj", target "dev" invalid: 'schema' is a required property


[0m13:06:28.427006 [debug] [MainThread]: Command `dbt debug` failed at 13:06:28.427006 after 0.75 seconds
[0m13:06:28.427006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCE2FFA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCE16E6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCE1CDD580>]}
[0m13:06:28.428004 [debug] [MainThread]: Flushing usage events
[0m13:12:40.472330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE6851A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE2FB53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE6851AC0>]}


============================== 13:12:40.476321 | f7f6ed60-e40e-422e-a8af-18a07cdea763 ==============================
[0m13:12:40.476321 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:12:40.477319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:12:40.492278 [info ] [MainThread]: Setting up your profile.
[0m13:16:04.201505 [info ] [MainThread]: Profile dbt_proj written to C:\Users\wmuntu\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:16:04.203499 [debug] [MainThread]: Command `dbt init` succeeded at 13:16:04.203499 after 203.86 seconds
[0m13:16:04.203499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE61151F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE6071F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DE5D17320>]}
[0m13:16:04.204496 [debug] [MainThread]: Flushing usage events
[0m13:16:20.574552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16A07DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16AEAB7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16A6E36B0>]}


============================== 13:16:20.578542 | 221cc8be-adae-43e9-b738-3d41160b261d ==============================
[0m13:16:20.578542 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:16:20.579539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:20.602478 [info ] [MainThread]: dbt version: 1.8.9
[0m13:16:20.603475 [info ] [MainThread]: python version: 3.12.2
[0m13:16:20.604473 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:16:20.605470 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:16:20.954564 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:16:20.955567 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:16:20.956559 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:16:21.066093 [info ] [MainThread]: Configuration:
[0m13:16:21.067090 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:16:21.068087 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:16:21.068087 [info ] [MainThread]: Required dependencies:
[0m13:16:21.069086 [debug] [MainThread]: Executing "git --help"
[0m13:16:21.119949 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:16:21.119949 [debug] [MainThread]: STDERR: "b''"
[0m13:16:21.121944 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:16:21.122940 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:16:21.123939 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:16:21.124938 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_proj", target "dev" invalid: 'schema' is a required property


[0m13:16:21.126931 [debug] [MainThread]: Command `dbt debug` failed at 13:16:21.126931 after 0.70 seconds
[0m13:16:21.126931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16A44ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16A448110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16B4F1AC0>]}
[0m13:16:21.127929 [debug] [MainThread]: Flushing usage events
[0m13:26:39.624849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5E91C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5E91BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5E91AC0>]}


============================== 13:26:39.628838 | 4d8f0a06-114d-4b92-9117-d61c7683c387 ==============================
[0m13:26:39.628838 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:26:39.628838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:39.643829 [info ] [MainThread]: dbt version: 1.8.9
[0m13:26:39.643829 [info ] [MainThread]: python version: 3.12.2
[0m13:26:39.644796 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:26:39.645886 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:26:39.646482 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 6
  ------------------------------
  3  |     dev:
  4  |       type: sqlserver
  5  |       driver: "ODBC Driver 17 for SQL Server"
  6  |       server: "Calrom-dev161\SQLEXPRESS01"
  7  |       port: 1433
  8  |       user: "dev"
  9  |       password: "admin"
  
  Raw Error:
  ------------------------------
  while parsing a quoted scalar
    in "<unicode string>", line 6, column 15
  found unknown escape character
    in "<unicode string>", line 6, column 29
[0m13:26:39.650282 [debug] [MainThread]: Command `dbt debug` failed at 13:26:39.650282 after 0.12 seconds
[0m13:26:39.651285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5C0F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C510FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5D74CB0>]}
[0m13:26:39.651285 [debug] [MainThread]: Flushing usage events
[0m13:28:53.851391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B2FD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B2FD1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B2FD1B20>]}


============================== 13:28:53.855382 | 5a620eb3-3a2e-46a4-88f1-ee567d046602 ==============================
[0m13:28:53.855382 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:28:53.856381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:53.868377 [info ] [MainThread]: dbt version: 1.8.9
[0m13:28:53.869374 [info ] [MainThread]: python version: 3.12.2
[0m13:28:53.870344 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:28:53.871341 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:28:53.872338 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 6
  ------------------------------
  3  |     dev:
  4  |       type: sqlserver
  5  |       driver: "ODBC Driver 17 for SQL Server"
  6  |       server: "Calrom-dev161\SQLEXPRESS01"
  7  |       port: 1433
  8  |       user: "dev"
  9  |       password: "admin"
  
  Raw Error:
  ------------------------------
  while parsing a quoted scalar
    in "<unicode string>", line 6, column 15
  found unknown escape character
    in "<unicode string>", line 6, column 29
[0m13:28:53.876415 [debug] [MainThread]: Command `dbt debug` failed at 13:28:53.876415 after 0.11 seconds
[0m13:28:53.877412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B2B0F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B2E53110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B30AC0B0>]}
[0m13:28:53.877412 [debug] [MainThread]: Flushing usage events
[0m13:29:17.125683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C20A6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BEB672C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BEF00EF0>]}


============================== 13:29:17.129702 | 6f4ef1b8-5ebc-41c4-a73e-1efba7013486 ==============================
[0m13:29:17.129702 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:29:17.130671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:29:17.145658 [info ] [MainThread]: dbt version: 1.8.9
[0m13:29:17.146627 [info ] [MainThread]: python version: 3.12.2
[0m13:29:17.146627 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:29:17.147624 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:29:17.151615 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:29:17.152612 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:29:17.153610 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:29:17.275314 [info ] [MainThread]: Configuration:
[0m13:29:17.276289 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:29:17.276289 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:29:17.277278 [info ] [MainThread]: Required dependencies:
[0m13:29:17.278276 [debug] [MainThread]: Executing "git --help"
[0m13:29:17.319165 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:29:17.320164 [debug] [MainThread]: STDERR: "b''"
[0m13:29:17.320164 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:29:17.321161 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:29:17.322159 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:29:17.323155 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_proj'


[0m13:29:17.325150 [debug] [MainThread]: Command `dbt debug` failed at 13:29:17.324153 after 0.34 seconds
[0m13:29:17.325150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BEF8D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BEB672C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C1A142C0>]}
[0m13:29:17.326147 [debug] [MainThread]: Flushing usage events
[0m13:30:30.812887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA3147B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA53447D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA5345B20>]}


============================== 13:30:30.817874 | 358a331e-2d9c-44c7-bd95-89f774d6588c ==============================
[0m13:30:30.817874 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:30:30.818872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:30:30.834829 [info ] [MainThread]: dbt version: 1.8.9
[0m13:30:30.835831 [info ] [MainThread]: python version: 3.12.2
[0m13:30:30.835831 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:30:30.836822 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:30:31.126050 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:30:31.127048 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:30:31.127048 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:30:31.128045 [info ] [MainThread]: adapter type: sqlserver
[0m13:30:31.129043 [info ] [MainThread]: adapter version: 1.8.5
[0m13:30:31.218832 [info ] [MainThread]: Configuration:
[0m13:30:31.219798 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:30:31.220567 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:30:31.221569 [info ] [MainThread]: Required dependencies:
[0m13:30:31.221569 [debug] [MainThread]: Executing "git --help"
[0m13:30:31.261464 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:30:31.262459 [debug] [MainThread]: STDERR: "b''"
[0m13:30:31.262459 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:30:31.263455 [info ] [MainThread]: Connection:
[0m13:30:31.265451 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:30:31.267445 [info ] [MainThread]:   database: dbt_project
[0m13:30:31.268441 [info ] [MainThread]:   schema: dbo
[0m13:30:31.269439 [info ] [MainThread]:   UID: dev
[0m13:30:31.270436 [info ] [MainThread]:   client_id: None
[0m13:30:31.270436 [info ] [MainThread]:   authentication: sql
[0m13:30:31.271435 [info ] [MainThread]:   encrypt: True
[0m13:30:31.272431 [info ] [MainThread]:   trust_cert: False
[0m13:30:31.273429 [info ] [MainThread]:   retries: 3
[0m13:30:31.274426 [info ] [MainThread]:   login_timeout: 0
[0m13:30:31.275424 [info ] [MainThread]:   query_timeout: 0
[0m13:30:31.276421 [info ] [MainThread]:   trace_flag: False
[0m13:30:31.277418 [info ] [MainThread]:   port: 1433
[0m13:30:31.278415 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:30:31.537723 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:30:31.538718 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:30:31.538718 [debug] [MainThread]: On debug: select 1 as id
[0m13:30:31.539716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:31.539716 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:30:31.584486 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:30:32.586016 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:30:32.600815 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:30:33.602688 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:30:33.624643 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:30:34.626801 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:30:34.641765 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:30:34.643761 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:30:34.644758 [debug] [MainThread]: On debug: No close available on handle
[0m13:30:34.645754 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:30:34.648748 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:30:34.650741 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:30:34.657725 [debug] [MainThread]: Command `dbt debug` failed at 13:30:34.657725 after 3.98 seconds
[0m13:30:34.658756 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:30:34.660751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA64632C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA5C16210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA788DE20>]}
[0m13:30:34.661713 [debug] [MainThread]: Flushing usage events
[0m13:31:36.215799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB53057AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB559A1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB559A3D10>]}


============================== 13:31:36.219752 | b3ad9ddf-870f-445b-ac2d-858ac7a5ad65 ==============================
[0m13:31:36.219752 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:31:36.220752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:31:36.238704 [info ] [MainThread]: dbt version: 1.8.9
[0m13:31:36.239701 [info ] [MainThread]: python version: 3.12.2
[0m13:31:36.240696 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:31:36.240696 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:31:36.550867 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:31:36.551865 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:31:36.552861 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:31:36.553193 [info ] [MainThread]: adapter type: sqlserver
[0m13:31:36.553906 [info ] [MainThread]: adapter version: 1.8.5
[0m13:31:36.649682 [info ] [MainThread]: Configuration:
[0m13:31:36.650650 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:31:36.651648 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:31:36.652645 [info ] [MainThread]: Required dependencies:
[0m13:31:36.652645 [debug] [MainThread]: Executing "git --help"
[0m13:31:36.697525 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:31:36.698522 [debug] [MainThread]: STDERR: "b''"
[0m13:31:36.699519 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:31:36.701514 [info ] [MainThread]: Connection:
[0m13:31:36.702513 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:31:36.703510 [info ] [MainThread]:   database: dbt_project
[0m13:31:36.704505 [info ] [MainThread]:   schema: dbo
[0m13:31:36.705504 [info ] [MainThread]:   UID: dev
[0m13:31:36.706502 [info ] [MainThread]:   client_id: None
[0m13:31:36.707513 [info ] [MainThread]:   authentication: sql
[0m13:31:36.708509 [info ] [MainThread]:   encrypt: True
[0m13:31:36.709493 [info ] [MainThread]:   trust_cert: False
[0m13:31:36.710492 [info ] [MainThread]:   retries: 3
[0m13:31:36.711487 [info ] [MainThread]:   login_timeout: 0
[0m13:31:36.712485 [info ] [MainThread]:   query_timeout: 0
[0m13:31:36.713482 [info ] [MainThread]:   trace_flag: False
[0m13:31:36.714478 [info ] [MainThread]:   port: 1433
[0m13:31:36.716475 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:31:36.978801 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:31:36.979801 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:31:36.979801 [debug] [MainThread]: On debug: select 1 as id
[0m13:31:36.979801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:36.980767 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:31:36.997421 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:31:37.998224 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:31:38.003214 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:31:39.004872 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:31:39.010856 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m13:31:40.011917 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.5
[0m13:31:40.016907 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:31:40.017934 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:31:40.017934 [debug] [MainThread]: On debug: No close available on handle
[0m13:31:40.018933 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:31:40.019900 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:31:40.019900 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:31:40.022896 [debug] [MainThread]: Command `dbt debug` failed at 13:31:40.022896 after 3.98 seconds
[0m13:31:40.023889 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:31:40.023889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB552C5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB5589C200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB551F7290>]}
[0m13:31:40.024887 [debug] [MainThread]: Flushing usage events
[0m13:34:34.637635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE31CD51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE323E5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE31D273E0>]}


============================== 13:34:34.641625 | 5fd6cf3e-b115-43df-a475-cd8c11dec280 ==============================
[0m13:34:34.641625 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:34:34.642621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:34.658582 [info ] [MainThread]: dbt version: 1.8.9
[0m13:34:34.659577 [info ] [MainThread]: python version: 3.12.2
[0m13:34:34.660587 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:34:34.661572 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:34:34.962794 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:34:34.963770 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:34:34.964761 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:34:34.965766 [info ] [MainThread]: adapter type: sqlserver
[0m13:34:34.966756 [info ] [MainThread]: adapter version: 1.8.5
[0m13:34:35.059507 [info ] [MainThread]: Configuration:
[0m13:34:35.060090 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:34:35.061091 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:34:35.061091 [info ] [MainThread]: Required dependencies:
[0m13:34:35.062096 [debug] [MainThread]: Executing "git --help"
[0m13:34:35.102977 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:34:35.103975 [debug] [MainThread]: STDERR: "b''"
[0m13:34:35.103975 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:34:35.104972 [info ] [MainThread]: Connection:
[0m13:34:35.105969 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:34:35.106966 [info ] [MainThread]:   database: dbt_project
[0m13:34:35.106966 [info ] [MainThread]:   schema: dbo
[0m13:34:35.107963 [info ] [MainThread]:   UID: dev
[0m13:34:35.108961 [info ] [MainThread]:   client_id: None
[0m13:34:35.108961 [info ] [MainThread]:   authentication: sql
[0m13:34:35.109958 [info ] [MainThread]:   encrypt: False
[0m13:34:35.110956 [info ] [MainThread]:   trust_cert: True
[0m13:34:35.111956 [info ] [MainThread]:   retries: 3
[0m13:34:35.112954 [info ] [MainThread]:   login_timeout: 0
[0m13:34:35.113948 [info ] [MainThread]:   query_timeout: 0
[0m13:34:35.114947 [info ] [MainThread]:   trace_flag: False
[0m13:34:35.115945 [info ] [MainThread]:   port: 1433
[0m13:34:35.116941 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:34:35.357326 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:34:35.357326 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:34:35.358326 [debug] [MainThread]: On debug: select 1 as id
[0m13:34:35.358326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:35.359326 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m13:34:35.381330 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:34:35.381330 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:34:35.382330 [debug] [MainThread]: On debug: No close available on handle
[0m13:34:35.382330 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:34:35.383328 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:34:35.384301 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dev'. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dev'. (18456)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:34:35.387324 [debug] [MainThread]: Command `dbt debug` failed at 13:34:35.387324 after 0.91 seconds
[0m13:34:35.387324 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:34:35.388323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE323E5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE334F0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE337E5E20>]}
[0m13:34:35.388323 [debug] [MainThread]: Flushing usage events
[0m13:35:02.864542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C1242450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C1241AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C12419A0>]}


============================== 13:35:02.868531 | d8ca1f22-8be5-475c-b916-1e03ce25f1b1 ==============================
[0m13:35:02.868531 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:35:02.869530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:35:02.886484 [info ] [MainThread]: dbt version: 1.8.9
[0m13:35:02.887486 [info ] [MainThread]: python version: 3.12.2
[0m13:35:02.888479 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:35:02.889476 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:35:03.186812 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:35:03.187812 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:35:03.188779 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:35:03.189776 [info ] [MainThread]: adapter type: sqlserver
[0m13:35:03.189776 [info ] [MainThread]: adapter version: 1.8.5
[0m13:35:03.279604 [info ] [MainThread]: Configuration:
[0m13:35:03.280574 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:35:03.281571 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:35:03.282174 [info ] [MainThread]: Required dependencies:
[0m13:35:03.283174 [debug] [MainThread]: Executing "git --help"
[0m13:35:03.322071 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:35:03.323068 [debug] [MainThread]: STDERR: "b''"
[0m13:35:03.323068 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:35:03.324066 [info ] [MainThread]: Connection:
[0m13:35:03.325063 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:35:03.326061 [info ] [MainThread]:   database: dbt_project
[0m13:35:03.326061 [info ] [MainThread]:   schema: dbo
[0m13:35:03.327057 [info ] [MainThread]:   UID: sa
[0m13:35:03.328054 [info ] [MainThread]:   client_id: None
[0m13:35:03.328054 [info ] [MainThread]:   authentication: sql
[0m13:35:03.329052 [info ] [MainThread]:   encrypt: False
[0m13:35:03.330050 [info ] [MainThread]:   trust_cert: True
[0m13:35:03.330050 [info ] [MainThread]:   retries: 3
[0m13:35:03.331046 [info ] [MainThread]:   login_timeout: 0
[0m13:35:03.332043 [info ] [MainThread]:   query_timeout: 0
[0m13:35:03.333042 [info ] [MainThread]:   trace_flag: False
[0m13:35:03.334039 [info ] [MainThread]:   port: 1433
[0m13:35:03.335036 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:35:03.576389 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:35:03.577386 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:35:03.577386 [debug] [MainThread]: On debug: select 1 as id
[0m13:35:03.578383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:03.578383 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={sa};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m13:35:03.598294 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:35:03.598294 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:35:03.599295 [debug] [MainThread]: On debug: No close available on handle
[0m13:35:03.599295 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:35:03.600355 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:35:03.601354 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'sa'. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'sa'. (18456)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:35:03.604375 [debug] [MainThread]: Command `dbt debug` failed at 13:35:03.603349 after 0.88 seconds
[0m13:35:03.604375 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:35:03.605344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3BD9B9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C1709400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C0FE0650>]}
[0m13:35:03.606341 [debug] [MainThread]: Flushing usage events
[0m13:35:53.461222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7E269340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F007B6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F007B5F40>]}


============================== 13:35:53.465214 | 9ba3d482-6e5d-4aa4-9bf9-afa1dbaf977f ==============================
[0m13:35:53.465214 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:35:53.466211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:35:53.480173 [info ] [MainThread]: dbt version: 1.8.9
[0m13:35:53.481171 [info ] [MainThread]: python version: 3.12.2
[0m13:35:53.482170 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:35:53.483167 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:35:53.870159 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:35:53.871127 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:35:53.871127 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:35:54.083559 [info ] [MainThread]: Configuration:
[0m13:35:54.084556 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:35:54.085553 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:35:54.086552 [info ] [MainThread]: Required dependencies:
[0m13:35:54.086552 [debug] [MainThread]: Executing "git --help"
[0m13:35:54.129436 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:35:54.130433 [debug] [MainThread]: STDERR: "b''"
[0m13:35:54.131432 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:35:54.132428 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:35:54.133426 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:35:54.134423 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_proj", target "dev" invalid: 'schema' is a required property


[0m13:35:54.136417 [debug] [MainThread]: Command `dbt debug` failed at 13:35:54.136417 after 0.83 seconds
[0m13:35:54.136417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0092DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7FB05CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7FB060F0>]}
[0m13:35:54.137419 [debug] [MainThread]: Flushing usage events
[0m13:36:20.381844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9154E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8EDD7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8DBA48F0>]}


============================== 13:36:20.385865 | f88d52b1-c0c5-4b01-a095-a4eb576e4456 ==============================
[0m13:36:20.385865 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:36:20.386830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:20.403810 [info ] [MainThread]: dbt version: 1.8.9
[0m13:36:20.404809 [info ] [MainThread]: python version: 3.12.2
[0m13:36:20.405780 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:36:20.406778 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:36:20.683038 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:36:20.684230 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:36:20.685231 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:36:20.685231 [info ] [MainThread]: adapter type: sqlserver
[0m13:36:20.686257 [info ] [MainThread]: adapter version: 1.8.5
[0m13:36:20.777982 [info ] [MainThread]: Configuration:
[0m13:36:20.778979 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:36:20.779977 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:20.780974 [info ] [MainThread]: Required dependencies:
[0m13:36:20.781971 [debug] [MainThread]: Executing "git --help"
[0m13:36:20.823860 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:36:20.823860 [debug] [MainThread]: STDERR: "b''"
[0m13:36:20.824886 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:36:20.825853 [info ] [MainThread]: Connection:
[0m13:36:20.826857 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:36:20.826857 [info ] [MainThread]:   database: dbt_project
[0m13:36:20.827848 [info ] [MainThread]:   schema: dbo
[0m13:36:20.828846 [info ] [MainThread]:   UID: dev
[0m13:36:20.828846 [info ] [MainThread]:   client_id: None
[0m13:36:20.829843 [info ] [MainThread]:   authentication: sql
[0m13:36:20.830841 [info ] [MainThread]:   encrypt: False
[0m13:36:20.831842 [info ] [MainThread]:   trust_cert: True
[0m13:36:20.832837 [info ] [MainThread]:   retries: 3
[0m13:36:20.833832 [info ] [MainThread]:   login_timeout: 0
[0m13:36:20.834830 [info ] [MainThread]:   query_timeout: 0
[0m13:36:20.834830 [info ] [MainThread]:   trace_flag: False
[0m13:36:20.835829 [info ] [MainThread]:   port: 1433
[0m13:36:20.837827 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:36:21.102114 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:36:21.103112 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:36:21.103112 [debug] [MainThread]: On debug: select 1 as id
[0m13:36:21.103112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:21.104109 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dev};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m13:36:21.123031 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:36:21.124057 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:36:21.124057 [debug] [MainThread]: On debug: No close available on handle
[0m13:36:21.125026 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:36:21.126023 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:36:21.126023 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dev'. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dev'. (18456)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:36:21.129232 [debug] [MainThread]: Command `dbt debug` failed at 13:36:21.129232 after 0.91 seconds
[0m13:36:21.130248 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:36:21.130248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A917884A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A934BFBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A93483E30>]}
[0m13:36:21.130248 [debug] [MainThread]: Flushing usage events
[0m13:38:13.434476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B103A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B103350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169A3470E0>]}


============================== 13:38:13.438464 | 1daf5d9c-6c9b-4ee0-9148-8b594c2879fb ==============================
[0m13:38:13.438464 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:38:13.439470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:38:13.453422 [info ] [MainThread]: dbt version: 1.8.9
[0m13:38:13.453991 [info ] [MainThread]: python version: 3.12.2
[0m13:38:13.454993 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:38:13.455990 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:38:13.772498 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:38:13.774493 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:38:13.775491 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:38:13.775491 [info ] [MainThread]: adapter type: sqlserver
[0m13:38:13.776488 [info ] [MainThread]: adapter version: 1.8.5
[0m13:38:13.868242 [info ] [MainThread]: Configuration:
[0m13:38:13.869240 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:38:13.870236 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:38:13.871235 [info ] [MainThread]: Required dependencies:
[0m13:38:13.872400 [debug] [MainThread]: Executing "git --help"
[0m13:38:13.912296 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:38:13.913295 [debug] [MainThread]: STDERR: "b''"
[0m13:38:13.914291 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:38:13.915291 [info ] [MainThread]: Connection:
[0m13:38:13.916286 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:38:13.917284 [info ] [MainThread]:   database: dbt_project
[0m13:38:13.919278 [info ] [MainThread]:   schema: dbo
[0m13:38:13.919278 [info ] [MainThread]:   UID: dbt
[0m13:38:13.920275 [info ] [MainThread]:   client_id: None
[0m13:38:13.921273 [info ] [MainThread]:   authentication: sql
[0m13:38:13.922270 [info ] [MainThread]:   encrypt: False
[0m13:38:13.922270 [info ] [MainThread]:   trust_cert: True
[0m13:38:13.923268 [info ] [MainThread]:   retries: 3
[0m13:38:13.924265 [info ] [MainThread]:   login_timeout: 0
[0m13:38:13.924265 [info ] [MainThread]:   query_timeout: 0
[0m13:38:13.925263 [info ] [MainThread]:   trace_flag: False
[0m13:38:13.926261 [info ] [MainThread]:   port: 1433
[0m13:38:13.927258 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:38:14.190551 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:38:14.191548 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:38:14.191548 [debug] [MainThread]: On debug: select 1 as id
[0m13:38:14.192546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:14.192546 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m13:38:14.213685 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m13:38:14.213685 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m13:38:14.214685 [debug] [MainThread]: On debug: No close available on handle
[0m13:38:14.214685 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:38:14.215745 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:38:14.216745 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('28000', "[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dbt'. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user 'dbt'. (18456)")

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:38:14.219736 [debug] [MainThread]: Command `dbt debug` failed at 13:38:14.219736 after 0.93 seconds
[0m13:38:14.219736 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:38:14.220733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169BB79490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169CF7E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B231AC0>]}
[0m13:38:14.220733 [debug] [MainThread]: Flushing usage events
[0m13:38:47.140096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B185C9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B18114EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1873E630>]}


============================== 13:38:47.144088 | c5032662-4b02-4dc9-a375-285b3de3ca64 ==============================
[0m13:38:47.144088 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:38:47.145085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:47.160046 [info ] [MainThread]: dbt version: 1.8.9
[0m13:38:47.161043 [info ] [MainThread]: python version: 3.12.2
[0m13:38:47.162041 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m13:38:47.162452 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:38:47.440709 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m13:38:47.441706 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m13:38:47.442791 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m13:38:47.443791 [info ] [MainThread]: adapter type: sqlserver
[0m13:38:47.444793 [info ] [MainThread]: adapter version: 1.8.5
[0m13:38:47.533580 [info ] [MainThread]: Configuration:
[0m13:38:47.534580 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:38:47.535545 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:38:47.536547 [info ] [MainThread]: Required dependencies:
[0m13:38:47.536547 [debug] [MainThread]: Executing "git --help"
[0m13:38:47.577435 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:38:47.578461 [debug] [MainThread]: STDERR: "b''"
[0m13:38:47.578461 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:38:47.579429 [info ] [MainThread]: Connection:
[0m13:38:47.580426 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m13:38:47.581423 [info ] [MainThread]:   database: dbt_project
[0m13:38:47.582423 [info ] [MainThread]:   schema: dbo
[0m13:38:47.582423 [info ] [MainThread]:   UID: dbt
[0m13:38:47.583421 [info ] [MainThread]:   client_id: None
[0m13:38:47.584416 [info ] [MainThread]:   authentication: sql
[0m13:38:47.585414 [info ] [MainThread]:   encrypt: False
[0m13:38:47.586410 [info ] [MainThread]:   trust_cert: True
[0m13:38:47.587407 [info ] [MainThread]:   retries: 3
[0m13:38:47.587407 [info ] [MainThread]:   login_timeout: 0
[0m13:38:47.588404 [info ] [MainThread]:   query_timeout: 0
[0m13:38:47.589401 [info ] [MainThread]:   trace_flag: False
[0m13:38:47.589401 [info ] [MainThread]:   port: 1433
[0m13:38:47.590399 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m13:38:47.835741 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m13:38:47.836739 [debug] [MainThread]: Using sqlserver connection "debug"
[0m13:38:47.837737 [debug] [MainThread]: On debug: select 1 as id
[0m13:38:47.838735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:47.838735 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m13:38:47.890596 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m13:38:47.891622 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:47.892590 [debug] [MainThread]: On debug: Close
[0m13:38:47.892590 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:38:47.893587 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:38:47.895605 [debug] [MainThread]: Command `dbt debug` succeeded at 13:38:47.895605 after 0.88 seconds
[0m13:38:47.895605 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:38:47.896599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1A5B9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B181617C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B18162030>]}
[0m13:38:47.896599 [debug] [MainThread]: Flushing usage events
[0m17:00:48.454806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F084C1B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F083D019D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F086C57FE0>]}


============================== 17:00:48.482262 | 58ddb798-e327-4ae0-9cfe-d9d331b16909 ==============================
[0m17:00:48.482262 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:00:48.483263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:48.904344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F086740470>]}
[0m17:00:48.957667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F087715A90>]}
[0m17:00:48.957667 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:00:49.291848 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m17:00:49.373744 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:00:49.374741 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m17:00:49.375864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F086E20710>]}
[0m17:00:50.722663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F089644CB0>]}
[0m17:00:50.852972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F089703CB0>]}
[0m17:00:50.852972 [info ] [MainThread]: Found 2 models, 4 data tests, 500 macros
[0m17:00:50.853985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ddb798-e327-4ae0-9cfe-d9d331b16909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F089478920>]}
[0m17:00:50.855964 [warn ] [MainThread]: The selection criterion 'base_trip_data' does not match any enabled nodes
[0m17:00:50.857689 [info ] [MainThread]: 
[0m17:00:50.857689 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:00:50.857689 [debug] [MainThread]: Command end result
[0m17:00:50.886463 [debug] [MainThread]: Command `cli run` succeeded at 17:00:50.885464 after 2.55 seconds
[0m17:00:50.886463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F084C1B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0866FC320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0879BAFC0>]}
[0m17:00:50.887467 [debug] [MainThread]: Flushing usage events
[0m17:05:30.521215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C183CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C1835C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C1EFBC0>]}


============================== 17:05:30.538170 | 835a5e7f-74c0-4210-ac65-ed3957544e50 ==============================
[0m17:05:30.538170 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:05:30.539167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:05:30.649040 [info ] [MainThread]: dbt version: 1.8.9
[0m17:05:30.650037 [info ] [MainThread]: python version: 3.12.2
[0m17:05:30.650037 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m17:05:30.651035 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:05:33.946931 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m17:05:33.947919 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m17:05:33.948915 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m17:05:33.949913 [info ] [MainThread]: adapter type: sqlserver
[0m17:05:33.949913 [info ] [MainThread]: adapter version: 1.8.5
[0m17:05:34.055872 [info ] [MainThread]: Configuration:
[0m17:05:34.055872 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:05:34.056841 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:05:34.057838 [info ] [MainThread]: Required dependencies:
[0m17:05:34.058836 [debug] [MainThread]: Executing "git --help"
[0m17:05:34.111202 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:05:34.111959 [debug] [MainThread]: STDERR: "b''"
[0m17:05:34.112956 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:05:34.113953 [info ] [MainThread]: Connection:
[0m17:05:34.114950 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m17:05:34.115948 [info ] [MainThread]:   database: dbt_project
[0m17:05:34.115948 [info ] [MainThread]:   schema: dbo
[0m17:05:34.116944 [info ] [MainThread]:   UID: dbt
[0m17:05:34.117940 [info ] [MainThread]:   client_id: None
[0m17:05:34.118940 [info ] [MainThread]:   authentication: sql
[0m17:05:34.118940 [info ] [MainThread]:   encrypt: False
[0m17:05:34.119935 [info ] [MainThread]:   trust_cert: True
[0m17:05:34.120934 [info ] [MainThread]:   retries: 3
[0m17:05:34.121930 [info ] [MainThread]:   login_timeout: 0
[0m17:05:34.121930 [info ] [MainThread]:   query_timeout: 0
[0m17:05:34.122928 [info ] [MainThread]:   trace_flag: False
[0m17:05:34.123925 [info ] [MainThread]:   port: 1433
[0m17:05:34.126921 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:05:34.558662 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m17:05:34.560686 [debug] [MainThread]: Using sqlserver connection "debug"
[0m17:05:34.561654 [debug] [MainThread]: On debug: select 1 as id
[0m17:05:34.561654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:34.562679 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:05:34.597579 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m17:05:34.598769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:05:34.599887 [debug] [MainThread]: On debug: Close
[0m17:05:34.599887 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:05:34.601762 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:05:34.603275 [debug] [MainThread]: Command `dbt debug` succeeded at 17:05:34.602248 after 4.19 seconds
[0m17:05:34.603275 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:05:34.604246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C31D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024879E922A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487BAD2000>]}
[0m17:05:34.604246 [debug] [MainThread]: Flushing usage events
[0m17:06:24.577342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE13398B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE1338F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CDDE11550>]}


============================== 17:06:24.581377 | 82e10f98-02a8-4851-bcf2-23e8503c99f1 ==============================
[0m17:06:24.581377 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:06:24.582375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:25.410425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE1805B80>]}
[0m17:06:25.471433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE23AED20>]}
[0m17:06:25.472402 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:06:25.782693 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:06:25.872683 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:06:25.873688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE36B5EB0>]}
[0m17:06:28.323790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE361E180>]}
[0m17:06:28.477811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE1AEF080>]}
[0m17:06:28.478807 [info ] [MainThread]: Found 3 models, 4 data tests, 502 macros
[0m17:06:28.479804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE37AA750>]}
[0m17:06:28.482795 [info ] [MainThread]: 
[0m17:06:28.483793 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:06:28.488779 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:06:28.508429 [debug] [ThreadPool]: dbt-sqlserver
[0m17:06:28.510434 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:06:28.511422 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:06:28.512418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:28.513416 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:28.554580 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:28.558963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:28.561944 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:06:28.564295 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:06:28.570338 [debug] [ThreadPool]: dbt-sqlserver
[0m17:06:28.570338 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:06:28.571337 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:06:28.571337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:28.572305 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:28.574330 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:28.635987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:28.638013 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:06:28.638013 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:06:28.639009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE2291CD0>]}
[0m17:06:28.640005 [debug] [MainThread]: On master: COMMIT
[0m17:06:28.640005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:28.640974 [info ] [MainThread]: 
[0m17:06:28.647955 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:06:28.647955 [info ] [Thread-1 (]: 1 of 3 START sql view model dbo.base_trip_data ................................. [RUN]
[0m17:06:28.649979 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:06:28.649979 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:06:28.657947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:06:28.668372 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:06:28.706470 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:06:28.709463 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:28.711468 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m17:06:28.712462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:28.712462 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:28.713451 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:28.731105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:28.739083 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:28.739083 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:06:28.963485 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:28.980303 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:06:28.986287 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:06:28.995539 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:28.996537 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:28.996537 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:29.031535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.033531 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:29.033531 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:06:29.035953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.037950 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m17:06:29.038947 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:06:29.040941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CDF2914F0>]}
[0m17:06:29.040941 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.39s]
[0m17:06:29.042967 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:06:29.042967 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m17:06:29.043933 [info ] [Thread-1 (]: 2 of 3 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m17:06:29.045087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.my_first_dbt_model)
[0m17:06:29.046086 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m17:06:29.048109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.049105 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m17:06:29.075902 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:29.079891 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw"
[0m17:06:29.080888 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:29.081894 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.081894 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_first_dbt_model__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:29.082883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:29.082883 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:29.083880 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:29.096934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.098956 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.099925 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw";');

[0m17:06:29.101564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.106581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.110907 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.110907 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp" FROM "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.my_first_dbt_model__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_my_first_dbt_model__dbt_tmp_cci'
        AND object_id=object_id('dbo_my_first_dbt_model__dbt_tmp')
    )
    DROP index "dbo"."my_first_dbt_model__dbt_tmp".dbo_my_first_dbt_model__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_my_first_dbt_model__dbt_tmp_cci
    ON "dbo"."my_first_dbt_model__dbt_tmp"

   


  
[0m17:06:29.217219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.220213 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.221210 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model__dbt_tmp', 'my_first_dbt_model'
[0m17:06:29.313937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.319949 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m17:06:29.321915 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_backup"
[0m17:06:29.322912 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:06:29.323938 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m17:06:29.325907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.327898 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m17:06:29.327898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE23D50D0>]}
[0m17:06:29.328895 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 0.28s]
[0m17:06:29.330891 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m17:06:29.331889 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m17:06:29.332886 [info ] [Thread-1 (]: 3 of 3 START sql view model dbo.my_second_dbt_model ............................ [RUN]
[0m17:06:29.333455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.my_second_dbt_model)
[0m17:06:29.334458 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m17:06:29.336486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.338244 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m17:06:29.342235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.343232 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.344230 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_second_dbt_model__dbt_tmp" as -- Use the `ref` function to select from other models

select *
from "dbt_project"."dbo"."my_first_dbt_model"
where id = 1;
    ')


[0m17:06:29.345229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:29.346234 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:29.346234 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:29.349121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.354267 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.354267 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model__dbt_tmp', 'my_second_dbt_model'
[0m17:06:29.357249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.360249 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m17:06:29.364234 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_second_dbt_model__dbt_backup"
[0m17:06:29.365241 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:29.366230 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.367229 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:29.378161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.380154 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:06:29.381152 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m17:06:29.383153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:29.385150 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: ROLLBACK
[0m17:06:29.385150 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m17:06:29.386147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e10f98-02a8-4851-bcf2-23e8503c99f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE406F110>]}
[0m17:06:29.388143 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbo.my_second_dbt_model ....................... [[32mOK[0m in 0.05s]
[0m17:06:29.390137 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m17:06:29.395125 [debug] [MainThread]: On master: COMMIT
[0m17:06:29.396122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:29.397119 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:06:29.398117 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:06:29.399114 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m17:06:29.401108 [info ] [MainThread]: 
[0m17:06:29.404101 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m17:06:29.406094 [debug] [MainThread]: Command end result
[0m17:06:29.481741 [info ] [MainThread]: 
[0m17:06:29.484733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:29.485730 [info ] [MainThread]: 
[0m17:06:29.486727 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:06:29.488722 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:29.487727 after 5.02 seconds
[0m17:06:29.489720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE1400920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE16E91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CE16E85F0>]}
[0m17:06:29.489720 [debug] [MainThread]: Flushing usage events
[0m17:09:06.626471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD58635C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD55B0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD5863920>]}


============================== 17:09:06.633529 | 693e1dc6-fdb4-4ea9-a2c2-bad3649919cf ==============================
[0m17:09:06.633529 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:09:06.634527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:07.107931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD60DB830>]}
[0m17:09:07.157749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD513E420>]}
[0m17:09:07.157749 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:09:07.414768 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:09:07.559892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:09:07.559892 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\example\trips.sql
[0m17:09:07.779133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD7A63FE0>]}
[0m17:09:07.861293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD7932C60>]}
[0m17:09:07.861293 [info ] [MainThread]: Found 4 models, 4 data tests, 502 macros
[0m17:09:07.861293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD78A51F0>]}
[0m17:09:07.861293 [info ] [MainThread]: 
[0m17:09:07.861293 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:09:07.861293 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:09:07.901241 [debug] [ThreadPool]: dbt-sqlserver
[0m17:09:07.902232 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:09:07.903199 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:09:07.903199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:07.904197 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:09:07.945376 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:09:07.953352 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:09:07.956346 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:09:07.959979 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:09:07.966961 [debug] [ThreadPool]: dbt-sqlserver
[0m17:09:07.967959 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:09:07.967959 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:09:07.968956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:07.968956 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:09:07.969953 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:09:08.020105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:09:08.023096 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:09:08.024094 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:09:08.028082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6421C40>]}
[0m17:09:08.029079 [debug] [MainThread]: On master: COMMIT
[0m17:09:08.029079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:08.032072 [info ] [MainThread]: 
[0m17:09:08.038056 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:09:08.039053 [info ] [Thread-1 (]: 1 of 3 START sql view model dbo.base_trip_data ................................. [RUN]
[0m17:09:08.040052 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:09:08.041054 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:09:08.050024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:09:08.051129 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:09:08.089751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:09:08.091763 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:09:08.092778 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m17:09:08.093742 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:08.093742 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:09:08.094744 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:09:08.101579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.108448 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:09:08.109445 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:09:08.113433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.117422 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:09:08.117422 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:09:08.119441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.138399 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:09:08.144379 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:09:08.151519 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:09:08.152490 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:09:08.152490 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:09:08.162627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.162627 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:09:08.162627 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:09:08.162627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.162627 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m17:09:08.162627 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:09:08.162627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD3441760>]}
[0m17:09:08.162627 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.12s]
[0m17:09:08.162627 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:09:08.162627 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m17:09:08.178439 [info ] [Thread-1 (]: 2 of 3 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m17:09:08.178439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.my_first_dbt_model)
[0m17:09:08.179436 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m17:09:08.182529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.182529 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m17:09:08.206762 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:09:08.210754 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw"
[0m17:09:08.211731 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:09:08.212735 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.212735 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_first_dbt_model__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:09:08.213743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:08.213743 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:09:08.214740 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:09:08.225682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.228674 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.229672 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw";');

[0m17:09:08.232084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.238070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.239070 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.240072 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp" FROM "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.my_first_dbt_model__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_my_first_dbt_model__dbt_tmp_cci'
        AND object_id=object_id('dbo_my_first_dbt_model__dbt_tmp')
    )
    DROP index "dbo"."my_first_dbt_model__dbt_tmp".dbo_my_first_dbt_model__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_my_first_dbt_model__dbt_tmp_cci
    ON "dbo"."my_first_dbt_model__dbt_tmp"

   


  
[0m17:09:08.275742 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.278736 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.279733 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model', 'my_first_dbt_model__dbt_backup'
[0m17:09:08.284995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.288986 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.289984 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model__dbt_tmp', 'my_first_dbt_model'
[0m17:09:08.292544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.297533 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m17:09:08.300631 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_backup"
[0m17:09:08.301658 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:09:08.301658 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m17:09:08.309553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.311550 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m17:09:08.311550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD81070B0>]}
[0m17:09:08.312547 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 0.13s]
[0m17:09:08.313227 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m17:09:08.314496 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m17:09:08.314496 [info ] [Thread-1 (]: 3 of 3 START sql view model dbo.my_second_dbt_model ............................ [RUN]
[0m17:09:08.315525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.my_second_dbt_model)
[0m17:09:08.316498 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m17:09:08.318516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.319513 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m17:09:08.324471 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.325578 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.326577 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_second_dbt_model__dbt_tmp" as -- Use the `ref` function to select from other models

select *
from "dbt_project"."dbo"."my_first_dbt_model"
where id = 1;
    ')


[0m17:09:08.327604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:08.328585 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:09:08.328585 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:09:08.331169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.334163 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.335160 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model', 'my_second_dbt_model__dbt_backup'
[0m17:09:08.337667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.340661 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.341659 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model__dbt_tmp', 'my_second_dbt_model'
[0m17:09:08.344650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.346649 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m17:09:08.349688 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_second_dbt_model__dbt_backup"
[0m17:09:08.350810 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:09:08.350810 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.351810 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:09:08.363622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.364619 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:09:08.365616 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m17:09:08.367753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:09:08.368752 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: ROLLBACK
[0m17:09:08.369749 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m17:09:08.370746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693e1dc6-fdb4-4ea9-a2c2-bad3649919cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD81338C0>]}
[0m17:09:08.370746 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbo.my_second_dbt_model ....................... [[32mOK[0m in 0.05s]
[0m17:09:08.371699 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m17:09:08.373696 [debug] [MainThread]: On master: COMMIT
[0m17:09:08.373696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:08.374708 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:09:08.375704 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:09:08.375704 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m17:09:08.376717 [info ] [MainThread]: 
[0m17:09:08.377339 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m17:09:08.378994 [debug] [MainThread]: Command end result
[0m17:09:08.409369 [info ] [MainThread]: 
[0m17:09:08.410365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:08.410365 [info ] [MainThread]: 
[0m17:09:08.411363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:09:08.413357 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:08.413357 after 1.89 seconds
[0m17:09:08.414369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4BC1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD555A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD51811F0>]}
[0m17:09:08.414369 [debug] [MainThread]: Flushing usage events
[0m17:10:16.454851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EBED61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EB11FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EB675D90>]}


============================== 17:10:16.454851 | 8794fb03-8f2e-49e2-bb04-708c30294b49 ==============================
[0m17:10:16.454851 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:10:16.454851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:16.927744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8794fb03-8f2e-49e2-bb04-708c30294b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EC707C50>]}
[0m17:10:16.990052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8794fb03-8f2e-49e2-bb04-708c30294b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EC9C3E60>]}
[0m17:10:16.990052 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:10:17.252422 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:10:17.442763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:17.444820 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:10:17.643954 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\example\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:10:17.643954 [debug] [MainThread]: Command `dbt run` failed at 17:10:17.643954 after 1.31 seconds
[0m17:10:17.643954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EBC7D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EDEC7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EC9E1FD0>]}
[0m17:10:17.643954 [debug] [MainThread]: Flushing usage events
[0m17:10:46.214895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20BFEDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20C0C6E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20C0C6630>]}


============================== 17:10:46.214895 | 316ba039-3f8a-4f70-bea3-90c459609d6b ==============================
[0m17:10:46.214895 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:10:46.214895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:46.647127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '316ba039-3f8a-4f70-bea3-90c459609d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20F83C7D0>]}
[0m17:10:46.707411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '316ba039-3f8a-4f70-bea3-90c459609d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20BFEFF80>]}
[0m17:10:46.707411 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:10:46.948480 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:10:47.090579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:10:47.090579 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:10:47.090579 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:10:47.251377 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\example\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:10:47.253477 [debug] [MainThread]: Command `dbt run` failed at 17:10:47.253477 after 1.13 seconds
[0m17:10:47.253477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B20FB4A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2118520F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211BA81A0>]}
[0m17:10:47.253477 [debug] [MainThread]: Flushing usage events
[0m17:13:42.091357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69D0A1CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69EC0EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69F7C04A0>]}


============================== 17:13:42.106979 | 73f29799-cb38-44b1-8b38-65f679fd224e ==============================
[0m17:13:42.106979 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:13:42.106979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:42.523905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f29799-cb38-44b1-8b38-65f679fd224e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6A02EB830>]}
[0m17:13:42.589607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f29799-cb38-44b1-8b38-65f679fd224e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6A1562240>]}
[0m17:13:42.589607 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:13:42.833408 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:13:42.975328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:13:42.975328 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:13:42.975328 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:13:43.127259 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\example\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: TABLE)}}
[0m17:13:43.127259 [debug] [MainThread]: Command `dbt run` failed at 17:13:43.127259 after 1.13 seconds
[0m17:13:43.127259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69FA935F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6A1B17470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C69F23A990>]}
[0m17:13:43.135301 [debug] [MainThread]: Flushing usage events
[0m17:15:01.722661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE2BF5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE38C59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE2B9E870>]}


============================== 17:15:01.726656 | 49f147be-5690-4b7b-a90b-a0634300ae3f ==============================
[0m17:15:01.726656 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:15:01.727655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:02.152891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f147be-5690-4b7b-a90b-a0634300ae3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE6D563C0>]}
[0m17:15:02.204476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f147be-5690-4b7b-a90b-a0634300ae3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE7031B80>]}
[0m17:15:02.205571 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:15:02.449405 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:15:02.591286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:15:02.592287 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:15:02.592287 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:15:02.743491 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\example\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: TABLE)}}
[0m17:15:02.744467 [debug] [MainThread]: Command `dbt run` failed at 17:15:02.744467 after 1.12 seconds
[0m17:15:02.745464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE5D472C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE70A2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CE85276B0>]}
[0m17:15:02.745464 [debug] [MainThread]: Flushing usage events
[0m17:15:24.733220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A69CB5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A69FCBEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A667B9160>]}


============================== 17:15:24.737392 | b4011cb5-746d-480c-83c6-cd5e16eceecc ==============================
[0m17:15:24.737392 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:15:24.738216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:15:25.189047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4011cb5-746d-480c-83c6-cd5e16eceecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6A594FE0>]}
[0m17:15:25.247095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4011cb5-746d-480c-83c6-cd5e16eceecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6A1DCC50>]}
[0m17:15:25.248092 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:15:25.502216 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:15:25.751677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:15:25.752674 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:15:25.753671 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:15:25.937673 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\example\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:15:25.939671 [debug] [MainThread]: Command `dbt run` failed at 17:15:25.939671 after 1.31 seconds
[0m17:15:25.940701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A697582C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6C0D7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6A4A5E20>]}
[0m17:15:25.940701 [debug] [MainThread]: Flushing usage events
[0m17:15:46.854715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002281FE3AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002281FFB1A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282068F860>]}


============================== 17:15:46.860259 | 23183bc8-898f-4f19-af30-2a425d0eb65b ==============================
[0m17:15:46.860259 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:15:46.864208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:47.453045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23183bc8-898f-4f19-af30-2a425d0eb65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228208250D0>]}
[0m17:15:47.550682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23183bc8-898f-4f19-af30-2a425d0eb65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022821343590>]}
[0m17:15:47.552846 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:15:47.894207 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:15:48.113929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:15:48.114930 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:15:48.116922 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:15:48.337758 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\example\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: table)}}
[0m17:15:48.341747 [debug] [MainThread]: Command `dbt run` failed at 17:15:48.340750 after 1.63 seconds
[0m17:15:48.342745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002281FC417F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228227B79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228208A26C0>]}
[0m17:15:48.343743 [debug] [MainThread]: Flushing usage events
[0m17:16:32.600606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FDF1F9CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE1878440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE18798B0>]}


============================== 17:16:32.600606 | 3b35669a-792c-46eb-934c-ad9499aa39d0 ==============================
[0m17:16:32.600606 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:16:32.600606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:33.037493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b35669a-792c-46eb-934c-ad9499aa39d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE2C1FEF0>]}
[0m17:16:33.088377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b35669a-792c-46eb-934c-ad9499aa39d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE1084AD0>]}
[0m17:16:33.088377 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:16:33.323237 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:16:33.465527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:16:33.465527 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:16:33.465527 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:16:33.627004 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\example\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:16:33.627004 [debug] [MainThread]: Command `dbt run` failed at 17:16:33.627004 after 1.12 seconds
[0m17:16:33.627004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE1787680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FDBFD54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE3FE7200>]}
[0m17:16:33.627004 [debug] [MainThread]: Flushing usage events
[0m17:17:43.572871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAFC2E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAF86E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAC3952E0>]}


============================== 17:17:43.590003 | 08cb9a3a-e318-46df-87fb-70f57f0042df ==============================
[0m17:17:43.590003 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:17:43.590003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:44.043809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08cb9a3a-e318-46df-87fb-70f57f0042df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DB091B950>]}
[0m17:17:44.106772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08cb9a3a-e318-46df-87fb-70f57f0042df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAFC66390>]}
[0m17:17:44.106772 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:17:44.391833 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:17:44.546863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:17:44.547861 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\trips.sql
[0m17:17:44.548859 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\base_trip_data.sql
[0m17:17:44.705269 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\example\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: table)}}
[0m17:17:44.713330 [debug] [MainThread]: Command `dbt run` failed at 17:17:44.705269 after 1.23 seconds
[0m17:17:44.713330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAF86E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DB19620F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DB1CB7C80>]}
[0m17:17:44.713330 [debug] [MainThread]: Flushing usage events
[0m17:20:07.122775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7BBC06E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78328EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7AD37410>]}


============================== 17:20:07.138400 | 4cdae7ff-b93b-4642-a5df-a716c5bf0810 ==============================
[0m17:20:07.138400 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:20:07.138400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:07.554432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cdae7ff-b93b-4642-a5df-a716c5bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7C1563C0>]}
[0m17:20:07.601302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cdae7ff-b93b-4642-a5df-a716c5bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7C40A480>]}
[0m17:20:07.601302 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:20:07.861164 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:20:08.055225 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:20:08.256891 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\Models\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:20:08.256891 [debug] [MainThread]: Command `dbt run` failed at 17:20:08.256891 after 1.23 seconds
[0m17:20:08.256891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7BA49AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7DBDB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7DC35CD0>]}
[0m17:20:08.256891 [debug] [MainThread]: Flushing usage events
[0m17:21:04.805010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A9E800B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AC7E1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AC7E1C40>]}


============================== 17:21:04.805010 | ff56f57f-4a49-4183-9c35-8d7aafcfa4b3 ==============================
[0m17:21:04.805010 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:21:04.805010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:05.227962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff56f57f-4a49-4183-9c35-8d7aafcfa4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253ACDA10A0>]}
[0m17:21:05.290451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff56f57f-4a49-4183-9c35-8d7aafcfa4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD0619D0>]}
[0m17:21:05.290451 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:21:05.575819 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:21:05.722643 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:21:05.895530 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:21:05.895530 [debug] [MainThread]: Command `dbt run` failed at 17:21:05.895530 after 1.18 seconds
[0m17:21:05.895530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A9FA51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A67B5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD4030E0>]}
[0m17:21:05.895530 [debug] [MainThread]: Flushing usage events
[0m17:21:49.357917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E036621C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E036621D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E036621C70>]}


============================== 17:21:49.361636 | 544c5c3b-2909-4145-90c8-e5fba9724dca ==============================
[0m17:21:49.361636 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:21:49.362793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:49.785679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544c5c3b-2909-4145-90c8-e5fba9724dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E035E71FA0>]}
[0m17:21:49.836727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544c5c3b-2909-4145-90c8-e5fba9724dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E036EC9B50>]}
[0m17:21:49.836727 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:21:50.081235 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:21:50.222499 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:21:50.230543 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:21:50.230543 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:21:50.394929 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:21:50.395617 [debug] [MainThread]: Command `dbt run` failed at 17:21:50.395617 after 1.15 seconds
[0m17:21:50.395617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0364BD4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0383B1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0386C6330>]}
[0m17:21:50.395617 [debug] [MainThread]: Flushing usage events
[0m17:22:08.864876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286F562D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286442F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015283635340>]}


============================== 17:22:08.864876 | dd2d5b60-452f-495c-8ddc-66773090b7c8 ==============================
[0m17:22:08.864876 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:22:08.880498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:09.366251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd2d5b60-452f-495c-8ddc-66773090b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152877963C0>]}
[0m17:22:09.419624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd2d5b60-452f-495c-8ddc-66773090b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015287A4C200>]}
[0m17:22:09.419624 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:22:09.664358 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:22:09.808683 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:22:09.969112 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:22:09.969178 [debug] [MainThread]: Command `dbt run` failed at 17:22:09.969178 after 1.19 seconds
[0m17:22:09.969178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015286F562D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015288F9D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015287489D30>]}
[0m17:22:09.969178 [debug] [MainThread]: Flushing usage events
[0m17:23:12.646784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F632C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F83858B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F8385B80>]}


============================== 17:23:12.662435 | cbb8a22e-5f6b-4d16-81c2-426219c195fe ==============================
[0m17:23:12.662435 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:23:12.662435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:13.078424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb8a22e-5f6b-4d16-81c2-426219c195fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F8EFA5D0>]}
[0m17:23:13.125290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb8a22e-5f6b-4d16-81c2-426219c195fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F7F640E0>]}
[0m17:23:13.125290 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:23:13.379251 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:23:13.527872 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:23:13.527872 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:23:13.527872 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:23:13.527872 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:23:13.543498 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:23:13.712079 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:23:13.720113 [debug] [MainThread]: Command `dbt run` failed at 17:23:13.720113 after 1.16 seconds
[0m17:23:13.722196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F8D61DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F9A61C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FAB05550>]}
[0m17:23:13.722196 [debug] [MainThread]: Flushing usage events
[0m17:23:22.799969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A91E07BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A947B9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A947B91F0>]}


============================== 17:23:22.815619 | 0571b016-5d52-45ba-b8f6-98ecb1c4cd3d ==============================
[0m17:23:22.815619 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:23:22.815619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:23:22.838366 [info ] [MainThread]: dbt version: 1.8.9
[0m17:23:22.838366 [info ] [MainThread]: python version: 3.12.2
[0m17:23:22.838366 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m17:23:22.838366 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:23:23.162684 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m17:23:23.162684 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m17:23:23.162684 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m17:23:23.162684 [info ] [MainThread]: adapter type: sqlserver
[0m17:23:23.169189 [info ] [MainThread]: adapter version: 1.8.5
[0m17:23:23.259790 [info ] [MainThread]: Configuration:
[0m17:23:23.260786 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:23:23.261784 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:23:23.262381 [info ] [MainThread]: Required dependencies:
[0m17:23:23.262381 [debug] [MainThread]: Executing "git --help"
[0m17:23:23.300199 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:23.300199 [debug] [MainThread]: STDERR: "b''"
[0m17:23:23.300199 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:23:23.300199 [info ] [MainThread]: Connection:
[0m17:23:23.300199 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m17:23:23.300199 [info ] [MainThread]:   database: dbt_project
[0m17:23:23.300199 [info ] [MainThread]:   schema: dbo
[0m17:23:23.300199 [info ] [MainThread]:   UID: dbt
[0m17:23:23.300199 [info ] [MainThread]:   client_id: None
[0m17:23:23.300199 [info ] [MainThread]:   authentication: sql
[0m17:23:23.300199 [info ] [MainThread]:   encrypt: False
[0m17:23:23.311049 [info ] [MainThread]:   trust_cert: True
[0m17:23:23.312048 [info ] [MainThread]:   retries: 3
[0m17:23:23.312048 [info ] [MainThread]:   login_timeout: 0
[0m17:23:23.314041 [info ] [MainThread]:   query_timeout: 0
[0m17:23:23.314041 [info ] [MainThread]:   trace_flag: False
[0m17:23:23.315039 [info ] [MainThread]:   port: 1433
[0m17:23:23.316036 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:23:23.547999 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m17:23:23.547999 [debug] [MainThread]: Using sqlserver connection "debug"
[0m17:23:23.547999 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:23.547999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:23.547999 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:23:23.570102 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m17:23:23.570102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:23:23.570102 [debug] [MainThread]: On debug: Close
[0m17:23:23.570102 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:23:23.570102 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:23:23.570102 [debug] [MainThread]: Command `dbt debug` succeeded at 17:23:23.570102 after 0.87 seconds
[0m17:23:23.570102 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:23:23.570102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9455A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A95189520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A93F29C40>]}
[0m17:23:23.570102 [debug] [MainThread]: Flushing usage events
[0m17:23:50.287880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7B090DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7DCFC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7DA46B40>]}


============================== 17:23:50.287880 | bef8ca9e-cbde-4f45-a150-c1f30af06f62 ==============================
[0m17:23:50.287880 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:23:50.287880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:50.723269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bef8ca9e-cbde-4f45-a150-c1f30af06f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7ED3CFE0>]}
[0m17:23:50.774150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bef8ca9e-cbde-4f45-a150-c1f30af06f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7F6322D0>]}
[0m17:23:50.774150 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:23:51.035760 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:23:51.198553 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:23:51.367605 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:23:51.367605 [debug] [MainThread]: Command `dbt run` failed at 17:23:51.367605 after 1.17 seconds
[0m17:23:51.367605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7E148B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7F675550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B7DAD4140>]}
[0m17:23:51.367605 [debug] [MainThread]: Flushing usage events
[0m17:24:26.150043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA78CD1DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA763956D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA78101250>]}


============================== 17:24:26.150043 | 17876a56-6bc3-40a2-8331-a02306610049 ==============================
[0m17:24:26.150043 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:24:26.150043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:26.645593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17876a56-6bc3-40a2-8331-a02306610049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA799012B0>]}
[0m17:24:26.692480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17876a56-6bc3-40a2-8331-a02306610049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA768B2330>]}
[0m17:24:26.692480 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:24:26.929534 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:24:27.071491 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:24:27.243518 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:24:27.251559 [debug] [MainThread]: Command `dbt run` failed at 17:24:27.251559 after 1.19 seconds
[0m17:24:27.251559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA789C9DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA7AE120F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA7ADE5F10>]}
[0m17:24:27.251559 [debug] [MainThread]: Flushing usage events
[0m17:24:55.298265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742BE8B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742D976A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742E801CA0>]}


============================== 17:24:55.298265 | 56407e09-2f93-456b-8466-edbc1d59628b ==============================
[0m17:24:55.298265 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:24:55.298265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:55.734489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56407e09-2f93-456b-8466-edbc1d59628b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F124FE0>]}
[0m17:24:55.781353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56407e09-2f93-456b-8466-edbc1d59628b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F3BFAD0>]}
[0m17:24:55.796974 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:24:56.031042 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:24:56.174093 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:24:56.326842 [error] [MainThread]: Encountered an error:
Compilation Error in model trips (models\Models\trips.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:24:56.334915 [debug] [MainThread]: Command `dbt run` failed at 17:24:56.334915 after 1.14 seconds
[0m17:24:56.334915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742E0259D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743090F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F341D90>]}
[0m17:24:56.334915 [debug] [MainThread]: Flushing usage events
[0m17:25:22.223467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A524B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A4328CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A73AE270>]}


============================== 17:25:22.239089 | 8cefae08-a446-4c0f-94de-7381390ef453 ==============================
[0m17:25:22.239089 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:25:22.239089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:25:22.662087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cefae08-a446-4c0f-94de-7381390ef453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A7D56A80>]}
[0m17:25:22.711665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cefae08-a446-4c0f-94de-7381390ef453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A87935C0>]}
[0m17:25:22.711665 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:25:22.953714 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:25:23.095853 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:25:23.269342 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:25:23.269342 [debug] [MainThread]: Command `dbt run` failed at 17:25:23.269342 after 1.15 seconds
[0m17:25:23.269342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A78F1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A8750DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A886E2D0>]}
[0m17:25:23.269342 [debug] [MainThread]: Flushing usage events
[0m17:25:42.485139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20B5B1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BEE0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20E161DC0>]}


============================== 17:25:42.485139 | 84d154f2-08dd-4fea-a6cf-a79e078f44c9 ==============================
[0m17:25:42.485139 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:25:42.485139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:25:42.930303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d154f2-08dd-4fea-a6cf-a79e078f44c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20E684FE0>]}
[0m17:25:42.990562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d154f2-08dd-4fea-a6cf-a79e078f44c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20ED56E70>]}
[0m17:25:42.990562 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:25:43.264064 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:25:43.413845 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:25:43.413845 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:25:43.415875 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:25:43.589753 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:25:43.592158 [debug] [MainThread]: Command `dbt run` failed at 17:25:43.592158 after 1.20 seconds
[0m17:25:43.592158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20DF5E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20D9B0E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20FED5550>]}
[0m17:25:43.593126 [debug] [MainThread]: Flushing usage events
[0m17:26:26.025320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7E251C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7E250530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7B7E9430>]}


============================== 17:26:26.025320 | 2ef76bc8-4ac3-4f9f-8902-fc8e9b63a1fc ==============================
[0m17:26:26.025320 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:26:26.025320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:26.573643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef76bc8-4ac3-4f9f-8902-fc8e9b63a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7EDAD9A0>]}
[0m17:26:26.627016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef76bc8-4ac3-4f9f-8902-fc8e9b63a1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7C104E30>]}
[0m17:26:26.627016 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:26:26.874384 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:26:27.016341 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:26:27.024390 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:26:27.024390 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:26:27.024390 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:26:27.199560 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:26:27.199560 [debug] [MainThread]: Command `dbt run` failed at 17:26:27.199560 after 1.27 seconds
[0m17:26:27.199560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7E6760F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7F0A24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7F5531D0>]}
[0m17:26:27.199560 [debug] [MainThread]: Flushing usage events
[0m17:27:55.717804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295576B1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029556CD6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295576B1D00>]}


============================== 17:27:55.721821 | f357314f-cbf6-4f7c-b93c-5094c399f72c ==============================
[0m17:27:55.721821 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:27:55.722945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:56.149161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f357314f-cbf6-4f7c-b93c-5094c399f72c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029557C34FE0>]}
[0m17:27:56.201931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f357314f-cbf6-4f7c-b93c-5094c399f72c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029558290E30>]}
[0m17:27:56.203053 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:27:56.447102 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:27:56.588954 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:27:56.589951 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:27:56.590998 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:27:56.590998 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:27:56.591946 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:27:56.591946 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:27:56.592948 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:27:56.592948 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:27:56.593917 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:27:56.593917 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:27:56.773085 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:27:56.775081 [debug] [MainThread]: Command `dbt run` failed at 17:27:56.775081 after 1.16 seconds
[0m17:27:56.776079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295576B3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295583AF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295597BF530>]}
[0m17:27:56.776079 [debug] [MainThread]: Flushing usage events
[0m17:29:01.121417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5CA1BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5F3A3CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5F3A1BE0>]}


============================== 17:29:01.125435 | eb8143b8-27d3-488d-9da7-2cea86fce22c ==============================
[0m17:29:01.125435 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:29:01.126404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:01.559243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb8143b8-27d3-488d-9da7-2cea86fce22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5F9E9130>]}
[0m17:29:01.613601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb8143b8-27d3-488d-9da7-2cea86fce22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D597F5EB0>]}
[0m17:29:01.614597 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:29:01.867923 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:29:02.011085 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:29:02.012082 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:29:02.012082 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:29:02.013079 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:29:02.013079 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:29:02.014054 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:29:02.014054 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:29:02.015051 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:29:02.015051 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:29:02.016049 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:29:02.195175 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:29:02.197169 [debug] [MainThread]: Command `dbt run` failed at 17:29:02.197169 after 1.18 seconds
[0m17:29:02.197169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5E38B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D614E8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D5E548710>]}
[0m17:29:02.198167 [debug] [MainThread]: Flushing usage events
[0m17:29:30.456066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0E80A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0D4A7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE10074980>]}


============================== 17:29:30.460794 | d2867523-30f7-45c0-a98a-00a76ca45573 ==============================
[0m17:29:30.460794 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:29:30.461489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:30.892409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2867523-30f7-45c0-a98a-00a76ca45573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE11C536B0>]}
[0m17:29:30.931400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2867523-30f7-45c0-a98a-00a76ca45573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE11843260>]}
[0m17:29:30.931400 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:29:31.182866 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:29:31.327473 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:29:31.328340 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:29:31.329313 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:29:31.329313 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:29:31.330307 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:29:31.330307 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:29:31.331319 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:29:31.331319 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:29:31.332387 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:29:31.332544 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:29:31.491413 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:29:31.493339 [debug] [MainThread]: Command `dbt run` failed at 17:29:31.493339 after 1.14 seconds
[0m17:29:31.494357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE106F9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE13030FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE12FAF2F0>]}
[0m17:29:31.495333 [debug] [MainThread]: Flushing usage events
[0m17:31:29.754406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E972DBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9796CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E995252E0>]}


============================== 17:31:29.758996 | 4d2bb0a8-5983-474d-8d05-87430afb8d03 ==============================
[0m17:31:29.758996 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:31:29.759999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:31:29.780466 [info ] [MainThread]: dbt version: 1.8.9
[0m17:31:29.781464 [info ] [MainThread]: python version: 3.12.2
[0m17:31:29.782462 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m17:31:29.783561 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:31:30.165302 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m17:31:30.165302 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m17:31:30.165302 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m17:31:30.165302 [info ] [MainThread]: adapter type: sqlserver
[0m17:31:30.165302 [info ] [MainThread]: adapter version: 1.8.5
[0m17:31:30.254977 [info ] [MainThread]: Configuration:
[0m17:31:30.255953 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:30.256963 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:30.257947 [info ] [MainThread]: Required dependencies:
[0m17:31:30.258953 [debug] [MainThread]: Executing "git --help"
[0m17:31:30.297685 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:31:30.298682 [debug] [MainThread]: STDERR: "b''"
[0m17:31:30.299679 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:31:30.300677 [info ] [MainThread]: Connection:
[0m17:31:30.301686 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m17:31:30.301686 [info ] [MainThread]:   database: dbt_project
[0m17:31:30.301686 [info ] [MainThread]:   schema: dbo
[0m17:31:30.301686 [info ] [MainThread]:   UID: dbt
[0m17:31:30.301686 [info ] [MainThread]:   client_id: None
[0m17:31:30.306223 [info ] [MainThread]:   authentication: sql
[0m17:31:30.307222 [info ] [MainThread]:   encrypt: False
[0m17:31:30.307222 [info ] [MainThread]:   trust_cert: True
[0m17:31:30.308217 [info ] [MainThread]:   retries: 3
[0m17:31:30.309215 [info ] [MainThread]:   login_timeout: 0
[0m17:31:30.309215 [info ] [MainThread]:   query_timeout: 0
[0m17:31:30.310214 [info ] [MainThread]:   trace_flag: False
[0m17:31:30.311518 [info ] [MainThread]:   port: 1433
[0m17:31:30.312206 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:31:30.551428 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m17:31:30.551428 [debug] [MainThread]: Using sqlserver connection "debug"
[0m17:31:30.551428 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:30.551428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:30.551428 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:31:30.569464 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m17:31:30.569464 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:30.569464 [debug] [MainThread]: On debug: Close
[0m17:31:30.569464 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:31:30.569464 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:31:30.569464 [debug] [MainThread]: Command `dbt debug` succeeded at 17:31:30.569464 after 0.93 seconds
[0m17:31:30.569464 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:30.585113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E99B9FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E994099A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E99AB5340>]}
[0m17:31:30.585113 [debug] [MainThread]: Flushing usage events
[0m17:32:30.675484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019702841F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019702841E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019702841EE0>]}


============================== 17:32:30.679939 | 422bb625-bd76-401c-ac41-748ce5e2d555 ==============================
[0m17:32:30.679939 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:30.680937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:32:31.108204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '422bb625-bd76-401c-ac41-748ce5e2d555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197026DD4F0>]}
[0m17:32:31.160647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '422bb625-bd76-401c-ac41-748ce5e2d555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019702159730>]}
[0m17:32:31.161644 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:32:31.404696 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:31.549027 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:32:31.549027 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:32:31.550025 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:32:31.550025 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:32:31.550994 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:32:31.550994 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:32:31.551991 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:32:31.551991 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:32:31.552989 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:32:31.552989 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:32:31.710555 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:32:31.712536 [debug] [MainThread]: Command `dbt run` failed at 17:32:31.712536 after 1.14 seconds
[0m17:32:31.713534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019701D29DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019704916450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019702841EB0>]}
[0m17:32:31.714542 [debug] [MainThread]: Flushing usage events
[0m17:32:49.650460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A42A71BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A42A73AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A42A73740>]}


============================== 17:32:49.654449 | 86461c3b-c9d0-4641-be9f-e3b13aa5e89f ==============================
[0m17:32:49.654449 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:49.655577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:50.164081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86461c3b-c9d0-4641-be9f-e3b13aa5e89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A43220BC0>]}
[0m17:32:50.232188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86461c3b-c9d0-4641-be9f-e3b13aa5e89f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A40BCD0D0>]}
[0m17:32:50.234183 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:32:50.527163 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:50.725393 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:32:50.725393 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:32:50.726391 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:32:50.726391 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:32:50.727388 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:32:50.727388 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:32:50.728385 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:32:50.728385 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:32:50.729383 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:32:50.730381 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:32:50.923836 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:32:50.926830 [debug] [MainThread]: Command `dbt run` failed at 17:32:50.926830 after 1.38 seconds
[0m17:32:50.926830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3D6B5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A45326AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A436F5F70>]}
[0m17:32:50.927827 [debug] [MainThread]: Flushing usage events
[0m17:33:42.722272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C503C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C6CF2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C40F14F0>]}


============================== 17:33:42.727053 | ef12d493-d3d3-4d1f-bb4c-0c31e7badfd4 ==============================
[0m17:33:42.727053 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:33:42.728023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:43.326988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef12d493-d3d3-4d1f-bb4c-0c31e7badfd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C8257C50>]}
[0m17:33:43.390570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef12d493-d3d3-4d1f-bb4c-0c31e7badfd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C7F263C0>]}
[0m17:33:43.391589 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:33:43.708756 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:33:43.879651 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:33:43.880648 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:33:43.880648 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:33:43.881775 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:33:43.882306 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:33:43.883285 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:33:43.884300 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:33:43.885276 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:33:43.885276 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:33:43.886273 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:33:44.123576 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:33:44.134163 [debug] [MainThread]: Command `dbt run` failed at 17:33:44.133163 after 1.52 seconds
[0m17:33:44.136155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C77E1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C19E54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C8531460>]}
[0m17:33:44.137152 [debug] [MainThread]: Flushing usage events
[0m17:34:40.091608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DBBE0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DEC0F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DE6252B0>]}


============================== 17:34:40.096568 | c8f5fb3b-cd27-4640-8911-48458ffc7cd6 ==============================
[0m17:34:40.096568 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:34:40.097567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:40.571828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f5fb3b-cd27-4640-8911-48458ffc7cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E017B8F0>]}
[0m17:34:40.627737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f5fb3b-cd27-4640-8911-48458ffc7cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DC50E930>]}
[0m17:34:40.628735 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:34:40.872662 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:34:41.021792 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:34:41.022790 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:34:41.022790 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:34:41.023759 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:34:41.024756 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\trips.sql
[0m17:34:41.024756 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:34:41.025573 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:34:41.025573 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:34:41.026506 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:34:41.026506 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:34:41.192828 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:34:41.194609 [debug] [MainThread]: Command `dbt run` failed at 17:34:41.194609 after 1.22 seconds
[0m17:34:41.195615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DF41DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E1516A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DF8D5E20>]}
[0m17:34:41.196583 [debug] [MainThread]: Flushing usage events
[0m17:35:09.187521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C2BA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C2BBC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C2BA270>]}


============================== 17:35:09.192028 | 5bb4d790-1b93-433f-a2c5-1d200eb90fb1 ==============================
[0m17:35:09.192028 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:35:09.192750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:09.212431 [info ] [MainThread]: dbt version: 1.8.9
[0m17:35:09.212431 [info ] [MainThread]: python version: 3.12.2
[0m17:35:09.212431 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m17:35:09.212431 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:35:09.528995 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m17:35:09.529984 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m17:35:09.530967 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m17:35:09.530967 [info ] [MainThread]: adapter type: sqlserver
[0m17:35:09.531997 [info ] [MainThread]: adapter version: 1.8.5
[0m17:35:09.619850 [info ] [MainThread]: Configuration:
[0m17:35:09.620848 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:35:09.621403 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:35:09.622099 [info ] [MainThread]: Required dependencies:
[0m17:35:09.622740 [debug] [MainThread]: Executing "git --help"
[0m17:35:09.661961 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:35:09.661961 [debug] [MainThread]: STDERR: "b''"
[0m17:35:09.662958 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:35:09.663971 [info ] [MainThread]: Connection:
[0m17:35:09.663971 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m17:35:09.665384 [info ] [MainThread]:   database: dbt_project
[0m17:35:09.666004 [info ] [MainThread]:   schema: dbo
[0m17:35:09.667007 [info ] [MainThread]:   UID: dbt
[0m17:35:09.667007 [info ] [MainThread]:   client_id: None
[0m17:35:09.669001 [info ] [MainThread]:   authentication: sql
[0m17:35:09.669001 [info ] [MainThread]:   encrypt: False
[0m17:35:09.669997 [info ] [MainThread]:   trust_cert: True
[0m17:35:09.670993 [info ] [MainThread]:   retries: 3
[0m17:35:09.671991 [info ] [MainThread]:   login_timeout: 0
[0m17:35:09.672997 [info ] [MainThread]:   query_timeout: 0
[0m17:35:09.674985 [info ] [MainThread]:   trace_flag: False
[0m17:35:09.675443 [info ] [MainThread]:   port: 1433
[0m17:35:09.676442 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:35:09.918232 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m17:35:09.918232 [debug] [MainThread]: Using sqlserver connection "debug"
[0m17:35:09.919201 [debug] [MainThread]: On debug: select 1 as id
[0m17:35:09.919201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:09.920197 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:35:09.951874 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m17:35:09.952913 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:09.953913 [debug] [MainThread]: On debug: Close
[0m17:35:09.953913 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:35:09.954910 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:35:09.957059 [debug] [MainThread]: Command `dbt debug` succeeded at 17:35:09.956030 after 0.87 seconds
[0m17:35:09.957059 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:35:09.958027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409BA55DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C84A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409B4529C0>]}
[0m17:35:09.958027 [debug] [MainThread]: Flushing usage events
[0m17:35:38.406459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D89E44E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D89E45A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D865D52E0>]}


============================== 17:35:38.422074 | 4a15bac3-4c8a-4159-b7ef-1322318d1a70 ==============================
[0m17:35:38.422074 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:35:38.422074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:38.907641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a15bac3-4c8a-4159-b7ef-1322318d1a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D89D0DC70>]}
[0m17:35:38.967913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a15bac3-4c8a-4159-b7ef-1322318d1a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D89074170>]}
[0m17:35:38.967913 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:35:39.209204 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 4 files added, 0 files changed.
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_second_dbt_model.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\schema.yml
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\base_trip_data.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\Models\my_first_dbt_model.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\base_trip_data.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_first_dbt_model.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\my_second_dbt_model.sql
[0m17:35:39.362564 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\trips.sql
[0m17:35:39.551215 [error] [MainThread]: Encountered an error:
Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  expected token ',', got ':'
    line 1
      {{ config(materialized: VIEW)}}
[0m17:35:39.553244 [debug] [MainThread]: Command `dbt run` failed at 17:35:39.553244 after 1.23 seconds
[0m17:35:39.553244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D891D2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8BF66810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8AB9E750>]}
[0m17:35:39.553244 [debug] [MainThread]: Flushing usage events
[0m17:38:56.156888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760F011C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760EC50650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760F011B80>]}


============================== 17:38:56.160890 | 0a0a59ad-33d2-49c2-beaa-ce6bca3063a3 ==============================
[0m17:38:56.160890 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:38:56.161887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:56.162886 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:38:56.163883 [debug] [MainThread]: Command `dbt run` failed at 17:38:56.163883 after 0.11 seconds
[0m17:38:56.164909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760E5C29C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760EC50650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001760F07CB30>]}
[0m17:38:56.164909 [debug] [MainThread]: Flushing usage events
[0m17:40:51.322425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12637C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD117152B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD14643950>]}


============================== 17:40:51.344551 | 8e2f52b1-f703-432e-a3b1-65069b46df05 ==============================
[0m17:40:51.344551 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:40:51.344551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:51.760895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12637C80>]}
[0m17:40:51.807760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12B92210>]}
[0m17:40:51.807760 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:40:52.045993 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:40:52.124126 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:40:52.124126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD16F951F0>]}
[0m17:40:53.388566 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m17:40:53.388566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD16EECC80>]}
[0m17:40:53.484233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD15CA04A0>]}
[0m17:40:53.484233 [info ] [MainThread]: Found 3 models, 4 data tests, 502 macros
[0m17:40:53.484233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD1512F530>]}
[0m17:40:53.484233 [info ] [MainThread]: 
[0m17:40:53.484233 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:40:53.484233 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:40:53.507409 [debug] [ThreadPool]: dbt-sqlserver
[0m17:40:53.507409 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:40:53.507409 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:40:53.507409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:53.507409 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:40:53.535530 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:40:53.572040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:53.573039 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:40:53.575141 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:40:53.581127 [debug] [ThreadPool]: dbt-sqlserver
[0m17:40:53.581127 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:40:53.582128 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:40:53.582128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:53.583133 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:40:53.583133 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:40:53.607534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:53.623160 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:40:53.623160 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:40:53.623160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD17175A00>]}
[0m17:40:53.623160 [debug] [MainThread]: On master: COMMIT
[0m17:40:53.623160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:53.623160 [info ] [MainThread]: 
[0m17:40:53.623160 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m17:40:53.623160 [info ] [Thread-1 (]: 1 of 2 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m17:40:53.634040 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.my_first_dbt_model'
[0m17:40:53.634040 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m17:40:53.639566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.639566 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m17:40:53.674045 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:40:53.688227 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw"
[0m17:40:53.688227 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:40:53.688227 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.688227 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_first_dbt_model__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:40:53.688227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:53.688227 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:40:53.688227 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:40:53.721401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.723398 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.723398 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw";');

[0m17:40:53.725769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.740285 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.742364 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.743365 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp" FROM "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.my_first_dbt_model__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_my_first_dbt_model__dbt_tmp_cci'
        AND object_id=object_id('dbo_my_first_dbt_model__dbt_tmp')
    )
    DROP index "dbo"."my_first_dbt_model__dbt_tmp".dbo_my_first_dbt_model__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_my_first_dbt_model__dbt_tmp_cci
    ON "dbo"."my_first_dbt_model__dbt_tmp"

   


  
[0m17:40:53.782719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.782719 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.782719 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model', 'my_first_dbt_model__dbt_backup'
[0m17:40:53.823331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.838981 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.838981 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model__dbt_tmp', 'my_first_dbt_model'
[0m17:40:53.838981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.854597 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m17:40:53.854597 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_backup"
[0m17:40:53.854597 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:40:53.854597 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m17:40:53.870194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.870194 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m17:40:53.870194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12B91460>]}
[0m17:40:53.870194 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 0.25s]
[0m17:40:53.870194 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m17:40:53.870194 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m17:40:53.870194 [info ] [Thread-1 (]: 2 of 2 START sql view model dbo.my_second_dbt_model ............................ [RUN]
[0m17:40:53.870194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.my_second_dbt_model)
[0m17:40:53.870194 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m17:40:53.870194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.870194 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m17:40:53.892212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.892212 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.900707 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_second_dbt_model__dbt_tmp" as -- Use the `ref` function to select from other models

select *
from "dbt_project"."dbo"."my_first_dbt_model"
where id = 1;
    ')


[0m17:40:53.901706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:53.902192 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:40:53.903084 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:40:53.906105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.908150 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.908150 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model', 'my_second_dbt_model__dbt_backup'
[0m17:40:53.908150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.908150 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.908150 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model__dbt_tmp', 'my_second_dbt_model'
[0m17:40:53.918387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.920381 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m17:40:53.921757 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_second_dbt_model__dbt_backup"
[0m17:40:53.921757 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:40:53.921757 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.921757 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:40:53.935710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.935710 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:40:53.935710 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m17:40:53.935710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:53.935710 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: ROLLBACK
[0m17:40:53.935710 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m17:40:53.935710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2f52b1-f703-432e-a3b1-65069b46df05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD170C8A10>]}
[0m17:40:53.935710 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbo.my_second_dbt_model ....................... [[32mOK[0m in 0.07s]
[0m17:40:53.935710 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m17:40:53.935710 [debug] [MainThread]: On master: COMMIT
[0m17:40:53.935710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:53.935710 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:40:53.935710 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:40:53.951313 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m17:40:53.952311 [info ] [MainThread]: 
[0m17:40:53.952311 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:40:53.954306 [debug] [MainThread]: Command end result
[0m17:40:53.987996 [info ] [MainThread]: 
[0m17:40:53.988994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:53.989992 [info ] [MainThread]: 
[0m17:40:53.990990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:40:53.991987 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:53.991987 after 2.84 seconds
[0m17:40:53.992983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD146167E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD15105D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD14DFFF80>]}
[0m17:40:53.992983 [debug] [MainThread]: Flushing usage events
[0m17:41:44.217307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019480E5E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019480EEBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019480EEBA70>]}


============================== 17:41:44.217307 | fa8f357c-172d-444a-b733-13f5c3af16a2 ==============================
[0m17:41:44.217307 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:41:44.232930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:41:44.632088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019480E077A0>]}
[0m17:41:44.694574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FEDBA210>]}
[0m17:41:44.694574 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:41:44.932628 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:41:44.995119 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:41:44.995119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019481220D70>]}
[0m17:41:46.291291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m17:41:46.291291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194810990D0>]}
[0m17:41:46.385537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194831CC680>]}
[0m17:41:46.385537 [info ] [MainThread]: Found 4 models, 4 data tests, 502 macros
[0m17:41:46.385537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194831D4530>]}
[0m17:41:46.385537 [info ] [MainThread]: 
[0m17:41:46.385537 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:41:46.404474 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:41:46.421666 [debug] [ThreadPool]: dbt-sqlserver
[0m17:41:46.422635 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:41:46.422635 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:41:46.423630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:46.423630 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:41:46.452168 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:41:46.452168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:46.452168 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:41:46.452168 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:41:46.468393 [debug] [ThreadPool]: dbt-sqlserver
[0m17:41:46.469391 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:41:46.470389 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:41:46.470389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:46.471385 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:41:46.471385 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:41:46.502233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:46.502233 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:41:46.502233 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:41:46.502233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194831DE840>]}
[0m17:41:46.502233 [debug] [MainThread]: On master: COMMIT
[0m17:41:46.502233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:46.502233 [info ] [MainThread]: 
[0m17:41:46.502233 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:41:46.502233 [info ] [Thread-1 (]: 1 of 3 START sql Table model dbo.base_trip_data ................................ [RUN]
[0m17:41:46.502233 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:41:46.517577 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:41:46.522660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:41:46.522660 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:41:46.585116 [debug] [Thread-1 (]: Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:41:46.586113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194831070B0>]}
[0m17:41:46.587110 [error] [Thread-1 (]: 1 of 3 ERROR creating sql Table model dbo.base_trip_data ....................... [[31mERROR[0m in 0.08s]
[0m17:41:46.588181 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:41:46.589211 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m17:41:46.590207 [info ] [Thread-1 (]: 2 of 3 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m17:41:46.591088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.my_first_dbt_model)
[0m17:41:46.592088 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m17:41:46.594108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.595107 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m17:41:46.635562 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:41:46.635562 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw"
[0m17:41:46.635562 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:41:46.635562 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.635562 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_first_dbt_model__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:41:46.650858 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:46.650858 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:41:46.651863 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:41:46.663441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.665437 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.665437 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw";');

[0m17:41:46.668424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.684381 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.685445 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.685445 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp" FROM "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.my_first_dbt_model__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_my_first_dbt_model__dbt_tmp_cci'
        AND object_id=object_id('dbo_my_first_dbt_model__dbt_tmp')
    )
    DROP index "dbo"."my_first_dbt_model__dbt_tmp".dbo_my_first_dbt_model__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_my_first_dbt_model__dbt_tmp_cci
    ON "dbo"."my_first_dbt_model__dbt_tmp"

   


  
[0m17:41:46.716693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.716693 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.716693 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model', 'my_first_dbt_model__dbt_backup'
[0m17:41:46.716693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.732310 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.732310 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model__dbt_tmp', 'my_first_dbt_model'
[0m17:41:46.732310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.747931 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m17:41:46.747931 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_backup"
[0m17:41:46.747931 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:41:46.747931 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m17:41:46.763577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.763577 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m17:41:46.763577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FEC35460>]}
[0m17:41:46.763577 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 0.17s]
[0m17:41:46.763577 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m17:41:46.763577 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m17:41:46.763577 [info ] [Thread-1 (]: 3 of 3 START sql view model dbo.my_second_dbt_model ............................ [RUN]
[0m17:41:46.763577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.my_second_dbt_model)
[0m17:41:46.763577 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m17:41:46.763577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.763577 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m17:41:46.784830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.784830 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.784830 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_second_dbt_model__dbt_tmp" as -- Use the `ref` function to select from other models

select *
from "dbt_project"."dbo"."my_first_dbt_model"
where id = 1;
    ')


[0m17:41:46.784830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:46.784830 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:41:46.784830 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:41:46.784830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.801883 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.802853 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model', 'my_second_dbt_model__dbt_backup'
[0m17:41:46.805245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.805245 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.805245 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model__dbt_tmp', 'my_second_dbt_model'
[0m17:41:46.805245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.805245 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m17:41:46.805245 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_second_dbt_model__dbt_backup"
[0m17:41:46.818281 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:41:46.819286 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.819286 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:41:46.819286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.819286 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:41:46.819286 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m17:41:46.834632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:46.834632 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: ROLLBACK
[0m17:41:46.834632 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m17:41:46.834632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8f357c-172d-444a-b733-13f5c3af16a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019483985850>]}
[0m17:41:46.834632 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbo.my_second_dbt_model ....................... [[32mOK[0m in 0.07s]
[0m17:41:46.834632 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m17:41:46.834632 [debug] [MainThread]: On master: COMMIT
[0m17:41:46.834632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:46.834632 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:41:46.834632 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:41:46.834632 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m17:41:46.834632 [info ] [MainThread]: 
[0m17:41:46.834632 [info ] [MainThread]: Finished running 1 Table model, 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m17:41:46.845494 [debug] [MainThread]: Command end result
[0m17:41:46.872151 [info ] [MainThread]: 
[0m17:41:46.872151 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:41:46.872151 [info ] [MainThread]: 
[0m17:41:46.872151 [error] [MainThread]:   Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:41:46.872151 [info ] [MainThread]: 
[0m17:41:46.872151 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:41:46.882991 [debug] [MainThread]: Command `dbt run` failed at 17:41:46.882991 after 2.76 seconds
[0m17:41:46.882991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019480D13E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194FD7B4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001948322E8D0>]}
[0m17:41:46.883964 [debug] [MainThread]: Flushing usage events
[0m17:41:59.601335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208700A0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020870048B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020870049160>]}


============================== 17:41:59.616986 | 3e8aadfe-afa4-4002-9336-5c19f7f788f7 ==============================
[0m17:41:59.616986 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:41:59.616986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:42:00.029810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020873A7E120>]}
[0m17:42:00.087230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020872F71EE0>]}
[0m17:42:00.087230 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:42:00.319336 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:42:00.400697 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:42:00.400697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087589EC60>]}
[0m17:42:01.672086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m17:42:01.682256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208758C09B0>]}
[0m17:42:01.772287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087459C050>]}
[0m17:42:01.772287 [info ] [MainThread]: Found 4 models, 4 data tests, 502 macros
[0m17:42:01.772287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208745F6330>]}
[0m17:42:01.772287 [info ] [MainThread]: 
[0m17:42:01.772287 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:42:01.789777 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:42:01.805949 [debug] [ThreadPool]: dbt-sqlserver
[0m17:42:01.806949 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:42:01.806949 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:42:01.807947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:01.807947 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:42:01.835551 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:42:01.835551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:01.835551 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:42:01.835551 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:42:01.835551 [debug] [ThreadPool]: dbt-sqlserver
[0m17:42:01.835551 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:42:01.835551 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:42:01.835551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:01.835551 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:42:01.835551 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:42:01.852607 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:01.853605 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:42:01.854602 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:42:01.856027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208744816A0>]}
[0m17:42:01.856027 [debug] [MainThread]: On master: COMMIT
[0m17:42:01.857055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:01.857685 [info ] [MainThread]: 
[0m17:42:01.861295 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:42:01.862307 [info ] [Thread-1 (]: 1 of 4 START sql Table model dbo.base_trip_data ................................ [RUN]
[0m17:42:01.863296 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:42:01.863296 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:42:01.868781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:42:01.872938 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:42:01.875945 [debug] [Thread-1 (]: Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:42:01.876963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020875B93F50>]}
[0m17:42:01.878033 [error] [Thread-1 (]: 1 of 4 ERROR creating sql Table model dbo.base_trip_data ....................... [[31mERROR[0m in 0.01s]
[0m17:42:01.878033 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:42:01.878033 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m17:42:01.878033 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.my_first_dbt_model ............................ [RUN]
[0m17:42:01.878033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.my_first_dbt_model)
[0m17:42:01.878033 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m17:42:01.885961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.886958 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m17:42:01.921232 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:42:01.935461 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw"
[0m17:42:01.935461 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:42:01.935461 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.935461 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_first_dbt_model__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:42:01.935461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:01.935461 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:42:01.935461 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:42:01.935461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:01.935461 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.935461 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw";');

[0m17:42:01.935461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:01.963629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.964625 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.965595 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" as /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp" FROM "dbt_project"."dbo"."my_first_dbt_model__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.my_first_dbt_model__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_my_first_dbt_model__dbt_tmp_cci'
        AND object_id=object_id('dbo_my_first_dbt_model__dbt_tmp')
    )
    DROP index "dbo"."my_first_dbt_model__dbt_tmp".dbo_my_first_dbt_model__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_my_first_dbt_model__dbt_tmp_cci
    ON "dbo"."my_first_dbt_model__dbt_tmp"

   


  
[0m17:42:01.978860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:01.984894 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.984894 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model', 'my_first_dbt_model__dbt_backup'
[0m17:42:01.984894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:01.984894 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:01.984894 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_first_dbt_model__dbt_tmp', 'my_first_dbt_model'
[0m17:42:01.984894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.000516 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m17:42:02.016137 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_first_dbt_model__dbt_backup"
[0m17:42:02.016137 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_first_dbt_model"
[0m17:42:02.016137 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."my_first_dbt_model__dbt_backup";');

[0m17:42:02.016137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.016137 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m17:42:02.016137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208714C5160>]}
[0m17:42:02.016137 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.my_first_dbt_model ....................... [[32mOK[0m in 0.14s]
[0m17:42:02.016137 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m17:42:02.016137 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:42:02.016137 [info ] [Thread-1 (]: 3 of 4 START sql Table model dbo.trips ......................................... [RUN]
[0m17:42:02.016137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.trips)
[0m17:42:02.016137 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:42:02.016137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:42:02.016137 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:42:02.037012 [debug] [Thread-1 (]: Compilation Error in model trips (models\Models\trips.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:42:02.037509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208759F6960>]}
[0m17:42:02.037509 [error] [Thread-1 (]: 3 of 4 ERROR creating sql Table model dbo.trips ................................ [[31mERROR[0m in 0.02s]
[0m17:42:02.040300 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:42:02.040300 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m17:42:02.041310 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.my_second_dbt_model ............................ [RUN]
[0m17:42:02.042399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.trips, now model.dbt_proj.my_second_dbt_model)
[0m17:42:02.043397 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m17:42:02.045391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.046436 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m17:42:02.059062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.059062 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.059062 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."my_second_dbt_model__dbt_tmp" as -- Use the `ref` function to select from other models

select *
from "dbt_project"."dbo"."my_first_dbt_model"
where id = 1;
    ')


[0m17:42:02.059062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:02.059062 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:42:02.059062 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:42:02.059062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.067715 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.067715 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model', 'my_second_dbt_model__dbt_backup'
[0m17:42:02.072750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.072750 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.072750 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.my_second_dbt_model__dbt_tmp', 'my_second_dbt_model'
[0m17:42:02.072750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.072750 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m17:42:02.084607 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."my_second_dbt_model__dbt_backup"
[0m17:42:02.084607 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:42:02.084607 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.084607 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'my_second_dbt_model__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:42:02.084607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.084607 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.my_second_dbt_model"
[0m17:42:02.084607 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."my_second_dbt_model__dbt_backup";');

[0m17:42:02.084607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:02.084607 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: ROLLBACK
[0m17:42:02.084607 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m17:42:02.084607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e8aadfe-afa4-4002-9336-5c19f7f788f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020876254CB0>]}
[0m17:42:02.084607 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.my_second_dbt_model ....................... [[32mOK[0m in 0.04s]
[0m17:42:02.084607 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m17:42:02.084607 [debug] [MainThread]: On master: COMMIT
[0m17:42:02.100210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:02.101112 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:42:02.101112 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:42:02.101112 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m17:42:02.101112 [info ] [MainThread]: 
[0m17:42:02.101112 [info ] [MainThread]: Finished running 2 Table models, 1 table model, 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:42:02.105775 [debug] [MainThread]: Command end result
[0m17:42:02.135967 [info ] [MainThread]: 
[0m17:42:02.136961 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:42:02.138646 [info ] [MainThread]: 
[0m17:42:02.139645 [error] [MainThread]:   Compilation Error in model base_trip_data (models\Models\base_trip_data.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:42:02.140642 [info ] [MainThread]: 
[0m17:42:02.142061 [error] [MainThread]:   Compilation Error in model trips (models\Models\trips.sql)
  No materialization 'Table' was found for adapter sqlserver! (searched types 'default' and 'sqlserver')
[0m17:42:02.143052 [info ] [MainThread]: 
[0m17:42:02.144050 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m17:42:02.145109 [debug] [MainThread]: Command `dbt run` failed at 17:42:02.145109 after 2.63 seconds
[0m17:42:02.145109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208700A0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208736DE6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020872D3E6C0>]}
[0m17:42:02.145109 [debug] [MainThread]: Flushing usage events
[0m17:43:30.494517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2851EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2853770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2850860>]}


============================== 17:43:30.494517 | 220a92c5-005f-4153-9881-f170025a8a2c ==============================
[0m17:43:30.494517 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:43:30.494517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:30.919608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D3562D50>]}
[0m17:43:30.970089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D288A2D0>]}
[0m17:43:30.970089 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:43:31.215601 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:43:31.294962 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:43:31.294962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D48654C0>]}
[0m17:43:32.467216 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m17:43:32.470810 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m17:43:32.565183 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:43:32.567461 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:43:32.568458 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:43:32.569456 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:43:32.643015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m17:43:32.649000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D4889460>]}
[0m17:43:32.734392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D49D07A0>]}
[0m17:43:32.734392 [info ] [MainThread]: Found 2 models, 502 macros
[0m17:43:32.734392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D478D8B0>]}
[0m17:43:32.734392 [info ] [MainThread]: 
[0m17:43:32.734392 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:43:32.751592 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:43:32.768776 [debug] [ThreadPool]: dbt-sqlserver
[0m17:43:32.769796 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:43:32.769796 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:43:32.770771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:32.770771 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:43:32.800464 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:43:32.801903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:32.801903 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:43:32.801903 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:43:32.801903 [debug] [ThreadPool]: dbt-sqlserver
[0m17:43:32.801903 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:43:32.801903 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:43:32.801903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:32.801903 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:43:32.801903 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:43:32.821970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:32.822970 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:43:32.823967 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:43:32.825332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D29CF260>]}
[0m17:43:32.825332 [debug] [MainThread]: On master: COMMIT
[0m17:43:32.826380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:32.827330 [info ] [MainThread]: 
[0m17:43:32.830453 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:43:32.830453 [info ] [Thread-1 (]: 1 of 2 START sql view model dbo.base_trip_data ................................. [RUN]
[0m17:43:32.831481 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:43:32.832451 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:43:32.838145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:43:32.838145 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:43:32.870850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:43:32.870850 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:43:32.870850 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m17:43:32.870850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:32.870850 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:43:32.870850 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:43:32.885220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.903523 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:43:32.904525 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:43:32.908113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.923479 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:43:32.929463 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:43:32.935459 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:43:32.935459 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:43:32.935459 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:43:32.951082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.951082 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:43:32.951082 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:43:32.951082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.951082 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m17:43:32.951082 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:43:32.951082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D45F64E0>]}
[0m17:43:32.951082 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.12s]
[0m17:43:32.951082 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:43:32.951082 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:43:32.966703 [info ] [Thread-1 (]: 2 of 2 START sql view model dbo.trips .......................................... [RUN]
[0m17:43:32.966703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.trips)
[0m17:43:32.966703 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:43:32.966703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:43:32.966703 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:43:32.966703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:43:32.966703 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:43:32.966703 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m17:43:32.966703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:32.966703 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:43:32.966703 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:43:32.984098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.987086 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:43:32.988083 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:43:32.990497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:32.992494 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:43:32.994488 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:43:32.995495 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:43:32.996483 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:43:32.996483 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:43:33.001787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:33.001787 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:43:33.001787 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:43:33.001787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:33.001787 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m17:43:33.001787 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:43:33.001787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220a92c5-005f-4153-9881-f170025a8a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D515F170>]}
[0m17:43:33.001787 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.04s]
[0m17:43:33.001787 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:43:33.017789 [debug] [MainThread]: On master: COMMIT
[0m17:43:33.017789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:33.017789 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:43:33.017789 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:43:33.017789 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:43:33.017789 [info ] [MainThread]: 
[0m17:43:33.017789 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:43:33.022981 [debug] [MainThread]: Command end result
[0m17:43:33.056029 [info ] [MainThread]: 
[0m17:43:33.056999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:33.057993 [info ] [MainThread]: 
[0m17:43:33.059005 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:43:33.059005 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:33.059005 after 2.66 seconds
[0m17:43:33.059005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D28B9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D1C80920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D1C806E0>]}
[0m17:43:33.059005 [debug] [MainThread]: Flushing usage events
[0m18:02:55.848419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F669B00E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68B611F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68B63C80>]}


============================== 18:02:55.864041 | 230c8e3f-9e44-453f-b439-62b9f7e00b5d ==============================
[0m18:02:55.864041 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:02:55.864041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:02:56.434353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F69BCB830>]}
[0m18:02:56.512465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F694AA570>]}
[0m18:02:56.512465 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m18:02:56.797052 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:02:56.912918 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:02:56.912918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B3359D0>]}
[0m18:02:58.461663 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m18:02:58.471696 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m18:02:58.684355 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:02:58.684355 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:02:58.684355 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:02:58.684355 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:02:58.834854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m18:02:58.836870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6AEE0A70>]}
[0m18:02:58.936197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B4D08C0>]}
[0m18:02:58.936197 [info ] [MainThread]: Found 4 models, 502 macros
[0m18:02:58.936197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B4A9D60>]}
[0m18:02:58.936197 [info ] [MainThread]: 
[0m18:02:58.936197 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:02:58.954031 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m18:02:58.959211 [debug] [ThreadPool]: dbt-sqlserver
[0m18:02:58.959211 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m18:02:58.971402 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m18:02:58.972182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:58.973181 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.005892 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.005892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.005892 [debug] [ThreadPool]: On list_dbt_project: Close
[0m18:02:59.005892 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m18:02:59.027961 [debug] [ThreadPool]: dbt-sqlserver
[0m18:02:59.028958 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m18:02:59.029955 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m18:02:59.029955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:59.030954 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.031950 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.082369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.084363 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m18:02:59.085362 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m18:02:59.088014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B4A8560>]}
[0m18:02:59.088014 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.088014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:59.088014 [info ] [MainThread]: 
[0m18:02:59.088014 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m18:02:59.088014 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m18:02:59.088014 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m18:02:59.097903 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m18:02:59.108424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m18:02:59.110205 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m18:02:59.158813 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m18:02:59.160809 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:02:59.160809 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m18:02:59.161805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:59.161805 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.162802 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.168786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.176608 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:02:59.177606 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m18:02:59.184617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.189624 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:02:59.189624 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m18:02:59.189624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.205246 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m18:02:59.205246 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m18:02:59.220868 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:02:59.220868 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:02:59.220868 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:02:59.236994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.236994 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:02:59.236994 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m18:02:59.252619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.252619 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m18:02:59.252619 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m18:02:59.252619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68F8A000>]}
[0m18:02:59.252619 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.16s]
[0m18:02:59.252619 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m18:02:59.252619 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m18:02:59.252619 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m18:02:59.252619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m18:02:59.252619 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m18:02:59.268240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m18:02:59.270087 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m18:02:59.273576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m18:02:59.273576 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m18:02:59.273576 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails
ORDER BY 1;
    ')


[0m18:02:59.273576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:59.273576 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.273576 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.273576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.273576 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m18:02:59.273576 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m18:02:59.273576 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\Models\location_details.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m18:02:59.389584 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 81, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')

[0m18:02:59.389584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6BC13770>]}
[0m18:02:59.389584 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dbo.location_details ...................... [[31mERROR[0m in 0.14s]
[0m18:02:59.389584 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m18:02:59.389584 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m18:02:59.405207 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m18:02:59.405207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m18:02:59.405207 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m18:02:59.405207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m18:02:59.405207 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m18:02:59.405207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m18:02:59.423899 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:02:59.423899 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m18:02:59.423899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:59.423899 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.423899 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.423899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.440982 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:02:59.441979 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m18:02:59.444972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.447963 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m18:02:59.453947 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m18:02:59.454892 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:02:59.456241 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:02:59.457840 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:02:59.471336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.475324 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:02:59.476324 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m18:02:59.476830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.476830 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m18:02:59.476830 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m18:02:59.476830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6BC7C800>]}
[0m18:02:59.476830 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbo.temporal_data ............................. [[32mOK[0m in 0.07s]
[0m18:02:59.476830 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m18:02:59.476830 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m18:02:59.476830 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m18:02:59.476830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m18:02:59.476830 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m18:02:59.487997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m18:02:59.490807 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m18:02:59.495815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m18:02:59.495815 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:02:59.495815 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m18:02:59.495815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:59.495815 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:02:59.495815 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:02:59.495815 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.506669 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:02:59.507643 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m18:02:59.507643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.507643 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:02:59.507643 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m18:02:59.507643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.507643 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m18:02:59.526035 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m18:02:59.529027 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:02:59.530039 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:02:59.530039 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:02:59.540267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.540267 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:02:59.540267 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m18:02:59.540267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:59.540267 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m18:02:59.540267 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m18:02:59.540267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '230c8e3f-9e44-453f-b439-62b9f7e00b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B5D30E0>]}
[0m18:02:59.540267 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.06s]
[0m18:02:59.554707 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m18:02:59.555752 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.555752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:59.555752 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m18:02:59.555752 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m18:02:59.555752 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m18:02:59.555752 [info ] [MainThread]: 
[0m18:02:59.555752 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m18:02:59.562714 [debug] [MainThread]: Command end result
[0m18:02:59.594094 [info ] [MainThread]: 
[0m18:02:59.595106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:59.596088 [info ] [MainThread]: 
[0m18:02:59.597085 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m18:02:59.598147 [info ] [MainThread]: 
[0m18:02:59.598147 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:02:59.600336 [debug] [MainThread]: Command `dbt run` failed at 18:02:59.600336 after 3.85 seconds
[0m18:02:59.600336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68B329C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68B320F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F68BC4FE0>]}
[0m18:02:59.601334 [debug] [MainThread]: Flushing usage events
[0m18:03:38.969904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025327A686B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532B45E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532AA42EA0>]}


============================== 18:03:38.985554 | 3b1314e4-ab13-4c01-a7c0-e327388460f3 ==============================
[0m18:03:38.985554 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:03:38.985554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:03:39.408539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532AF6BB30>]}
[0m18:03:39.455403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532A8143E0>]}
[0m18:03:39.471009 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m18:03:39.709170 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:03:39.771647 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:03:39.771647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D5C5E80>]}
[0m18:03:40.888601 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m18:03:40.890641 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m18:03:40.984770 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:03:40.985737 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:03:40.986733 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:03:40.987223 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:03:41.062104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m18:03:41.068110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D62CF20>]}
[0m18:03:41.155018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532B78A7E0>]}
[0m18:03:41.155018 [info ] [MainThread]: Found 4 models, 502 macros
[0m18:03:41.155018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D7CDBB0>]}
[0m18:03:41.155018 [info ] [MainThread]: 
[0m18:03:41.155018 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:03:41.155018 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m18:03:41.177291 [debug] [ThreadPool]: dbt-sqlserver
[0m18:03:41.177291 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m18:03:41.177291 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m18:03:41.177291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:41.177291 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.207371 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.207371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:41.207371 [debug] [ThreadPool]: On list_dbt_project: Close
[0m18:03:41.221257 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m18:03:41.222334 [debug] [ThreadPool]: dbt-sqlserver
[0m18:03:41.222334 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m18:03:41.222334 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m18:03:41.222334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:41.222334 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.222334 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.222334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:41.237915 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m18:03:41.237915 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m18:03:41.240384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532C1A1BB0>]}
[0m18:03:41.240384 [debug] [MainThread]: On master: COMMIT
[0m18:03:41.241414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:41.242381 [info ] [MainThread]: 
[0m18:03:41.246092 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m18:03:41.246092 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m18:03:41.247280 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m18:03:41.248291 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m18:03:41.255597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m18:03:41.255953 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m18:03:41.289390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m18:03:41.289390 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:03:41.289390 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m18:03:41.289390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:41.289390 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.289390 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.308108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.314122 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:03:41.315092 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m18:03:41.318454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.322572 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:03:41.322572 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m18:03:41.325248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.339265 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m18:03:41.339265 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m18:03:41.339265 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:03:41.354909 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:03:41.354909 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:03:41.354909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.354909 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m18:03:41.354909 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m18:03:41.354909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.354909 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m18:03:41.354909 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m18:03:41.354909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253291F1340>]}
[0m18:03:41.370775 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.11s]
[0m18:03:41.370775 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m18:03:41.370775 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m18:03:41.370775 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m18:03:41.374028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m18:03:41.374028 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m18:03:41.374028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m18:03:41.374028 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m18:03:41.374028 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m18:03:41.374028 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m18:03:41.374028 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')


[0m18:03:41.374028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:41.374028 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.374028 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.374028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.392042 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m18:03:41.393306 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m18:03:41.395435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.395435 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m18:03:41.395435 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m18:03:41.395435 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:03:41.395435 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m18:03:41.395435 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:03:41.423364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.423364 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m18:03:41.423364 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_backup";');

[0m18:03:41.423364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.423364 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m18:03:41.423364 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m18:03:41.423364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DF38C20>]}
[0m18:03:41.423364 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbo.location_details .......................... [[32mOK[0m in 0.05s]
[0m18:03:41.423364 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m18:03:41.423364 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m18:03:41.423364 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m18:03:41.423364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m18:03:41.423364 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m18:03:41.437891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m18:03:41.439001 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m18:03:41.444726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m18:03:41.445782 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:03:41.445782 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m18:03:41.445782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:41.445782 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.445782 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.445782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.455664 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:03:41.457202 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m18:03:41.457202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.457202 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:03:41.457202 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m18:03:41.457202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.457202 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m18:03:41.457202 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m18:03:41.457202 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:03:41.473187 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:03:41.473860 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:03:41.475231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.476231 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m18:03:41.477228 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m18:03:41.478243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.478243 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m18:03:41.478243 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m18:03:41.478243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DF521E0>]}
[0m18:03:41.478243 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbo.temporal_data ............................. [[32mOK[0m in 0.05s]
[0m18:03:41.478243 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m18:03:41.478243 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m18:03:41.478243 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m18:03:41.478243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m18:03:41.478243 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m18:03:41.489897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m18:03:41.491250 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m18:03:41.495278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m18:03:41.495278 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:03:41.495278 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m18:03:41.495278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:41.495278 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m18:03:41.495278 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m18:03:41.495278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.504600 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:03:41.505597 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m18:03:41.507622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.508735 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:03:41.508735 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m18:03:41.508735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.508735 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m18:03:41.508735 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m18:03:41.508735 [debug] [Thread-1 (]: dbt-sqlserver
[0m18:03:41.508735 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:03:41.521247 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m18:03:41.523040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.525064 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m18:03:41.525064 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m18:03:41.527182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:41.528111 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m18:03:41.528111 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m18:03:41.528111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1314e4-ab13-4c01-a7c0-e327388460f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D8A8DA0>]}
[0m18:03:41.528111 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.05s]
[0m18:03:41.528111 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m18:03:41.528111 [debug] [MainThread]: On master: COMMIT
[0m18:03:41.528111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:41.528111 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m18:03:41.528111 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m18:03:41.528111 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m18:03:41.528111 [info ] [MainThread]: 
[0m18:03:41.528111 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:03:41.538253 [debug] [MainThread]: Command end result
[0m18:03:41.561529 [info ] [MainThread]: 
[0m18:03:41.561529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:41.571936 [info ] [MainThread]: 
[0m18:03:41.572926 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:03:41.573923 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:41.573923 after 2.69 seconds
[0m18:03:41.574947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532A537D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532A5346B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532AD175F0>]}
[0m18:03:41.576038 [debug] [MainThread]: Flushing usage events
[0m16:55:32.809306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C180A5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C17CE7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14F88EC0>]}


============================== 16:55:32.809306 | f2a011a3-f9bf-487a-9c4b-a359efd0ae2b ==============================
[0m16:55:32.809306 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:55:32.809306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:55:32.824927 [info ] [MainThread]: dbt version: 1.8.9
[0m16:55:32.840549 [info ] [MainThread]: python version: 3.12.2
[0m16:55:32.842007 [info ] [MainThread]: python path: Z:\Archives\dbt_Project\dbt_venv\Scripts\python.exe
[0m16:55:32.843243 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m16:55:34.798003 [info ] [MainThread]: Using profiles dir at C:\Users\wmuntu\.dbt
[0m16:55:34.798003 [info ] [MainThread]: Using profiles.yml file at C:\Users\wmuntu\.dbt\profiles.yml
[0m16:55:34.798003 [info ] [MainThread]: Using dbt_project.yml file at Z:\Archives\dbt_Project\dbt_proj\dbt_project.yml
[0m16:55:34.798003 [info ] [MainThread]: adapter type: sqlserver
[0m16:55:34.798003 [info ] [MainThread]: adapter version: 1.8.5
[0m16:55:34.888891 [info ] [MainThread]: Configuration:
[0m16:55:34.889857 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:55:34.890486 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:55:34.891486 [info ] [MainThread]: Required dependencies:
[0m16:55:34.892499 [debug] [MainThread]: Executing "git --help"
[0m16:55:34.933640 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:55:34.934644 [debug] [MainThread]: STDERR: "b''"
[0m16:55:34.935550 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:55:34.935550 [info ] [MainThread]: Connection:
[0m16:55:34.935550 [info ] [MainThread]:   server: Calrom-dev161\SQLEXPRESS01
[0m16:55:34.935550 [info ] [MainThread]:   database: dbt_project
[0m16:55:34.935550 [info ] [MainThread]:   schema: dbo
[0m16:55:34.935550 [info ] [MainThread]:   UID: dbt
[0m16:55:34.935550 [info ] [MainThread]:   client_id: None
[0m16:55:34.942792 [info ] [MainThread]:   authentication: sql
[0m16:55:34.943803 [info ] [MainThread]:   encrypt: False
[0m16:55:34.943803 [info ] [MainThread]:   trust_cert: True
[0m16:55:34.944787 [info ] [MainThread]:   retries: 3
[0m16:55:34.945811 [info ] [MainThread]:   login_timeout: 0
[0m16:55:34.947068 [info ] [MainThread]:   query_timeout: 0
[0m16:55:34.947068 [info ] [MainThread]:   trace_flag: False
[0m16:55:34.947068 [info ] [MainThread]:   port: 1433
[0m16:55:34.947068 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m16:55:35.260661 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m16:55:35.260661 [debug] [MainThread]: Using sqlserver connection "debug"
[0m16:55:35.260661 [debug] [MainThread]: On debug: select 1 as id
[0m16:55:35.260661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:35.260661 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:35.345256 [debug] [MainThread]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:35.345256 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:35.345256 [debug] [MainThread]: On debug: Close
[0m16:55:35.345256 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:55:35.345256 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:55:35.345256 [debug] [MainThread]: Command `dbt debug` succeeded at 16:55:35.345256 after 2.64 seconds
[0m16:55:35.345256 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:55:35.345256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14DF5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C17991F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C17992960>]}
[0m16:55:35.345256 [debug] [MainThread]: Flushing usage events
[0m16:55:45.490100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6DE7DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6E709070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D71FA0770>]}


============================== 16:55:45.490100 | 22dc7139-6479-4121-8c46-15bb8a3a8ff8 ==============================
[0m16:55:45.490100 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:55:45.490100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:45.969581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D72AD2E40>]}
[0m16:55:46.042129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D721B0200>]}
[0m16:55:46.042129 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m16:55:46.307409 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:55:46.376404 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:55:46.376404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D73FA5A00>]}
[0m16:55:48.063824 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:55:48.073901 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:55:48.165670 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:55:48.166644 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:55:48.167641 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:55:48.168669 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:55:48.237930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m16:55:48.246041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D72C2E390>]}
[0m16:55:48.347038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D74112240>]}
[0m16:55:48.347038 [info ] [MainThread]: Found 4 models, 502 macros
[0m16:55:48.357048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D74048200>]}
[0m16:55:48.357048 [info ] [MainThread]: 
[0m16:55:48.357048 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:55:48.357048 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m16:55:48.379136 [debug] [ThreadPool]: dbt-sqlserver
[0m16:55:48.379136 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m16:55:48.379136 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:55:48.379136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:48.379136 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.405628 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.418685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:48.418685 [debug] [ThreadPool]: On list_dbt_project: Close
[0m16:55:48.418685 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m16:55:48.418685 [debug] [ThreadPool]: dbt-sqlserver
[0m16:55:48.418685 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m16:55:48.418685 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:55:48.418685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:48.418685 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.418685 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.483949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:48.483949 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m16:55:48.483949 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m16:55:48.483949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D740445C0>]}
[0m16:55:48.483949 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.483949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:48.483949 [info ] [MainThread]: 
[0m16:55:48.483949 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m16:55:48.483949 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m16:55:48.483949 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m16:55:48.499148 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m16:55:48.505568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m16:55:48.505568 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m16:55:48.538059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m16:55:48.538059 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:55:48.538059 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
    SELECT *
    FROM [dbo].[FHV_Trip_Records] 
    WHERE 
        trip_miles >= 0 AND 
        trip_time >= 0 AND
        request_datetime IS NOT NULL AND
        pickup_datetime IS NOT NULL AND
        dropoff_datetime IS NOT NULL
)
SELECT *
FROM cleaned_data
WHERE 
    trip_miles < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_miles) OVER () FROM cleaned_data) AND
    trip_time < (SELECT TOP 1 PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY trip_time) OVER () FROM cleaned_data);;
    ')


[0m16:55:48.538059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:48.538059 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.538059 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.557927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.570433 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:55:48.570433 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m16:55:48.751691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.758219 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:55:48.758219 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m16:55:48.758219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.773867 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m16:55:48.773867 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m16:55:48.789488 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:55:48.789488 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:55:48.789488 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:55:48.805114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.805114 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:55:48.805114 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m16:55:48.805114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.805114 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m16:55:48.805114 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m16:55:48.820710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6FB84FE0>]}
[0m16:55:48.820710 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.34s]
[0m16:55:48.820710 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m16:55:48.820710 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m16:55:48.820710 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m16:55:48.820710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m16:55:48.820710 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m16:55:48.820710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m16:55:48.820710 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m16:55:48.841680 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m16:55:48.842680 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:55:48.843702 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')


[0m16:55:48.843702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:48.843702 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.843702 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.843702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.853959 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:55:48.854962 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m16:55:48.856896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.858942 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:55:48.858942 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m16:55:48.858942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.858942 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m16:55:48.867239 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m16:55:48.869238 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:55:48.869461 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:55:48.869461 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:55:48.869461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.869461 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:55:48.869461 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_backup";');

[0m16:55:48.884899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.885401 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m16:55:48.885401 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m16:55:48.885401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7423F470>]}
[0m16:55:48.885401 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbo.location_details .......................... [[32mOK[0m in 0.06s]
[0m16:55:48.885401 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m16:55:48.885401 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m16:55:48.885401 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m16:55:48.885401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m16:55:48.885401 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m16:55:48.885401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m16:55:48.885401 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m16:55:48.900531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m16:55:48.901529 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:55:48.902525 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m16:55:48.903741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:48.903741 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.904768 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.906780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.906780 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:55:48.906780 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m16:55:48.906780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.917219 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:55:48.918223 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m16:55:48.920687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.922713 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m16:55:48.924708 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m16:55:48.925729 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:55:48.925729 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:55:48.925729 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:55:48.938085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.938085 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:55:48.938085 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m16:55:48.938085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.938085 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m16:55:48.938085 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m16:55:48.938085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D74906FC0>]}
[0m16:55:48.938085 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbo.temporal_data ............................. [[32mOK[0m in 0.05s]
[0m16:55:48.938085 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m16:55:48.938085 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m16:55:48.938085 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m16:55:48.938085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m16:55:48.938085 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m16:55:48.954246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m16:55:48.955252 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m16:55:48.959272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m16:55:48.959272 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:55:48.959272 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m16:55:48.959272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:48.959272 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:55:48.959272 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:55:48.959272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.969396 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:55:48.969396 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m16:55:48.969396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.969396 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:55:48.969396 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m16:55:48.969396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.969396 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m16:55:48.983924 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m16:55:48.985942 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:55:48.986946 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:55:48.986946 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:55:48.991951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:48.991951 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:55:48.991951 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m16:55:49.002594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:49.002877 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m16:55:49.002877 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m16:55:49.002877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dc7139-6479-4121-8c46-15bb8a3a8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D741398B0>]}
[0m16:55:49.002877 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.06s]
[0m16:55:49.002877 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m16:55:49.002877 [debug] [MainThread]: On master: COMMIT
[0m16:55:49.002877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:49.002877 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m16:55:49.002877 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m16:55:49.002877 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m16:55:49.002877 [info ] [MainThread]: 
[0m16:55:49.002877 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m16:55:49.013938 [debug] [MainThread]: Command end result
[0m16:55:49.042886 [info ] [MainThread]: 
[0m16:55:49.042886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:49.042886 [info ] [MainThread]: 
[0m16:55:49.042886 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:55:49.042886 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:49.042886 after 3.65 seconds
[0m16:55:49.042886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D70F8A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D710FF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D710FF6B0>]}
[0m16:55:49.050538 [debug] [MainThread]: Flushing usage events
[0m16:56:54.203474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457CD59310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457F60ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457EF27770>]}


============================== 16:56:54.203474 | 3e058652-d5a8-46b8-91a2-a0757e0635cb ==============================
[0m16:56:54.203474 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:56:54.203474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:56:54.635060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457FF23830>]}
[0m16:56:54.697602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457FD4F1A0>]}
[0m16:56:54.697602 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m16:56:54.944006 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:56:55.041915 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:56:55.041915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014501975460>]}
[0m16:56:56.354208 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:56:56.362249 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:56:56.462910 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:56:56.464910 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:56:56.465902 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:56:56.466899 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:56:56.571412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m16:56:56.578394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145016D6960>]}
[0m16:56:56.672446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014501AF14C0>]}
[0m16:56:56.672446 [info ] [MainThread]: Found 4 models, 502 macros
[0m16:56:56.672446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145017258E0>]}
[0m16:56:56.672446 [info ] [MainThread]: 
[0m16:56:56.672446 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:56:56.689667 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m16:56:56.705911 [debug] [ThreadPool]: dbt-sqlserver
[0m16:56:56.706921 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m16:56:56.707877 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:56:56.707877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:56.708875 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:56.779545 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:56.784532 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:56.786550 [debug] [ThreadPool]: On list_dbt_project: Close
[0m16:56:56.786550 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m16:56:56.786550 [debug] [ThreadPool]: dbt-sqlserver
[0m16:56:56.786550 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m16:56:56.786550 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:56:56.786550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:56.786550 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:56.786550 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:56.833416 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:56.849038 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m16:56:56.849038 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m16:56:56.849038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014501A6B590>]}
[0m16:56:56.849038 [debug] [MainThread]: On master: COMMIT
[0m16:56:56.849038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:56.849038 [info ] [MainThread]: 
[0m16:56:56.849038 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m16:56:56.849038 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m16:56:56.849038 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m16:56:56.862368 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m16:56:56.873824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m16:56:56.874821 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m16:56:56.930375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m16:56:56.931377 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:56:56.932370 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as ;WITH cleaned_data AS (
SELECT
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;;
    ')


[0m16:56:56.932370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:56.933367 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:56.934368 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:56.935270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:56.936276 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m16:56:56.937298 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m16:56:56.938265 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\Models\base_trip_data.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")
[0m16:56:57.015909 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 81, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")

[0m16:56:57.017903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145016D6240>]}
[0m16:56:57.018900 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dbo.base_trip_data ........................ [[31mERROR[0m in 0.17s]
[0m16:56:57.019897 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m16:56:57.019897 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m16:56:57.019897 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m16:56:57.019897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m16:56:57.019897 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m16:56:57.019897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m16:56:57.019897 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m16:56:57.019897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m16:56:57.019897 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:56:57.019897 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')


[0m16:56:57.019897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:57.019897 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:57.019897 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:57.019897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:57.036587 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m16:56:57.037585 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m16:56:57.038697 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\Models\location_details.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.042177 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 81, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")

[0m16:56:57.042177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014501C57650>]}
[0m16:56:57.042177 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dbo.location_details ...................... [[31mERROR[0m in 0.02s]
[0m16:56:57.042177 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m16:56:57.046249 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m16:56:57.047275 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m16:56:57.048245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m16:56:57.048245 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m16:56:57.050264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m16:56:57.051681 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m16:56:57.058455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m16:56:57.059480 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:56:57.060448 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m16:56:57.061447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:57.061447 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:57.062516 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:57.062516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:57.062516 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m16:56:57.062516 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m16:56:57.062516 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\Models\temporal_data.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.068750 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 81, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")

[0m16:56:57.070562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014501A6B590>]}
[0m16:56:57.072044 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model dbo.temporal_data ......................... [[31mERROR[0m in 0.02s]
[0m16:56:57.073110 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m16:56:57.073923 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m16:56:57.074920 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m16:56:57.075423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m16:56:57.076423 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m16:56:57.077444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m16:56:57.078441 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m16:56:57.079466 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m16:56:57.079466 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:56:57.079466 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m16:56:57.085071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:57.086072 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:56:57.086072 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:56:57.088081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:57.089825 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m16:56:57.090815 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m16:56:57.091814 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\Models\trips.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.094418 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 81, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")

[0m16:56:57.094418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e058652-d5a8-46b8-91a2-a0757e0635cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014502287920>]}
[0m16:56:57.095417 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model dbo.trips ................................. [[31mERROR[0m in 0.02s]
[0m16:56:57.096464 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m16:56:57.098103 [debug] [MainThread]: On master: COMMIT
[0m16:56:57.099122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:57.099122 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m16:56:57.100124 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m16:56:57.100124 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m16:56:57.101098 [info ] [MainThread]: 
[0m16:56:57.101098 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:56:57.103771 [debug] [MainThread]: Command end result
[0m16:56:57.125432 [info ] [MainThread]: 
[0m16:56:57.125432 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m16:56:57.134992 [info ] [MainThread]: 
[0m16:56:57.136000 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")
[0m16:56:57.136987 [info ] [MainThread]: 
[0m16:56:57.137978 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.139809 [info ] [MainThread]: 
[0m16:56:57.140210 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.141647 [info ] [MainThread]: 
[0m16:56:57.142623 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'base_trip_data'. (208) (SQLMoreResults)")
[0m16:56:57.143624 [info ] [MainThread]: 
[0m16:56:57.144594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m16:56:57.144594 [debug] [MainThread]: Command `dbt run` failed at 16:56:57.144594 after 3.04 seconds
[0m16:56:57.144594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457F63C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457F63D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001457C1527B0>]}
[0m16:56:57.144594 [debug] [MainThread]: Flushing usage events
[0m16:57:44.542241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AED81F0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDB255CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDB257710>]}


============================== 16:57:44.554571 | 15939b2b-2015-4513-9179-6111bd6346f5 ==============================
[0m16:57:44.554571 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:57:44.555567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:57:45.086024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDBF779B0>]}
[0m16:57:45.140901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDC603B00>]}
[0m16:57:45.140901 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m16:57:45.398169 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:57:45.476844 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:57:45.476844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDBBADEE0>]}
[0m16:57:46.722064 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:57:46.722064 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\Models\schema.yml'
[0m16:57:46.818472 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:57:46.819463 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\Models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m16:57:46.820461 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:57:46.821458 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\Models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m16:57:46.887236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m16:57:46.902668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDDAB3C20>]}
[0m16:57:46.987335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDBB871D0>]}
[0m16:57:46.987335 [info ] [MainThread]: Found 4 models, 502 macros
[0m16:57:46.987335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDDB16AB0>]}
[0m16:57:46.987335 [info ] [MainThread]: 
[0m16:57:46.987335 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:57:47.002992 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m16:57:47.022421 [debug] [ThreadPool]: dbt-sqlserver
[0m16:57:47.023366 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m16:57:47.024365 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:57:47.024365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:47.025380 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.096137 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.107971 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:57:47.108971 [debug] [ThreadPool]: On list_dbt_project: Close
[0m16:57:47.111355 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m16:57:47.117341 [debug] [ThreadPool]: dbt-sqlserver
[0m16:57:47.117341 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m16:57:47.118338 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:57:47.118338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:47.119335 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.120380 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.160654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:57:47.160654 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m16:57:47.160654 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m16:57:47.176280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDDA84AA0>]}
[0m16:57:47.176991 [debug] [MainThread]: On master: COMMIT
[0m16:57:47.176991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:47.176991 [info ] [MainThread]: 
[0m16:57:47.176991 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m16:57:47.176991 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m16:57:47.176991 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m16:57:47.185844 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m16:57:47.193699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m16:57:47.194699 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m16:57:47.236987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m16:57:47.236987 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:57:47.236987 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
SELECT
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')


[0m16:57:47.236987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:57:47.236987 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.236987 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.256924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.263905 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:57:47.264931 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m16:57:47.455039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.461573 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m16:57:47.461573 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m16:57:47.477227 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:57:47.477227 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:57:47.477227 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:57:47.492844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.492844 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m16:57:47.492844 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m16:57:47.492844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.508464 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m16:57:47.508464 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m16:57:47.508464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AED9615280>]}
[0m16:57:47.508464 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.33s]
[0m16:57:47.508464 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m16:57:47.508464 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m16:57:47.508464 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m16:57:47.508464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m16:57:47.508464 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m16:57:47.508464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m16:57:47.508464 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m16:57:47.508464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m16:57:47.508464 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:57:47.508464 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')


[0m16:57:47.524078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:47.525027 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.525027 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.528161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.530218 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:57:47.530218 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m16:57:47.530218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.540400 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:57:47.540400 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m16:57:47.542882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.543993 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m16:57:47.543993 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m16:57:47.543993 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:57:47.543993 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:57:47.543993 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:57:47.561806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.561806 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m16:57:47.561806 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_backup";');

[0m16:57:47.570898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.570898 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m16:57:47.570898 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m16:57:47.570898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDDC5CAA0>]}
[0m16:57:47.570898 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbo.location_details .......................... [[32mOK[0m in 0.06s]
[0m16:57:47.570898 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m16:57:47.570898 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m16:57:47.570898 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m16:57:47.570898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m16:57:47.570898 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m16:57:47.570898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m16:57:47.570898 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m16:57:47.570898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m16:57:47.586101 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:57:47.587102 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m16:57:47.587102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:47.588098 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.589327 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.591439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.592486 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:57:47.592486 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m16:57:47.592486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.604902 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:57:47.605918 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m16:57:47.608012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.610060 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m16:57:47.610060 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m16:57:47.610060 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:57:47.610060 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:57:47.610060 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:57:47.621333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.621333 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m16:57:47.621333 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m16:57:47.621333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.621333 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m16:57:47.621333 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m16:57:47.621333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDE3289E0>]}
[0m16:57:47.621333 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbo.temporal_data ............................. [[32mOK[0m in 0.05s]
[0m16:57:47.621333 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m16:57:47.635848 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m16:57:47.637222 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m16:57:47.637222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m16:57:47.637222 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m16:57:47.637222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m16:57:47.637222 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m16:57:47.637222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m16:57:47.637222 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:57:47.637222 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m16:57:47.637222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:47.637222 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m16:57:47.637222 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m16:57:47.637222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.657112 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:57:47.658109 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m16:57:47.660155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.661662 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:57:47.661662 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m16:57:47.661662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.661662 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m16:57:47.672372 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m16:57:47.673369 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:57:47.674366 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:57:47.674366 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:57:47.677407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.687921 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m16:57:47.687921 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m16:57:47.687921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:47.687921 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m16:57:47.687921 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m16:57:47.687921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15939b2b-2015-4513-9179-6111bd6346f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDE2FE1E0>]}
[0m16:57:47.687921 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.05s]
[0m16:57:47.687921 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m16:57:47.687921 [debug] [MainThread]: On master: COMMIT
[0m16:57:47.687921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:47.687921 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m16:57:47.687921 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m16:57:47.687921 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m16:57:47.687921 [info ] [MainThread]: 
[0m16:57:47.687921 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m16:57:47.701877 [debug] [MainThread]: Command end result
[0m16:57:47.726957 [info ] [MainThread]: 
[0m16:57:47.726957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:47.726957 [info ] [MainThread]: 
[0m16:57:47.726957 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:57:47.736901 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:47.736901 after 3.29 seconds
[0m16:57:47.737896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AED81F0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDB8FF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDB6E3500>]}
[0m16:57:47.738897 [debug] [MainThread]: Flushing usage events
[0m17:04:37.476285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192401A7B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923D085550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923D9DC1A0>]}


============================== 17:04:37.476285 | 1aaa8423-93fc-49a4-b731-2cbf5e617ea6 ==============================
[0m17:04:37.476285 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:04:37.476285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:37.930504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192415F7BF0>]}
[0m17:04:37.977394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923CED6FF0>]}
[0m17:04:37.993016 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:04:38.242144 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:04:38.414782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:38.414782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:38.424970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj.example
[0m17:04:38.453295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192426371D0>]}
[0m17:04:38.545070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192429B8110>]}
[0m17:04:38.545070 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:04:38.545070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019242686C90>]}
[0m17:04:38.545070 [info ] [MainThread]: 
[0m17:04:38.545070 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:04:38.545070 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:04:38.567469 [debug] [ThreadPool]: dbt-sqlserver
[0m17:04:38.567469 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:04:38.567469 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:04:38.576181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:38.577272 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:38.636348 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:38.643630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:38.645661 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:04:38.647102 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:04:38.653088 [debug] [ThreadPool]: dbt-sqlserver
[0m17:04:38.653088 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:04:38.654090 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:04:38.654090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:38.655086 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:38.655086 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:38.706715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:38.706715 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:04:38.706715 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:04:38.706715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924148C860>]}
[0m17:04:38.706715 [debug] [MainThread]: On master: COMMIT
[0m17:04:38.706715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:38.706715 [info ] [MainThread]: 
[0m17:04:38.706715 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:04:38.706715 [info ] [Thread-1 (]: 1 of 4 START sql view model dbo.base_trip_data ................................. [RUN]
[0m17:04:38.722338 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:04:38.722338 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:04:38.722338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:04:38.722338 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:04:38.762435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:04:38.762435 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:04:38.762435 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp" as WITH cleaned_data AS (
SELECT
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')


[0m17:04:38.762435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:04:38.762435 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:38.762435 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:38.776682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:38.776682 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:04:38.776682 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:04:38.977758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:38.977758 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:04:38.977758 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:04:38.977758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.008999 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:04:39.008999 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:04:39.024620 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:04:39.024620 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:04:39.024620 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:04:39.046750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.046750 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:04:39.046750 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:04:39.046750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.046750 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: ROLLBACK
[0m17:04:39.046750 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:04:39.046750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192401A61B0>]}
[0m17:04:39.046750 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbo.base_trip_data ............................ [[32mOK[0m in 0.32s]
[0m17:04:39.046750 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:04:39.062375 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:04:39.062375 [info ] [Thread-1 (]: 2 of 4 START sql view model dbo.location_details ............................... [RUN]
[0m17:04:39.062375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:04:39.062375 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:04:39.062375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:04:39.062375 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:04:39.062375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:04:39.062375 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:04:39.062375 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')


[0m17:04:39.062375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:39.062375 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:39.062375 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:39.077998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.082810 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:04:39.083809 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:04:39.127005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.127005 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:04:39.142428 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:04:39.144949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.146946 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:04:39.148941 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:04:39.149938 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:04:39.150935 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:04:39.151932 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:04:39.162159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.164155 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:04:39.164155 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:04:39.166473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.167472 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m17:04:39.168470 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:04:39.169467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019242ABE0F0>]}
[0m17:04:39.169467 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbo.location_details .......................... [[32mOK[0m in 0.11s]
[0m17:04:39.170422 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:04:39.171453 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:04:39.172419 [info ] [Thread-1 (]: 3 of 4 START sql view model dbo.temporal_data .................................. [RUN]
[0m17:04:39.172419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:04:39.173445 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:04:39.175431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:04:39.176462 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:04:39.176462 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:04:39.176462 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:04:39.176462 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')


[0m17:04:39.176462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:39.176462 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:39.176462 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:39.176462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.176462 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:04:39.176462 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:04:39.192085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.196921 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:04:39.197264 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:04:39.198323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.198323 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:04:39.198323 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:04:39.198323 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:04:39.198323 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:04:39.198323 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:04:39.216357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.216357 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:04:39.216357 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:04:39.216357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.216357 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m17:04:39.225568 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:04:39.226568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192430FDD60>]}
[0m17:04:39.227574 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbo.temporal_data ............................. [[32mOK[0m in 0.05s]
[0m17:04:39.228564 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:04:39.229559 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:04:39.229833 [info ] [Thread-1 (]: 4 of 4 START sql view model dbo.trips .......................................... [RUN]
[0m17:04:39.229833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:04:39.229833 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:04:39.229833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:04:39.229833 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:04:39.229833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:04:39.229833 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:04:39.229833 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')


[0m17:04:39.229833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:39.229833 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:04:39.229833 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:04:39.244316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.247340 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:04:39.248337 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:04:39.249367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.249367 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:04:39.249367 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:04:39.249367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.249367 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:04:39.260870 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:04:39.261866 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:04:39.263454 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:04:39.264453 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:04:39.269417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.276617 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:04:39.277611 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:04:39.279884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:39.279884 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m17:04:39.279884 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:04:39.279884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa8423-93fc-49a4-b731-2cbf5e617ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192430FC9E0>]}
[0m17:04:39.279884 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbo.trips ..................................... [[32mOK[0m in 0.05s]
[0m17:04:39.279884 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:04:39.279884 [debug] [MainThread]: On master: COMMIT
[0m17:04:39.279884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:39.279884 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:04:39.279884 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:04:39.279884 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:04:39.279884 [info ] [MainThread]: 
[0m17:04:39.279884 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m17:04:39.279884 [debug] [MainThread]: Command end result
[0m17:04:39.318193 [info ] [MainThread]: 
[0m17:04:39.318193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:39.318193 [info ] [MainThread]: 
[0m17:04:39.318193 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:04:39.325540 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:39.318193 after 1.95 seconds
[0m17:04:39.325540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923D085550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019240921C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192406705C0>]}
[0m17:04:39.326539 [debug] [MainThread]: Flushing usage events
[0m17:05:58.243783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730216FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273013C28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273013C2A20>]}


============================== 17:05:58.243783 | c3f2c35f-c98c-406b-948f-31c8e50764ea ==============================
[0m17:05:58.243783 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:05:58.243783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:58.680572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273026D9A60>]}
[0m17:05:58.736126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273027D4D70>]}
[0m17:05:58.736126 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:05:58.977775 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:05:59.050488 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:05:59.050488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273041F51F0>]}
[0m17:06:00.273981 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:06:00.273981 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:06:00.393752 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:06:00.402258 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:06:00.402258 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:06:00.402258 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:06:00.498675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027302E245C0>]}
[0m17:06:00.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273042EE3F0>]}
[0m17:06:00.602840 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:06:00.602840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273041F5A60>]}
[0m17:06:00.602840 [info ] [MainThread]: 
[0m17:06:00.602840 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:06:00.602840 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:06:00.632743 [debug] [ThreadPool]: dbt-sqlserver
[0m17:06:00.633740 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:06:00.634764 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:06:00.634764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:00.634764 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:05.006053 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:05.021777 [debug] [ThreadPool]: SQL status: OK in 4.000 seconds
[0m17:06:05.036300 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:06:05.036300 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:06:05.036300 [debug] [ThreadPool]: dbt-sqlserver
[0m17:06:05.036300 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:06:05.036300 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:06:05.036300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:05.036300 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:05.036300 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:05.098819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:05.098819 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:06:05.098819 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:06:05.098819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730428CAD0>]}
[0m17:06:05.098819 [debug] [MainThread]: On master: COMMIT
[0m17:06:05.098819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:05.098819 [info ] [MainThread]: 
[0m17:06:05.114413 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:06:05.114413 [info ] [Thread-1 (]: 1 of 4 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:06:05.114413 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:06:05.114413 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:06:05.114413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:06:05.114413 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:06:05.161865 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:05.161865 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:06:05.181924 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:05.181924 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:05.182920 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:05.182920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:05.183918 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:05.184885 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:05.208694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.210718 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:05.211794 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:06:05.211794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.227439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:06:05.227439 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:05.227439 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:06:05.552877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.568499 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:05.568499 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:06:05.831466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.850059 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:06:05.850059 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:06:05.858082 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:06:05.858082 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:06:05.860110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.860110 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:06:05.860110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737FDA1310>]}
[0m17:06:05.860110 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.75s]
[0m17:06:05.860110 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:06:05.860110 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:06:05.860110 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.location_details .............................. [RUN]
[0m17:06:05.860110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:06:05.868159 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:06:05.870201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:06:05.870201 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:06:05.870201 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:05.870201 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:06:05.878306 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:05.878306 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:05.878306 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:05.878306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:05.880318 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:05.880318 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:05.890570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.893794 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:05.894500 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:06:05.894500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.898561 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:06:05.898561 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:05.898561 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    -- Combine Pickup and Dropoff locations
    SELECT 
        PULocationID AS location_id,
        ''Pickup'' AS location_type
    FROM base_trip_data  -- Replace ''raw_data'' with your table name

    UNION

    SELECT 
        DOLocationID AS location_id,
        ''Dropoff'' AS location_type
    FROM base_trip_data
)
-- Select distinct location details
SELECT DISTINCT 
    location_id, 
    location_type
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:06:05.977342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.977342 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:05.977342 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:06:05.977342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.977342 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:05.977342 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:06:05.977342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:05.993911 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:06:05.997900 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:06:05.998909 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:05.999896 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:06.000893 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:06.010266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.010266 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:06:06.010266 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:06:06.010266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.010266 [debug] [Thread-1 (]: On model.dbt_proj.location_details: ROLLBACK
[0m17:06:06.010266 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:06:06.010266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027304B34800>]}
[0m17:06:06.010266 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.15s]
[0m17:06:06.010266 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:06:06.010266 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:06:06.010266 [info ] [Thread-1 (]: 3 of 4 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:06:06.010266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:06:06.010266 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:06:06.010266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:06:06.010266 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:06:06.029146 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.032088 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:06:06.032088 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.032088 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.032088 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:06.032088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.032088 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:06.032088 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:06.047288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.049283 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.050280 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:06:06.051278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.052320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:06:06.062292 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.064288 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
	CAST(request_datetime AS DATE) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CAST(pickup_datetime AS DATE) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CAST(dropoff_datetime AS DATE) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:06:06.209358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.224985 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.224985 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:06:06.224985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.224985 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.224985 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:06:06.224985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.224985 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:06:06.240606 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:06:06.240606 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.240606 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.240606 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:06.240606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.240606 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:06:06.240606 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:06:06.256226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.256226 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: ROLLBACK
[0m17:06:06.256226 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:06:06.256226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027304B31700>]}
[0m17:06:06.256226 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.25s]
[0m17:06:06.256226 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:06:06.256226 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:06:06.256226 [info ] [Thread-1 (]: 4 of 4 START sql table model dbo.trips ......................................... [RUN]
[0m17:06:06.256226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:06:06.256226 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:06:06.256226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:06:06.256226 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:06:06.256226 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.273816 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:06:06.276412 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.278004 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.279104 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:06.280110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.280110 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:06:06.281117 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:06:06.285135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.285135 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.293511 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:06:06.295507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.295919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:06:06.295919 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.295919 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT
    ROW_NUMBER() OVER (ORDER BY pickup_datetime) AS trip_id, 
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    pickup_datetime,
    dropoff_datetime,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    congestion_surcharge,
    tips
FROM base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:06:06.472247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.472247 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.472247 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:06:06.472247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.487855 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.487855 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:06:06.487855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.487855 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:06:06.487855 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:06:06.487855 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:06:06.487855 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.487855 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:06:06.511096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.513093 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:06:06.513093 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:06:06.515473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:06:06.516473 [debug] [Thread-1 (]: On model.dbt_proj.trips: ROLLBACK
[0m17:06:06.517469 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:06:06.518466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f2c35f-c98c-406b-948f-31c8e50764ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027304B5B9B0>]}
[0m17:06:06.518466 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.26s]
[0m17:06:06.520461 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:06:06.521460 [debug] [MainThread]: On master: COMMIT
[0m17:06:06.522456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:06.522456 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:06:06.522456 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:06:06.523453 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:06:06.523453 [info ] [MainThread]: 
[0m17:06:06.524617 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m17:06:06.527369 [debug] [MainThread]: Command end result
[0m17:06:06.549579 [info ] [MainThread]: 
[0m17:06:06.549579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:06.558464 [info ] [MainThread]: 
[0m17:06:06.559461 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:06:06.562833 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:06.562475 after 8.42 seconds
[0m17:06:06.563275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273020F8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027302081640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273020817C0>]}
[0m17:06:06.564307 [debug] [MainThread]: Flushing usage events
[0m17:10:57.481303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205983A80B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059AD69310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059AA2FEC0>]}


============================== 17:10:57.497779 | 8c6dec53-5483-46d4-beef-abfe5f325bae ==============================
[0m17:10:57.497779 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:10:57.497779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:58.031198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059AE9E720>]}
[0m17:10:58.097789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059B8E6F30>]}
[0m17:10:58.097789 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:10:58.361903 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:10:58.430940 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:10:58.430940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059BA06930>]}
[0m17:10:59.629512 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:10:59.629512 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:10:59.730070 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:10:59.731036 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:10:59.732034 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:10:59.732034 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:10:59.812467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059CEA1FA0>]}
[0m17:10:59.899451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059CE60C20>]}
[0m17:10:59.899451 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:10:59.899451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059CD020C0>]}
[0m17:10:59.899451 [info ] [MainThread]: 
[0m17:10:59.899451 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:10:59.899451 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:10:59.922731 [debug] [ThreadPool]: dbt-sqlserver
[0m17:10:59.922731 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:10:59.922731 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:10:59.922731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:59.922731 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:00.001375 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:00.012223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:00.013983 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:11:00.015008 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:11:00.015008 [debug] [ThreadPool]: dbt-sqlserver
[0m17:11:00.015008 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:11:00.015008 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:11:00.015008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:00.015008 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:00.015008 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:00.077494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:00.077494 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:11:00.077494 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:11:00.077494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059B1AB3B0>]}
[0m17:11:00.077494 [debug] [MainThread]: On master: COMMIT
[0m17:11:00.077494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:00.077494 [info ] [MainThread]: 
[0m17:11:00.077494 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:11:00.077494 [info ] [Thread-1 (]: 1 of 4 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:11:00.093884 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:11:00.094998 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:11:00.099597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:11:00.099597 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:11:00.134298 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.154303 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:11:00.164132 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.165131 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.165131 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:11:00.166133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:00.167125 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:00.167125 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:00.228216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.230729 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.230729 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:11:00.230729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.246383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:11:00.246383 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.246383 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:11:00.515866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.515866 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.515866 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:11:00.763155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.763155 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.763155 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:11:00.763155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.794398 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:11:00.800934 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:11:00.800934 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:11:00.800934 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:11:00.800934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.800934 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:11:00.800934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205988E1580>]}
[0m17:11:00.800934 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.71s]
[0m17:11:00.800934 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:11:00.800934 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:11:00.816587 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.location_details .............................. [RUN]
[0m17:11:00.816587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:11:00.816587 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:11:00.816587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:11:00.816587 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:11:00.816587 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.816587 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:11:00.816587 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.816587 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.816587 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:11:00.816587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:00.816587 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:00.816587 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:00.838727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.838727 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.838727 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:11:00.838727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.850557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:11:00.851525 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.852523 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:11:00.911494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.915427 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.916425 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:11:00.919030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.923021 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.924018 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:11:00.926632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.928629 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:11:00.931689 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:11:00.931689 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:11:00.931689 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:11:00.931689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.931689 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:11:00.931689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D5E4200>]}
[0m17:11:00.931689 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.12s]
[0m17:11:00.931689 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:11:00.931689 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:11:00.931689 [info ] [Thread-1 (]: 3 of 4 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:11:00.931689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:11:00.931689 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:11:00.931689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:11:00.931689 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:11:00.950174 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.953395 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:11:00.953395 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:00.953395 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:00.953395 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:11:00.953395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:00.953395 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:00.953395 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:00.969446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.971547 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:00.971547 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:11:00.971547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:00.971547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:11:00.971547 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:00.971547 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:11:01.095130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.101142 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:01.101142 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:11:01.101142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.101142 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:01.101142 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:11:01.101142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.116767 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:11:01.116767 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:11:01.116767 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:11:01.116767 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:11:01.116767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.116767 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:11:01.116767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059CF5B410>]}
[0m17:11:01.116767 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.19s]
[0m17:11:01.116767 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:11:01.116767 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:11:01.116767 [info ] [Thread-1 (]: 4 of 4 START sql table model dbo.trips ......................................... [RUN]
[0m17:11:01.132389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:11:01.132389 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:11:01.132389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:11:01.132389 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:11:01.132389 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:01.132389 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:11:01.132389 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:11:01.132389 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.132389 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:11:01.132389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:01.132389 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:11:01.148010 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:11:01.169878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.171900 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.171900 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:11:01.171900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.171900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:11:01.171900 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.171900 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:11:01.283586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.283586 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.283586 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:11:01.299989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.303014 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.304012 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:11:01.306102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.308130 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:11:01.310122 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:11:01.311118 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:11:01.312089 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:11:01.314363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:01.316388 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:11:01.316388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c6dec53-5483-46d4-beef-abfe5f325bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059D61DD30>]}
[0m17:11:01.317384 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.20s]
[0m17:11:01.318223 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:11:01.319740 [debug] [MainThread]: On master: COMMIT
[0m17:11:01.320757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:01.320757 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:11:01.321755 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:11:01.321755 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:11:01.321755 [info ] [MainThread]: 
[0m17:11:01.322734 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m17:11:01.324753 [debug] [MainThread]: Command end result
[0m17:11:01.404544 [info ] [MainThread]: 
[0m17:11:01.406539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:01.407537 [info ] [MainThread]: 
[0m17:11:01.409531 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:11:01.424491 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:01.416512 after 4.04 seconds
[0m17:11:01.426342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059AADBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A4D63F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A485A00>]}
[0m17:11:01.426342 [debug] [MainThread]: Flushing usage events
[0m17:16:48.836725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428DB8AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017424C4E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017427EFE840>]}


============================== 17:16:48.836725 | e85916d4-7b60-4725-8764-d6cd36168dcd ==============================
[0m17:16:48.836725 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:16:48.836725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:16:49.293153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017429273A40>]}
[0m17:16:49.343640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428F49670>]}
[0m17:16:49.343640 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:16:49.587386 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:16:49.749440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:49.749440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:49.779879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742AAB2AE0>]}
[0m17:16:49.869097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742AAF6540>]}
[0m17:16:49.869097 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:16:49.869097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428F48980>]}
[0m17:16:49.869097 [info ] [MainThread]: 
[0m17:16:49.869097 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:16:49.884722 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:16:49.906101 [debug] [ThreadPool]: dbt-sqlserver
[0m17:16:49.907101 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:16:49.907101 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:16:49.908101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:49.908101 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:49.981679 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:49.989377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:16:49.990377 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:16:49.992758 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:16:49.998744 [debug] [ThreadPool]: dbt-sqlserver
[0m17:16:49.998744 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:16:49.999742 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:16:49.999742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:50.000739 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:50.000739 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:50.049816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:16:50.049816 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:16:50.049816 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:16:50.049816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017429900800>]}
[0m17:16:50.049816 [debug] [MainThread]: On master: COMMIT
[0m17:16:50.049816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:50.049816 [info ] [MainThread]: 
[0m17:16:50.065423 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:16:50.068931 [info ] [Thread-1 (]: 1 of 4 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:16:50.068931 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:16:50.068931 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:16:50.068931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:16:50.068931 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:16:50.119616 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.119616 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:16:50.119616 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.119616 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.119616 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:16:50.135093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:50.135269 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:50.138495 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:50.162174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.164171 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.164171 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:16:50.166269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.169329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:16:50.169329 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.169329 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:16:50.416767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.416767 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.416767 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:16:50.648565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.664222 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.664222 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:16:50.664222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.686400 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:16:50.686400 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:16:50.686400 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:16:50.686400 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:16:50.686400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.686400 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:16:50.702006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017426965190>]}
[0m17:16:50.702006 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.63s]
[0m17:16:50.702006 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:16:50.702006 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:16:50.702006 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.location_details .............................. [RUN]
[0m17:16:50.702006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:16:50.702006 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:16:50.702006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:16:50.702006 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:16:50.702006 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.702006 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:16:50.702006 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.702006 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.717650 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:16:50.718452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:50.719862 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:50.720867 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:50.729664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.729664 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.729664 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:16:50.735569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.738760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:16:50.738760 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.738760 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:16:50.801022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.803064 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.803064 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:16:50.803064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.803064 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.803064 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:16:50.803064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.803064 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:16:50.818685 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:16:50.818685 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:16:50.818685 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:16:50.818685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.818685 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:16:50.818685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742AE98FE0>]}
[0m17:16:50.818685 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.12s]
[0m17:16:50.818685 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:16:50.818685 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:16:50.818685 [info ] [Thread-1 (]: 3 of 4 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:16:50.818685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:16:50.818685 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:16:50.818685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:16:50.818685 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:16:50.837112 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.840318 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:16:50.840318 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:50.840318 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:50.840318 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:16:50.840318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:50.840318 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:50.840318 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:50.857113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.859232 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:50.859232 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:16:50.859232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:50.859232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:16:50.859232 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:50.859232 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:16:50.986482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.002103 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:51.002103 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:16:51.002103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.002103 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:51.002103 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:16:51.017726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.017726 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:16:51.017726 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:16:51.017726 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:16:51.017726 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:16:51.017726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.033347 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:16:51.033347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742B563AD0>]}
[0m17:16:51.033347 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.21s]
[0m17:16:51.033347 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:16:51.033347 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:16:51.033347 [info ] [Thread-1 (]: 4 of 4 START sql table model dbo.trips ......................................... [RUN]
[0m17:16:51.033347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:16:51.033347 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:16:51.033347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:16:51.033347 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:16:51.048968 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:51.054690 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:16:51.056783 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:16:51.057779 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.058776 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:16:51.058776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:51.059775 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:16:51.060771 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:16:51.070825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.070825 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.070825 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:16:51.070825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.070825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:16:51.070825 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.070825 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:16:51.202340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.202340 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.202340 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:16:51.217936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.217936 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.217936 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:16:51.217936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.217936 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:16:51.217936 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:16:51.217936 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:16:51.217936 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:16:51.217936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:51.233586 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:16:51.233586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e85916d4-7b60-4725-8764-d6cd36168dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742AEAB8C0>]}
[0m17:16:51.233586 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.20s]
[0m17:16:51.233586 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:16:51.233586 [debug] [MainThread]: On master: COMMIT
[0m17:16:51.233586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:51.233586 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:16:51.233586 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:16:51.233586 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:16:51.233586 [info ] [MainThread]: 
[0m17:16:51.233586 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m17:16:51.233586 [debug] [MainThread]: Command end result
[0m17:16:51.272649 [info ] [MainThread]: 
[0m17:16:51.273618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:51.274687 [info ] [MainThread]: 
[0m17:16:51.274687 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:16:51.274687 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:51.274687 after 2.55 seconds
[0m17:16:51.274687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428D81D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428D81F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017428AD08C0>]}
[0m17:16:51.274687 [debug] [MainThread]: Flushing usage events
[0m17:17:21.110269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FF1A9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FF231D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FF232870>]}


============================== 17:17:21.114205 | 7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5 ==============================
[0m17:17:21.114205 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:17:21.115000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:21.581565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FFDD1520>]}
[0m17:17:21.634936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FFDB3920>]}
[0m17:17:21.634936 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:17:21.882144 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:17:22.035766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:22.035766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:22.067035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FEAF4FE0>]}
[0m17:17:22.185850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B18137FE30>]}
[0m17:17:22.185850 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:17:22.185850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FFF219D0>]}
[0m17:17:22.185850 [info ] [MainThread]: 
[0m17:17:22.185850 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:17:22.185850 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:17:22.219703 [debug] [ThreadPool]: dbt-sqlserver
[0m17:17:22.220697 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:17:22.220697 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:17:22.221671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:22.221671 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:22.272098 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:22.277843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:22.278843 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:17:22.281036 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:17:22.285475 [debug] [ThreadPool]: dbt-sqlserver
[0m17:17:22.285475 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:17:22.285475 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:17:22.285475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:22.285475 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:22.285475 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:22.316742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:22.316742 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:17:22.316742 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:17:22.316742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FFEEEED0>]}
[0m17:17:22.316742 [debug] [MainThread]: On master: COMMIT
[0m17:17:22.316742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:22.316742 [info ] [MainThread]: 
[0m17:17:22.316742 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:17:22.316742 [info ] [Thread-1 (]: 1 of 4 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:17:22.316742 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:17:22.330141 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:17:22.336425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:17:22.336425 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:17:22.369994 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:22.369994 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:17:22.391351 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:22.392349 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:22.393346 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:22.393346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:22.394358 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:22.397111 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:22.412165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.414161 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:22.415158 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:17:22.416154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.420206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:17:22.420206 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:22.420206 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(VARCHAR(19), request_datetime, 120) AS request_datetime,
    CONVERT(VARCHAR(19), on_scene_datetime, 120) AS on_scene_datetime,
    CONVERT(VARCHAR(19), pickup_datetime, 120) AS pickup_datetime,
    CONVERT(VARCHAR(19), dropoff_datetime, 120) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:17:22.652456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.652456 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:22.652456 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:17:22.857672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.869523 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:17:22.885145 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:17:22.885145 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:22.889583 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:17:22.889606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.889606 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:17:22.889606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FEAB64B0>]}
[0m17:17:22.889606 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.57s]
[0m17:17:22.889606 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:17:22.889606 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:17:22.889606 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.location_details .............................. [RUN]
[0m17:17:22.889606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:17:22.889606 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:17:22.889606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:17:22.889606 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:17:22.905654 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:22.908646 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:17:22.909644 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:22.909691 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:22.909691 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:22.909691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:22.909691 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:22.909691 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:22.922703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.923231 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:22.923231 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:17:22.923231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.923231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:17:22.923231 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:22.923231 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:17:22.992261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:22.996271 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:22.996271 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:17:22.999138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.002355 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:23.003355 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:17:23.005542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.009533 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:17:23.011528 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:17:23.012525 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:23.013523 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:17:23.016763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.018785 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:17:23.019841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1813F4380>]}
[0m17:17:23.019841 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.13s]
[0m17:17:23.019841 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:17:23.019841 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:17:23.019841 [info ] [Thread-1 (]: 3 of 4 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:17:23.019841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:17:23.019841 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:17:23.019841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:17:23.019841 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:17:23.019841 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:23.019841 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:17:23.019841 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:23.019841 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.035493 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:23.036455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:23.038067 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:23.038714 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:23.042288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.042288 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.042288 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:17:23.053723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.056993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:17:23.057987 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.058983 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:17:23.168830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.168830 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.168830 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:17:23.168830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.168830 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.168830 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:17:23.184452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.184452 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:17:23.184452 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:17:23.184452 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:23.184452 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:17:23.184452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.184452 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:17:23.184452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B181A6BB30>]}
[0m17:17:23.200073 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.16s]
[0m17:17:23.200073 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:17:23.200073 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:17:23.200073 [info ] [Thread-1 (]: 4 of 4 START sql table model dbo.trips ......................................... [RUN]
[0m17:17:23.200073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:17:23.200073 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:17:23.200073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:17:23.200073 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:17:23.200073 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:23.215694 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:17:23.217987 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:23.218421 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.220020 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:23.221175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:23.221175 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:23.222219 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:23.222219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.236370 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.238447 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:17:23.238447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.238447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:17:23.238447 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.238447 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:17:23.369601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.369601 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.369601 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:17:23.369601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.369601 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.369601 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:17:23.385232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.385232 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:17:23.385232 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:17:23.385232 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:23.385232 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:17:23.385232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:23.385232 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:17:23.385232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b39ae6c-31c8-4d12-a198-3c32f1f2ebd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1813FA630>]}
[0m17:17:23.385232 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.19s]
[0m17:17:23.385232 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:17:23.400849 [debug] [MainThread]: On master: COMMIT
[0m17:17:23.400849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:23.400849 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:17:23.400849 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:17:23.400849 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:17:23.400849 [info ] [MainThread]: 
[0m17:17:23.400849 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m17:17:23.407178 [debug] [MainThread]: Command end result
[0m17:17:23.471634 [info ] [MainThread]: 
[0m17:17:23.472631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:23.473629 [info ] [MainThread]: 
[0m17:17:23.474638 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:17:23.475623 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:23.475623 after 2.47 seconds
[0m17:17:23.476622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FF081460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FE65C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1FF232870>]}
[0m17:17:23.476622 [debug] [MainThread]: Flushing usage events
[0m17:17:48.552961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179E49670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179E4BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179E4BE00>]}


============================== 17:17:48.552961 | 5313cedb-3c3b-414c-8f5a-0e1ac91884b0 ==============================
[0m17:17:48.552961 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:17:48.552961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:49.065532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17AEA3830>]}
[0m17:17:49.119102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17A531670>]}
[0m17:17:49.119102 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:17:49.383680 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:17:49.506028 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:17:49.506028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179A39250>]}
[0m17:17:50.686043 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:17:50.702639 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:17:50.803038 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:17:50.803038 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:17:50.803038 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:17:50.803038 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:17:50.913389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179F110D0>]}
[0m17:17:51.034454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17AEB3080>]}
[0m17:17:51.034454 [info ] [MainThread]: Found 4 models, 502 macros
[0m17:17:51.034454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17A3409B0>]}
[0m17:17:51.050080 [info ] [MainThread]: 
[0m17:17:51.050080 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:17:51.050080 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:17:51.089991 [debug] [ThreadPool]: dbt-sqlserver
[0m17:17:51.090979 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:17:51.091977 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:17:51.091977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:51.093005 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.120095 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.120095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:51.122090 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:17:51.123087 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:17:51.129071 [debug] [ThreadPool]: dbt-sqlserver
[0m17:17:51.130069 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:17:51.130069 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:17:51.131071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:51.131071 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.132064 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.135764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:51.137759 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:17:51.137759 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:17:51.139753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17C248110>]}
[0m17:17:51.140759 [debug] [MainThread]: On master: COMMIT
[0m17:17:51.140759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:51.141748 [info ] [MainThread]: 
[0m17:17:51.145739 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:17:51.146736 [info ] [Thread-1 (]: 1 of 4 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:17:51.147734 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:17:51.148137 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:17:51.154300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:17:51.154300 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:17:51.187762 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.203996 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:17:51.203996 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.203996 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.203996 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:51.203996 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:51.203996 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.203996 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.203996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.203996 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.203996 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:17:51.203996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.233024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:17:51.234029 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.234029 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:17:51.372431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.388057 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.388057 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:17:51.388057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.388057 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.388057 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:17:51.403679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.419300 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:17:51.419300 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:17:51.419300 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:17:51.419300 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:17:51.419300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.434922 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:17:51.434922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D177DA1520>]}
[0m17:17:51.434922 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.29s]
[0m17:17:51.434922 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:17:51.434922 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:17:51.434922 [info ] [Thread-1 (]: 2 of 4 START sql table model dbo.location_details .............................. [RUN]
[0m17:17:51.434922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.location_details)
[0m17:17:51.434922 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:17:51.434922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:17:51.434922 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:17:51.434922 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.452345 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:17:51.454344 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.455337 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.455337 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:51.456334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:51.457331 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.457331 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.458329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.461320 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.461320 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:17:51.462318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.465311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:17:51.467305 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.468303 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:17:51.529062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.533042 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.534040 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:17:51.535826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.540813 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.541810 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:17:51.543805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.546797 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:17:51.548791 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:17:51.549789 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:17:51.550786 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:17:51.552781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.553804 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:17:51.553804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17CAD44A0>]}
[0m17:17:51.553804 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.12s]
[0m17:17:51.553804 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:17:51.553804 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:17:51.553804 [info ] [Thread-1 (]: 3 of 4 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:17:51.553804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:17:51.553804 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:17:51.553804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:17:51.553804 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:17:51.553804 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.553804 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:17:51.570175 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.571263 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.572324 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:51.572841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:51.573841 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.574838 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.575853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.575853 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.575853 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:17:51.575853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.575853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:17:51.575853 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.575853 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:17:51.669568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.673074 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.673074 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:17:51.673074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.673074 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.673074 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:17:51.673074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.673074 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:17:51.673074 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:17:51.673074 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:17:51.673074 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:17:51.688734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.688734 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:17:51.688734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17C310AA0>]}
[0m17:17:51.688734 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.13s]
[0m17:17:51.688734 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:17:51.688734 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:17:51.688734 [info ] [Thread-1 (]: 4 of 4 START sql table model dbo.trips ......................................... [RUN]
[0m17:17:51.688734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:17:51.688734 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:17:51.688734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:17:51.688734 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:17:51.688734 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.706942 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:17:51.707941 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:17:51.708952 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.708952 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:17:51.709959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:51.709959 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:17:51.711036 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:17:51.711036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.711036 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.711036 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:17:51.711036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.711036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:17:51.711036 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.719008 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:17:51.835084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.835084 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.835084 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:17:51.835084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.850706 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.850706 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:17:51.850706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.850706 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:17:51.850706 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:17:51.850706 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:17:51.850706 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:17:51.850706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:17:51.866327 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:17:51.866327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5313cedb-3c3b-414c-8f5a-0e1ac91884b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17C453530>]}
[0m17:17:51.866327 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.18s]
[0m17:17:51.866327 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:17:51.866327 [debug] [MainThread]: On master: COMMIT
[0m17:17:51.866327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:51.866327 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:17:51.873336 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:17:51.873336 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:17:51.873336 [info ] [MainThread]: 
[0m17:17:51.873336 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m17:17:51.878077 [debug] [MainThread]: Command end result
[0m17:17:51.920306 [info ] [MainThread]: 
[0m17:17:51.920306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:51.920306 [info ] [MainThread]: 
[0m17:17:51.920306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:17:51.920306 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:51.920306 after 3.51 seconds
[0m17:17:51.920306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17C3937A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17959FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17A1977A0>]}
[0m17:17:51.920306 [debug] [MainThread]: Flushing usage events
[0m17:20:43.837872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B229520DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22CDF1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22CDF1C70>]}


============================== 17:20:43.854638 | 5f9bcdda-48aa-433e-9f5a-f0c201fe70d9 ==============================
[0m17:20:43.854638 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:20:43.854638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:44.321769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DA23F50>]}
[0m17:20:44.377899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22D3A7950>]}
[0m17:20:44.378898 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:20:44.616966 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:20:44.764051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:20:44.764051 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\example\daily_trip_trend.sql
[0m17:20:44.987986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22EFAD9A0>]}
[0m17:20:45.087883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22EDB16D0>]}
[0m17:20:45.087883 [info ] [MainThread]: Found 5 models, 502 macros
[0m17:20:45.087883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22EFFAA20>]}
[0m17:20:45.104651 [info ] [MainThread]: 
[0m17:20:45.104651 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:20:45.104651 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:20:45.127976 [debug] [ThreadPool]: dbt-sqlserver
[0m17:20:45.127976 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:20:45.127976 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:20:45.127976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:45.127976 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:45.202310 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:45.214326 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:20:45.215326 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:20:45.217741 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:20:45.220986 [debug] [ThreadPool]: dbt-sqlserver
[0m17:20:45.220986 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:20:45.220986 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:20:45.220986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:45.220986 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:45.220986 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:45.267873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:20:45.267873 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:20:45.267873 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:20:45.267873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22DB02ED0>]}
[0m17:20:45.267873 [debug] [MainThread]: On master: COMMIT
[0m17:20:45.267873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:45.283472 [info ] [MainThread]: 
[0m17:20:45.286492 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:20:45.286492 [info ] [Thread-1 (]: 1 of 5 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:20:45.286492 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:20:45.286492 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:20:45.297637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:20:45.297637 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:20:45.338608 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.338608 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:20:45.358428 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.359445 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.360449 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:20:45.360449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:45.361440 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:45.361440 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:45.383557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.385582 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.386552 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:20:45.387549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.388653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:20:45.388653 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.404276 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:20:45.586904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.602530 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.602530 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:20:45.822340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.822340 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.822340 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:20:45.822340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.854681 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:20:45.854681 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:20:45.854681 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:20:45.854681 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:20:45.854681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.854681 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:20:45.870912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22C6765D0>]}
[0m17:20:45.871463 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.57s]
[0m17:20:45.871463 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:20:45.871463 [debug] [Thread-1 (]: Began running node model.dbt_proj.daily_trip_trend
[0m17:20:45.871463 [info ] [Thread-1 (]: 2 of 5 START sql table model dbo.daily_trip_trend .............................. [RUN]
[0m17:20:45.871463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.daily_trip_trend)
[0m17:20:45.871463 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.daily_trip_trend
[0m17:20:45.871463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.daily_trip_trend"
[0m17:20:45.871463 [debug] [Thread-1 (]: Began executing node model.dbt_proj.daily_trip_trend
[0m17:20:45.871463 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.871463 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw"
[0m17:20:45.888977 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.889988 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:20:45.890975 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'daily_trip_trend__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:20:45.891943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:45.891943 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:45.892941 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:45.894040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.904275 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:20:45.905274 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw";');

[0m17:20:45.907268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.910550 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.daily_trip_trend"
[0m17:20:45.912515 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:20:45.912515 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT
    FORMAT(pickup_datetime, ''yyyy-MM-dd'') AS trip_month,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY  FORMAT(pickup_datetime, ''yyyy-MM-dd'')
ORDER BY trip_month)

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."daily_trip_trend__dbt_tmp" FROM "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.daily_trip_trend__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_daily_trip_trend__dbt_tmp_cci'
        AND object_id=object_id('dbo_daily_trip_trend__dbt_tmp')
    )
    DROP index "dbo"."daily_trip_trend__dbt_tmp".dbo_daily_trip_trend__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_daily_trip_trend__dbt_tmp_cci
    ON "dbo"."daily_trip_trend__dbt_tmp"

   


  
[0m17:20:45.915555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.920951 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: ROLLBACK
[0m17:20:45.921951 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: Close
[0m17:20:45.923946 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\example\daily_trip_trend.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:20:45.925803 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')

[0m17:20:45.925803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22F6BFE60>]}
[0m17:20:45.925803 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dbo.daily_trip_trend ..................... [[31mERROR[0m in 0.05s]
[0m17:20:45.925803 [debug] [Thread-1 (]: Finished running node model.dbt_proj.daily_trip_trend
[0m17:20:45.932031 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:20:45.933028 [info ] [Thread-1 (]: 3 of 5 START sql table model dbo.location_details .............................. [RUN]
[0m17:20:45.934054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.daily_trip_trend, now model.dbt_proj.location_details)
[0m17:20:45.935054 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:20:45.938555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:20:45.940549 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:20:45.944747 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.948295 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:20:45.949321 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:45.950313 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:45.950313 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:20:45.951341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:45.951341 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:45.951341 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:45.958999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.958999 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:45.958999 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:20:45.958999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:45.972952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:20:45.974974 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:45.975943 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:20:46.044591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.051570 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:46.052570 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:20:46.057748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.065713 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:46.066710 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:20:46.068708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.073077 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:20:46.077090 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:20:46.078061 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:20:46.078061 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:20:46.082077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.083069 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:20:46.084066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22F0A5D30>]}
[0m17:20:46.085041 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.15s]
[0m17:20:46.086037 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:20:46.088033 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:20:46.089061 [info ] [Thread-1 (]: 4 of 5 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:20:46.089061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:20:46.089061 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:20:46.089061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:20:46.089061 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:20:46.089061 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:46.089061 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:20:46.089061 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:46.089061 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.089061 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:20:46.104683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:46.104683 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:46.104683 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:46.104683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.120306 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.120306 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:20:46.120306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.120306 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:20:46.120306 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.120306 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:20:46.203923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.203923 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.203923 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:20:46.203923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.203923 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.203923 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:20:46.219559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.219559 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:20:46.219559 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:20:46.219559 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:20:46.219559 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:20:46.219559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.219559 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:20:46.219559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22F72FFB0>]}
[0m17:20:46.235168 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.13s]
[0m17:20:46.235168 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:20:46.235168 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:20:46.235168 [info ] [Thread-1 (]: 5 of 5 START sql table model dbo.trips ......................................... [RUN]
[0m17:20:46.235168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:20:46.235168 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:20:46.235168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:20:46.235168 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:20:46.235168 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:46.235168 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:20:46.235168 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:20:46.250791 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.250791 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:20:46.250791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:46.250791 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:20:46.250791 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:20:46.250791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.250791 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.266414 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:20:46.266414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.266414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:20:46.266414 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.266414 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:20:46.382314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.388819 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.388819 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:20:46.435687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.435687 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.435687 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:20:46.435687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.451310 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:20:46.451310 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:20:46.451310 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:20:46.451310 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:20:46.451310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:20:46.451310 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:20:46.451310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f9bcdda-48aa-433e-9f5a-f0c201fe70d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22EDB28D0>]}
[0m17:20:46.451310 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.22s]
[0m17:20:46.451310 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:20:46.451310 [debug] [MainThread]: On master: COMMIT
[0m17:20:46.451310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:46.451310 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:20:46.451310 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:20:46.451310 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:20:46.466930 [info ] [MainThread]: 
[0m17:20:46.466930 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m17:20:46.466930 [debug] [MainThread]: Command end result
[0m17:20:46.535992 [info ] [MainThread]: 
[0m17:20:46.535992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:46.535992 [info ] [MainThread]: 
[0m17:20:46.535992 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:20:46.535992 [info ] [MainThread]: 
[0m17:20:46.535992 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:20:46.535992 [debug] [MainThread]: Command `dbt run` failed at 17:20:46.535992 after 2.81 seconds
[0m17:20:46.535992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22CE799A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22CC41460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22C224590>]}
[0m17:20:46.551614 [debug] [MainThread]: Flushing usage events
[0m17:25:43.548307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303FFF11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303FE1E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303F19F770>]}


============================== 17:25:43.548307 | b59f3e47-a03d-432f-a4c6-f1b435726f62 ==============================
[0m17:25:43.548307 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:25:43.554841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:25:44.020797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023040594FE0>]}
[0m17:25:44.078622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303F224290>]}
[0m17:25:44.078622 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:25:44.347186 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:25:44.500696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:25:44.500696 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\example\avg_duration_distance.sql
[0m17:25:44.501661 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\example\top_5_pickup_locations.sql
[0m17:25:44.715254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230420FF1A0>]}
[0m17:25:44.806216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023041FCE9F0>]}
[0m17:25:44.814232 [info ] [MainThread]: Found 7 models, 502 macros
[0m17:25:44.814232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023041ECCDA0>]}
[0m17:25:44.816265 [info ] [MainThread]: 
[0m17:25:44.816265 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:25:44.824315 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:25:44.844829 [debug] [ThreadPool]: dbt-sqlserver
[0m17:25:44.844829 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:25:44.844829 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:25:44.844829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:44.857765 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.009347 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.024963 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m17:25:46.024963 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:25:46.024963 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:25:46.040579 [debug] [ThreadPool]: dbt-sqlserver
[0m17:25:46.040579 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:25:46.040579 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:25:46.040579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:46.040579 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.040579 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.090661 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:25:46.090661 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:25:46.090661 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:25:46.090661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230421DE960>]}
[0m17:25:46.090661 [debug] [MainThread]: On master: COMMIT
[0m17:25:46.090661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:46.090661 [info ] [MainThread]: 
[0m17:25:46.106285 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:25:46.106285 [info ] [Thread-1 (]: 1 of 5 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:25:46.106285 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.base_trip_data'
[0m17:25:46.106285 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:25:46.106285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:25:46.106285 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:25:46.147330 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.157777 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:25:46.157777 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.157777 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.157777 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:25:46.157777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:46.157777 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.157777 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.196707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.198730 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.198730 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:25:46.200826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.215604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:25:46.216601 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.216601 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:25:46.410382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.410382 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.410382 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:25:46.639566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.648606 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.648606 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:25:46.648606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.664265 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:25:46.664265 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:25:46.664265 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:25:46.664265 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:25:46.679852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.679852 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:25:46.679852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303DC01520>]}
[0m17:25:46.679852 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.57s]
[0m17:25:46.679852 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:25:46.679852 [debug] [Thread-1 (]: Began running node model.dbt_proj.daily_trip_trend
[0m17:25:46.679852 [info ] [Thread-1 (]: 2 of 5 START sql table model dbo.daily_trip_trend .............................. [RUN]
[0m17:25:46.679852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.daily_trip_trend)
[0m17:25:46.679852 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.daily_trip_trend
[0m17:25:46.679852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.daily_trip_trend"
[0m17:25:46.679852 [debug] [Thread-1 (]: Began executing node model.dbt_proj.daily_trip_trend
[0m17:25:46.679852 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.697738 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw"
[0m17:25:46.698736 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.700345 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:25:46.700728 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'daily_trip_trend__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:25:46.701762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:46.701762 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.701762 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.714381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.715487 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:25:46.715487 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw";');

[0m17:25:46.715487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.715487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.daily_trip_trend"
[0m17:25:46.715487 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:25:46.715487 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT
    FORMAT(pickup_datetime, ''yyyy-MM-dd'') AS trip_month,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY  FORMAT(pickup_datetime, ''yyyy-MM-dd'')
ORDER BY trip_month)

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."daily_trip_trend__dbt_tmp" FROM "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.daily_trip_trend__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_daily_trip_trend__dbt_tmp_cci'
        AND object_id=object_id('dbo_daily_trip_trend__dbt_tmp')
    )
    DROP index "dbo"."daily_trip_trend__dbt_tmp".dbo_daily_trip_trend__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_daily_trip_trend__dbt_tmp_cci
    ON "dbo"."daily_trip_trend__dbt_tmp"

   


  
[0m17:25:46.727841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.727841 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: ROLLBACK
[0m17:25:46.727841 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: Close
[0m17:25:46.727841 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\example\daily_trip_trend.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:25:46.727841 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')

[0m17:25:46.727841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023042910440>]}
[0m17:25:46.727841 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model dbo.daily_trip_trend ..................... [[31mERROR[0m in 0.05s]
[0m17:25:46.727841 [debug] [Thread-1 (]: Finished running node model.dbt_proj.daily_trip_trend
[0m17:25:46.727841 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:25:46.727841 [info ] [Thread-1 (]: 3 of 5 START sql table model dbo.location_details .............................. [RUN]
[0m17:25:46.727841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.daily_trip_trend, now model.dbt_proj.location_details)
[0m17:25:46.727841 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:25:46.742894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:25:46.743916 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:25:46.747992 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.748496 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:25:46.748496 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.748496 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.748496 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:25:46.748496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:46.748496 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.748496 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.765786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.767862 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.767862 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:25:46.767862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.767862 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:25:46.767862 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.773893 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:25:46.831684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.834678 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.835676 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:25:46.838090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.842186 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.842186 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:25:46.842186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.842186 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:25:46.848720 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:25:46.848720 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:25:46.848720 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:25:46.848720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.848720 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:25:46.848720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002304224CB30>]}
[0m17:25:46.848720 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.12s]
[0m17:25:46.848720 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:25:46.848720 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:25:46.848720 [info ] [Thread-1 (]: 4 of 5 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:25:46.848720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:25:46.848720 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:25:46.848720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:25:46.848720 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:25:46.867424 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.870523 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:25:46.873938 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:46.874940 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.875407 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:25:46.876194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:46.877193 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:46.877193 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:46.881508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.881508 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.890625 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:25:46.891622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.894799 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:25:46.894799 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.894799 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:25:46.958824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.958824 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.974446 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:25:46.974446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.974446 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.974446 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:25:46.974446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.974446 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:25:46.974446 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:25:46.974446 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:25:46.974446 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:25:46.990082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:46.990082 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:25:46.990082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023042954590>]}
[0m17:25:46.990082 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.14s]
[0m17:25:46.990082 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:25:46.990082 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:25:46.990082 [info ] [Thread-1 (]: 5 of 5 START sql table model dbo.trips ......................................... [RUN]
[0m17:25:46.990082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.trips)
[0m17:25:46.990082 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:25:46.990082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:25:46.990082 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:25:46.990082 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:47.007336 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:25:47.008333 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:25:47.009332 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.009332 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:25:47.010333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:47.011325 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:25:47.012324 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:25:47.022326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.024608 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.024608 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:25:47.024608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.024608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:25:47.024608 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.024608 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:25:47.145885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.148901 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.149899 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:25:47.152393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.155410 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.155410 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:25:47.157303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.157303 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:25:47.157303 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:25:47.157303 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:25:47.157303 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:25:47.157303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:47.157303 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:25:47.157303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b59f3e47-a03d-432f-a4c6-f1b435726f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002304231E1E0>]}
[0m17:25:47.157303 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.17s]
[0m17:25:47.157303 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:25:47.157303 [debug] [MainThread]: On master: COMMIT
[0m17:25:47.157303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:47.172937 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:25:47.172937 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:25:47.172937 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:25:47.172937 [info ] [MainThread]: 
[0m17:25:47.172937 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m17:25:47.177185 [debug] [MainThread]: Command end result
[0m17:25:47.255576 [info ] [MainThread]: 
[0m17:25:47.256573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:25:47.257426 [info ] [MainThread]: 
[0m17:25:47.258426 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:25:47.258698 [info ] [MainThread]: 
[0m17:25:47.259698 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:25:47.260695 [debug] [MainThread]: Command `dbt run` failed at 17:25:47.260695 after 3.83 seconds
[0m17:25:47.261695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303D78F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023042902A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023042900E00>]}
[0m17:25:47.261695 [debug] [MainThread]: Flushing usage events
[0m17:26:54.035767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A066DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CDD5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A0570650>]}


============================== 17:26:54.035767 | 4dc3be69-05e6-43f8-9b9e-444810fbc032 ==============================
[0m17:26:54.035767 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:26:54.035767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:54.482979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579FB372C0>]}
[0m17:26:54.536396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A0C02FC0>]}
[0m17:26:54.536396 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:26:54.783373 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:26:54.858580 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:26:54.858580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A07C6660>]}
[0m17:26:55.973688 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:26:55.973688 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:26:56.076243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:26:56.076243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:26:56.076243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:26:56.076243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:26:56.161431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A039AD20>]}
[0m17:26:56.243712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2781DF0>]}
[0m17:26:56.243712 [info ] [MainThread]: Found 7 models, 502 macros
[0m17:26:56.243712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A135B110>]}
[0m17:26:56.243712 [info ] [MainThread]: 
[0m17:26:56.243712 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:26:56.263650 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:26:56.279643 [debug] [ThreadPool]: dbt-sqlserver
[0m17:26:56.280610 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:26:56.280610 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:26:56.281611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:56.281611 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:56.350339 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:56.356323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:26:56.358319 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:26:56.359341 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:26:56.359341 [debug] [ThreadPool]: dbt-sqlserver
[0m17:26:56.359341 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:26:56.359341 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:26:56.359341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:56.359341 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:56.359341 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:56.412711 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:26:56.412711 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:26:56.412711 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:26:56.412711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A250CA70>]}
[0m17:26:56.412711 [debug] [MainThread]: On master: COMMIT
[0m17:26:56.412711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:56.412711 [info ] [MainThread]: 
[0m17:26:56.428337 [debug] [Thread-1 (]: Began running node model.dbt_proj.avg_duration_distance
[0m17:26:56.428337 [info ] [Thread-1 (]: 1 of 7 START sql table model dbo.avg_duration_distance ......................... [RUN]
[0m17:26:56.428337 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.avg_duration_distance'
[0m17:26:56.428337 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.avg_duration_distance
[0m17:26:56.428337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.avg_duration_distance"
[0m17:26:56.445720 [debug] [Thread-1 (]: Began executing node model.dbt_proj.avg_duration_distance
[0m17:26:56.475970 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:56.497361 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw"
[0m17:26:56.503341 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:56.504337 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:26:56.504337 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'avg_duration_distance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:56.505311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:56.506309 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:56.506309 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:56.524798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.525881 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:26:56.525881 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw";');

[0m17:26:56.525881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.541503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.avg_duration_distance"
[0m17:26:56.541503 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:26:56.541503 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" as --average distince and time according to days 
WITH CTE AS (
SELECT 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END AS time_of_day,
    AVG(trip_time / 60.0) AS avg_duration_minutes, -- Converts trip_time from seconds to minutes
    AVG(trip_miles) AS avg_distance_miles
FROM dbo.base_trip_data
GROUP BY 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END
ORDER BY time_of_day)

SELECT * FROM cte;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."avg_duration_distance__dbt_tmp" FROM "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.avg_duration_distance__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_avg_duration_distance__dbt_tmp_cci'
        AND object_id=object_id('dbo_avg_duration_distance__dbt_tmp')
    )
    DROP index "dbo"."avg_duration_distance__dbt_tmp".dbo_avg_duration_distance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_avg_duration_distance__dbt_tmp_cci
    ON "dbo"."avg_duration_distance__dbt_tmp"

   


  
[0m17:26:56.541503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.541503 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: ROLLBACK
[0m17:26:56.541503 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: Close
[0m17:26:56.541503 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\example\avg_duration_distance.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:26:56.557124 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')

[0m17:26:56.557124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A1275880>]}
[0m17:26:56.557124 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model dbo.avg_duration_distance ................ [[31mERROR[0m in 0.13s]
[0m17:26:56.557124 [debug] [Thread-1 (]: Finished running node model.dbt_proj.avg_duration_distance
[0m17:26:56.557124 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:26:56.557124 [info ] [Thread-1 (]: 2 of 7 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:26:56.557124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.avg_duration_distance, now model.dbt_proj.base_trip_data)
[0m17:26:56.557124 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:26:56.557124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:26:56.557124 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:26:56.572748 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:56.572748 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:26:56.588367 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:56.588367 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:56.588367 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:56.588367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:56.588367 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:56.588367 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:56.610867 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.614857 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:56.614857 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:26:56.614857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.614857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:26:56.614857 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:56.614857 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:26:56.807579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:56.814084 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:56.814084 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:26:57.024493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.024493 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:57.024493 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:26:57.040116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.055737 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:26:57.055737 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:26:57.055737 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:26:57.055737 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:26:57.071360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.071360 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:26:57.071360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579E2552B0>]}
[0m17:26:57.071360 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.51s]
[0m17:26:57.071360 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:26:57.071360 [debug] [Thread-1 (]: Began running node model.dbt_proj.daily_trip_trend
[0m17:26:57.071360 [info ] [Thread-1 (]: 3 of 7 START sql table model dbo.daily_trip_trend .............................. [RUN]
[0m17:26:57.071360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.daily_trip_trend)
[0m17:26:57.083550 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.daily_trip_trend
[0m17:26:57.086952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.daily_trip_trend"
[0m17:26:57.087947 [debug] [Thread-1 (]: Began executing node model.dbt_proj.daily_trip_trend
[0m17:26:57.092287 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.092287 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw"
[0m17:26:57.092287 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.092287 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:26:57.092287 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'daily_trip_trend__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:57.092287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:57.092287 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:57.092287 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:57.115072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.124507 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:26:57.125459 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw";');

[0m17:26:57.125459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.125459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.daily_trip_trend"
[0m17:26:57.125459 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:26:57.125459 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT
    FORMAT(pickup_datetime, ''yyyy-MM-dd'') AS trip_month,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY  FORMAT(pickup_datetime, ''yyyy-MM-dd''))

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."daily_trip_trend__dbt_tmp" FROM "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.daily_trip_trend__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_daily_trip_trend__dbt_tmp_cci'
        AND object_id=object_id('dbo_daily_trip_trend__dbt_tmp')
    )
    DROP index "dbo"."daily_trip_trend__dbt_tmp".dbo_daily_trip_trend__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_daily_trip_trend__dbt_tmp_cci
    ON "dbo"."daily_trip_trend__dbt_tmp"

   


  
[0m17:26:57.191887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.207509 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:26:57.207509 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.daily_trip_trend__dbt_tmp', 'daily_trip_trend'
[0m17:26:57.207509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.215046 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: COMMIT
[0m17:26:57.215046 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_backup"
[0m17:26:57.215046 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:26:57.215046 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."daily_trip_trend__dbt_backup";');

[0m17:26:57.215046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.215046 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: Close
[0m17:26:57.215046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2FAF7A0>]}
[0m17:26:57.215046 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbo.daily_trip_trend ......................... [[32mOK[0m in 0.14s]
[0m17:26:57.215046 [debug] [Thread-1 (]: Finished running node model.dbt_proj.daily_trip_trend
[0m17:26:57.215046 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:26:57.215046 [info ] [Thread-1 (]: 4 of 7 START sql table model dbo.location_details .............................. [RUN]
[0m17:26:57.215046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.daily_trip_trend, now model.dbt_proj.location_details)
[0m17:26:57.215046 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:26:57.215046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:26:57.215046 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:26:57.233652 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.236645 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:26:57.237661 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.237661 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.237661 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:57.237661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:57.237661 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:57.237661 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:57.248384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.248384 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.248384 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:26:57.248384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.259513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:26:57.260066 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.260066 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:26:57.318734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.322730 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.322730 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:26:57.325736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.325736 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.325736 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:26:57.325736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.325736 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:26:57.325736 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:26:57.325736 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:26:57.325736 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:26:57.341360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.341360 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:26:57.341360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A28885F0>]}
[0m17:26:57.341360 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.13s]
[0m17:26:57.341360 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:26:57.341360 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:26:57.341360 [info ] [Thread-1 (]: 5 of 7 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:26:57.341360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:26:57.341360 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:26:57.341360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:26:57.341360 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:26:57.341360 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.359255 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:26:57.360237 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.361264 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.362231 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:57.362231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:57.363327 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:57.363327 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:57.363327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.376619 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.377647 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:26:57.379143 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.381139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:26:57.382196 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.382196 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:26:57.455693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.458786 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.458786 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:26:57.458786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.458786 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.458786 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:26:57.458786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.458786 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:26:57.458786 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:26:57.474436 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:26:57.474436 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:26:57.474436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.474436 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:26:57.474436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2F716D0>]}
[0m17:26:57.474436 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.13s]
[0m17:26:57.474436 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:26:57.474436 [debug] [Thread-1 (]: Began running node model.dbt_proj.top_5_pickup_locations
[0m17:26:57.474436 [info ] [Thread-1 (]: 6 of 7 START sql table model dbo.top_5_pickup_locations ........................ [RUN]
[0m17:26:57.474436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.top_5_pickup_locations)
[0m17:26:57.474436 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.top_5_pickup_locations
[0m17:26:57.474436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.474436 [debug] [Thread-1 (]: Began executing node model.dbt_proj.top_5_pickup_locations
[0m17:26:57.492962 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.497946 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw"
[0m17:26:57.498943 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.498943 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.499940 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'top_5_pickup_locations__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:57.499940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:57.500938 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:57.501935 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:57.515449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.515449 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.515449 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw";');

[0m17:26:57.515449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.524976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.527425 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.528418 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT TOP 5
    PULocationID AS pickup_location_id,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY PULocationID
ORDER BY total_trips DESC)

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp" FROM "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.top_5_pickup_locations__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_top_5_pickup_locations__dbt_tmp_cci'
        AND object_id=object_id('dbo_top_5_pickup_locations__dbt_tmp')
    )
    DROP index "dbo"."top_5_pickup_locations__dbt_tmp".dbo_top_5_pickup_locations__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_top_5_pickup_locations__dbt_tmp_cci
    ON "dbo"."top_5_pickup_locations__dbt_tmp"

   


  
[0m17:26:57.554451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.558462 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.558462 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.top_5_pickup_locations__dbt_tmp', 'top_5_pickup_locations'
[0m17:26:57.558462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.558462 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: COMMIT
[0m17:26:57.558462 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_backup"
[0m17:26:57.558462 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:26:57.558462 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."top_5_pickup_locations__dbt_backup";');

[0m17:26:57.558462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.558462 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: Close
[0m17:26:57.574085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2FCD2E0>]}
[0m17:26:57.574920 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dbo.top_5_pickup_locations ................... [[32mOK[0m in 0.10s]
[0m17:26:57.574920 [debug] [Thread-1 (]: Finished running node model.dbt_proj.top_5_pickup_locations
[0m17:26:57.574920 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:26:57.574920 [info ] [Thread-1 (]: 7 of 7 START sql table model dbo.trips ......................................... [RUN]
[0m17:26:57.574920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.top_5_pickup_locations, now model.dbt_proj.trips)
[0m17:26:57.574920 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:26:57.574920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:26:57.574920 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:26:57.574920 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.574920 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:26:57.591298 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:26:57.592296 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.593619 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:26:57.593619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:57.594617 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:26:57.595614 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:26:57.608881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.611792 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.612789 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:26:57.613786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.615804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:26:57.615804 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.615804 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:26:57.716069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.731717 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.731717 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:26:57.731717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.731717 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.731717 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:26:57.731717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.731717 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:26:57.731717 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:26:57.747317 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:26:57.747317 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:26:57.747317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:57.747317 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:26:57.747317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc3be69-05e6-43f8-9b9e-444810fbc032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A2FF7830>]}
[0m17:26:57.747317 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.17s]
[0m17:26:57.747317 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:26:57.747317 [debug] [MainThread]: On master: COMMIT
[0m17:26:57.747317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:57.747317 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:26:57.747317 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:26:57.747317 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:26:57.747317 [info ] [MainThread]: 
[0m17:26:57.747317 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m17:26:57.762856 [debug] [MainThread]: Command end result
[0m17:26:57.796188 [info ] [MainThread]: 
[0m17:26:57.797153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:57.798151 [info ] [MainThread]: 
[0m17:26:57.799148 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:26:57.800210 [info ] [MainThread]: 
[0m17:26:57.800210 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m17:26:57.800210 [debug] [MainThread]: Command `dbt run` failed at 17:26:57.800210 after 3.86 seconds
[0m17:26:57.800210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579D83F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579D83CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A046D820>]}
[0m17:26:57.800210 [debug] [MainThread]: Flushing usage events
[0m17:27:46.571223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C13397BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C15072870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C154FF5F0>]}


============================== 17:27:46.571223 | baa3917e-ec20-4b43-9e2c-9f44538b4c3d ==============================
[0m17:27:46.571223 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:27:46.571223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:27:47.003161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C165C4FE0>]}
[0m17:27:47.056578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C1510A990>]}
[0m17:27:47.056578 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:27:47.303429 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:27:47.452691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:47.452691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:47.483234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17A56D50>]}
[0m17:27:47.581940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17A774D0>]}
[0m17:27:47.581940 [info ] [MainThread]: Found 7 models, 502 macros
[0m17:27:47.581940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C15B0E960>]}
[0m17:27:47.581940 [info ] [MainThread]: 
[0m17:27:47.581940 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:27:47.581940 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:27:47.610369 [debug] [ThreadPool]: dbt-sqlserver
[0m17:27:47.611366 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:27:47.611366 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:27:47.612411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:47.612411 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:47.626650 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:47.642866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:27:47.643885 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:27:47.646137 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:27:47.652123 [debug] [ThreadPool]: dbt-sqlserver
[0m17:27:47.652123 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:27:47.653121 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:27:47.653121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:47.654133 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:47.654133 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:47.657139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:27:47.659508 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:27:47.660520 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:27:47.662597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C15D10740>]}
[0m17:27:47.662597 [debug] [MainThread]: On master: COMMIT
[0m17:27:47.663626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:47.664596 [info ] [MainThread]: 
[0m17:27:47.667938 [debug] [Thread-1 (]: Began running node model.dbt_proj.avg_duration_distance
[0m17:27:47.667938 [info ] [Thread-1 (]: 1 of 7 START sql table model dbo.avg_duration_distance ......................... [RUN]
[0m17:27:47.668939 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.avg_duration_distance'
[0m17:27:47.669938 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.avg_duration_distance
[0m17:27:47.678688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.avg_duration_distance"
[0m17:27:47.679743 [debug] [Thread-1 (]: Began executing node model.dbt_proj.avg_duration_distance
[0m17:27:47.713707 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:47.726677 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw"
[0m17:27:47.726677 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:47.726677 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:27:47.726677 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'avg_duration_distance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:47.726677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:47.726677 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:47.726677 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:47.726677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.742696 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:27:47.742696 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw";');

[0m17:27:47.744689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.758648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.avg_duration_distance"
[0m17:27:47.759626 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:27:47.760626 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" as --average distince and time according to days 
WITH CTE AS (
SELECT 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END AS time_of_day,
    AVG(trip_time / 60.0) AS avg_duration_minutes, -- Converts trip_time from seconds to minutes
    AVG(trip_miles) AS avg_distance_miles
FROM dbo.base_trip_data
GROUP BY 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END
ORDER BY time_of_day)

SELECT * FROM cte;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."avg_duration_distance__dbt_tmp" FROM "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.avg_duration_distance__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_avg_duration_distance__dbt_tmp_cci'
        AND object_id=object_id('dbo_avg_duration_distance__dbt_tmp')
    )
    DROP index "dbo"."avg_duration_distance__dbt_tmp".dbo_avg_duration_distance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_avg_duration_distance__dbt_tmp_cci
    ON "dbo"."avg_duration_distance__dbt_tmp"

   


  
[0m17:27:47.762420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.763420 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: ROLLBACK
[0m17:27:47.763420 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: Close
[0m17:27:47.764417 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_proj\models\example\avg_duration_distance.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:27:47.768305 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt_common\clients\jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\base\impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "Z:\Archives\dbt_Project\dbt_venv\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 568, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')

[0m17:27:47.769277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17E63710>]}
[0m17:27:47.770304 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model dbo.avg_duration_distance ................ [[31mERROR[0m in 0.10s]
[0m17:27:47.771273 [debug] [Thread-1 (]: Finished running node model.dbt_proj.avg_duration_distance
[0m17:27:47.772271 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:27:47.773295 [info ] [Thread-1 (]: 2 of 7 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:27:47.774266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.avg_duration_distance, now model.dbt_proj.base_trip_data)
[0m17:27:47.775124 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:27:47.778901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:27:47.779631 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:27:47.782166 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:47.782166 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:27:47.782166 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:47.782166 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.782166 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:47.782166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:47.782166 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:47.782166 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:47.782166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.793738 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.793738 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:27:47.795708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.796043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:27:47.796043 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.796043 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:27:47.944684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.960338 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.960338 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:27:47.960338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.960338 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.960338 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:27:47.960338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.982432 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:27:47.982432 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:27:47.982432 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:27:47.982432 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:27:47.982432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:47.998064 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:27:47.998064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C138F5130>]}
[0m17:27:47.998064 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.22s]
[0m17:27:47.998064 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:27:47.998064 [debug] [Thread-1 (]: Began running node model.dbt_proj.daily_trip_trend
[0m17:27:47.998064 [info ] [Thread-1 (]: 3 of 7 START sql table model dbo.daily_trip_trend .............................. [RUN]
[0m17:27:47.998064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.daily_trip_trend)
[0m17:27:47.998064 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.daily_trip_trend
[0m17:27:47.998064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.daily_trip_trend"
[0m17:27:47.998064 [debug] [Thread-1 (]: Began executing node model.dbt_proj.daily_trip_trend
[0m17:27:47.998064 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:47.998064 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw"
[0m17:27:48.014596 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.015621 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.015621 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'daily_trip_trend__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:48.016619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.016619 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:48.018253 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:48.018597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.020644 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.020644 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw";');

[0m17:27:48.020644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.025988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.daily_trip_trend"
[0m17:27:48.026878 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.027876 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT
    FORMAT(pickup_datetime, ''yyyy-MM-dd'') AS trip_month,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY  FORMAT(pickup_datetime, ''yyyy-MM-dd''))

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."daily_trip_trend__dbt_tmp" FROM "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.daily_trip_trend__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_daily_trip_trend__dbt_tmp_cci'
        AND object_id=object_id('dbo_daily_trip_trend__dbt_tmp')
    )
    DROP index "dbo"."daily_trip_trend__dbt_tmp".dbo_daily_trip_trend__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_daily_trip_trend__dbt_tmp_cci
    ON "dbo"."daily_trip_trend__dbt_tmp"

   


  
[0m17:27:48.105080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.109170 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.109170 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.daily_trip_trend', 'daily_trip_trend__dbt_backup'
[0m17:27:48.109170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.109170 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.109170 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.daily_trip_trend__dbt_tmp', 'daily_trip_trend'
[0m17:27:48.109170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.109170 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: COMMIT
[0m17:27:48.109170 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_backup"
[0m17:27:48.124824 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:27:48.124824 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."daily_trip_trend__dbt_backup";');

[0m17:27:48.124824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.124824 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: Close
[0m17:27:48.124824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C185B35C0>]}
[0m17:27:48.124824 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbo.daily_trip_trend ......................... [[32mOK[0m in 0.13s]
[0m17:27:48.124824 [debug] [Thread-1 (]: Finished running node model.dbt_proj.daily_trip_trend
[0m17:27:48.124824 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:27:48.124824 [info ] [Thread-1 (]: 4 of 7 START sql table model dbo.location_details .............................. [RUN]
[0m17:27:48.124824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.daily_trip_trend, now model.dbt_proj.location_details)
[0m17:27:48.124824 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:27:48.124824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:27:48.124824 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:27:48.124824 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.142160 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:27:48.143163 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.144181 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.145152 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:48.145152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.146157 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:48.147147 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:48.147693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.149718 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.149718 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:27:48.151319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.153316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:27:48.154314 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.155310 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:27:48.213832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.217823 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.217823 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:27:48.220475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.224490 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.224490 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:27:48.227420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.229440 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:27:48.231440 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:27:48.232438 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:27:48.233435 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:27:48.235714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.236714 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:27:48.237711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17DC0C20>]}
[0m17:27:48.238708 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.11s]
[0m17:27:48.239308 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:27:48.240336 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:27:48.240336 [info ] [Thread-1 (]: 5 of 7 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:27:48.241334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:27:48.242313 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:27:48.243400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:27:48.243400 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:27:48.243400 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.243400 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:27:48.243400 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.243400 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.243400 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:48.243400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.243400 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:48.243400 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:48.243400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.243400 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.243400 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:27:48.259914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.263377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:27:48.264712 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.264712 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:27:48.340249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.343236 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.343236 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:27:48.343236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.343236 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.343236 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:27:48.343236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.343236 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:27:48.343236 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:27:48.343236 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:27:48.358887 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:27:48.358887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.358887 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:27:48.358887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17E38770>]}
[0m17:27:48.358887 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.12s]
[0m17:27:48.358887 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:27:48.358887 [debug] [Thread-1 (]: Began running node model.dbt_proj.top_5_pickup_locations
[0m17:27:48.358887 [info ] [Thread-1 (]: 6 of 7 START sql table model dbo.top_5_pickup_locations ........................ [RUN]
[0m17:27:48.358887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.top_5_pickup_locations)
[0m17:27:48.358887 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.top_5_pickup_locations
[0m17:27:48.358887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.358887 [debug] [Thread-1 (]: Began executing node model.dbt_proj.top_5_pickup_locations
[0m17:27:48.358887 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.376531 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw"
[0m17:27:48.378419 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.379219 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.379219 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'top_5_pickup_locations__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:48.380247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.380247 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:48.381214 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:48.382264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.382768 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.382768 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw";');

[0m17:27:48.382768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.382768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.382768 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.382768 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT TOP 5
    PULocationID AS pickup_location_id,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY PULocationID
ORDER BY total_trips DESC)

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp" FROM "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.top_5_pickup_locations__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_top_5_pickup_locations__dbt_tmp_cci'
        AND object_id=object_id('dbo_top_5_pickup_locations__dbt_tmp')
    )
    DROP index "dbo"."top_5_pickup_locations__dbt_tmp".dbo_top_5_pickup_locations__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_top_5_pickup_locations__dbt_tmp_cci
    ON "dbo"."top_5_pickup_locations__dbt_tmp"

   


  
[0m17:27:48.410294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.410294 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.410294 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.top_5_pickup_locations', 'top_5_pickup_locations__dbt_backup'
[0m17:27:48.410294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.426369 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.426369 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.top_5_pickup_locations__dbt_tmp', 'top_5_pickup_locations'
[0m17:27:48.426369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.426369 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: COMMIT
[0m17:27:48.426369 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_backup"
[0m17:27:48.426369 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:27:48.426369 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."top_5_pickup_locations__dbt_backup";');

[0m17:27:48.426369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.426369 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: Close
[0m17:27:48.426369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17E39160>]}
[0m17:27:48.426369 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dbo.top_5_pickup_locations ................... [[32mOK[0m in 0.07s]
[0m17:27:48.442321 [debug] [Thread-1 (]: Finished running node model.dbt_proj.top_5_pickup_locations
[0m17:27:48.442321 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:27:48.443349 [info ] [Thread-1 (]: 7 of 7 START sql table model dbo.trips ......................................... [RUN]
[0m17:27:48.444316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.top_5_pickup_locations, now model.dbt_proj.trips)
[0m17:27:48.444316 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:27:48.448330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:27:48.449302 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:27:48.452322 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.454318 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:27:48.455331 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:27:48.456285 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.456285 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:27:48.457319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.458279 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:27:48.458279 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:27:48.460073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.462537 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.462537 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:27:48.463554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.463554 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:27:48.463554 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.463554 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:27:48.582616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.582616 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.582616 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:27:48.582616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.582616 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.582616 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:27:48.582616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.598264 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:27:48.598264 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:27:48.598264 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:27:48.598264 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:27:48.598264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:48.598264 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:27:48.598264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa3917e-ec20-4b43-9e2c-9f44538b4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C17DBE6C0>]}
[0m17:27:48.598264 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.15s]
[0m17:27:48.598264 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:27:48.598264 [debug] [MainThread]: On master: COMMIT
[0m17:27:48.598264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:48.598264 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:27:48.598264 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:27:48.598264 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:27:48.598264 [info ] [MainThread]: 
[0m17:27:48.613862 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m17:27:48.616898 [debug] [MainThread]: Command end result
[0m17:27:48.691983 [info ] [MainThread]: 
[0m17:27:48.692643 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:27:48.693644 [info ] [MainThread]: 
[0m17:27:48.694641 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The ORDER BY clause is invalid in views, inline functions, derived tables, subqueries, and common table expressions, unless TOP, OFFSET or FOR XML is also specified. (1033) (SQLMoreResults)')
[0m17:27:48.694641 [info ] [MainThread]: 
[0m17:27:48.695961 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m17:27:48.696962 [debug] [MainThread]: Command `dbt run` failed at 17:27:48.696962 after 2.23 seconds
[0m17:27:48.697959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C1516F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C15998A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C124BCF50>]}
[0m17:27:48.697959 [debug] [MainThread]: Flushing usage events
[0m17:28:13.356636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9B837E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9DAC9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9A9153D0>]}


============================== 17:28:13.356636 | c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f ==============================
[0m17:28:13.356636 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:28:13.356636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\wmuntu\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'Z:\\Archives\\dbt_Project\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:13.789153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9E34B4D0>]}
[0m17:28:13.842504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9EAF6960>]}
[0m17:28:13.842504 [info ] [MainThread]: Registered adapter: sqlserver=1.8.5
[0m17:28:14.087859 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:28:14.162007 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:28:14.162007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA01CF110>]}
[0m17:28:15.388683 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:28:15.388683 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m17:28:15.494204 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:28:15.495203 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m17:28:15.496177 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:28:15.497174 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m17:28:15.577502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9DEDC7A0>]}
[0m17:28:15.657544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0389730>]}
[0m17:28:15.657544 [info ] [MainThread]: Found 7 models, 502 macros
[0m17:28:15.657544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA036B5F0>]}
[0m17:28:15.657544 [info ] [MainThread]: 
[0m17:28:15.657544 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:28:15.673166 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project'
[0m17:28:15.693056 [debug] [ThreadPool]: dbt-sqlserver
[0m17:28:15.693808 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project"
[0m17:28:15.694914 [debug] [ThreadPool]: On list_dbt_project: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project"} */
USE [dbt_project];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:28:15.694914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:15.694914 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:15.763246 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:15.770785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:15.771785 [debug] [ThreadPool]: On list_dbt_project: Close
[0m17:28:15.774312 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_dbt_project_dbo'
[0m17:28:15.779684 [debug] [ThreadPool]: dbt-sqlserver
[0m17:28:15.780682 [debug] [ThreadPool]: Using sqlserver connection "list_dbt_project_dbo"
[0m17:28:15.781649 [debug] [ThreadPool]: On list_dbt_project_dbo: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_dbt_project_dbo"} */
USE [dbt_project];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m17:28:15.781649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:15.782645 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:15.782645 [debug] [ThreadPool]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:15.824626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:15.824626 [debug] [ThreadPool]: On list_dbt_project_dbo: ROLLBACK
[0m17:28:15.824626 [debug] [ThreadPool]: On list_dbt_project_dbo: Close
[0m17:28:15.824626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA00A5BB0>]}
[0m17:28:15.840244 [debug] [MainThread]: On master: COMMIT
[0m17:28:15.840244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:15.840244 [info ] [MainThread]: 
[0m17:28:15.840244 [debug] [Thread-1 (]: Began running node model.dbt_proj.avg_duration_distance
[0m17:28:15.840244 [info ] [Thread-1 (]: 1 of 7 START sql table model dbo.avg_duration_distance ......................... [RUN]
[0m17:28:15.840244 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_proj.avg_duration_distance'
[0m17:28:15.840244 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.avg_duration_distance
[0m17:28:15.840244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.avg_duration_distance"
[0m17:28:15.840244 [debug] [Thread-1 (]: Began executing node model.dbt_proj.avg_duration_distance
[0m17:28:15.894896 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:15.894896 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw"
[0m17:28:15.912202 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:15.912202 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:28:15.913200 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'avg_duration_distance__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:15.913200 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:15.914168 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:15.915165 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:15.937911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:15.939908 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:28:15.939908 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw";');

[0m17:28:15.941866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:15.942745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.avg_duration_distance"
[0m17:28:15.942745 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:28:15.958367 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END AS time_of_day,
    AVG(trip_time / 60.0) AS avg_duration_minutes, -- Converts trip_time from seconds to minutes
    AVG(trip_miles) AS avg_distance_miles
FROM dbo.base_trip_data
GROUP BY 
    CASE 
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 0 AND 5 THEN ''Late Night''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 6 AND 11 THEN ''Morning''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 12 AND 17 THEN ''Afternoon''
        WHEN DATEPART(HOUR, pickup_datetime) BETWEEN 18 AND 23 THEN ''Evening''
    END)

SELECT * FROM cte;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."avg_duration_distance__dbt_tmp" FROM "dbt_project"."dbo"."avg_duration_distance__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.avg_duration_distance__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_avg_duration_distance__dbt_tmp_cci'
        AND object_id=object_id('dbo_avg_duration_distance__dbt_tmp')
    )
    DROP index "dbo"."avg_duration_distance__dbt_tmp".dbo_avg_duration_distance__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_avg_duration_distance__dbt_tmp_cci
    ON "dbo"."avg_duration_distance__dbt_tmp"

   


  
[0m17:28:15.989639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.005231 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:28:16.005231 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.avg_duration_distance__dbt_tmp', 'avg_duration_distance'
[0m17:28:16.256488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.272079 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: COMMIT
[0m17:28:16.272079 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."avg_duration_distance__dbt_backup"
[0m17:28:16.272079 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.avg_duration_distance"
[0m17:28:16.272079 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.avg_duration_distance"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."avg_duration_distance__dbt_backup";');

[0m17:28:16.272079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.272079 [debug] [Thread-1 (]: On model.dbt_proj.avg_duration_distance: Close
[0m17:28:16.272079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9E3312B0>]}
[0m17:28:16.272079 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbo.avg_duration_distance .................... [[32mOK[0m in 0.43s]
[0m17:28:16.272079 [debug] [Thread-1 (]: Finished running node model.dbt_proj.avg_duration_distance
[0m17:28:16.272079 [debug] [Thread-1 (]: Began running node model.dbt_proj.base_trip_data
[0m17:28:16.287701 [info ] [Thread-1 (]: 2 of 7 START sql table model dbo.base_trip_data ................................ [RUN]
[0m17:28:16.287701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.avg_duration_distance, now model.dbt_proj.base_trip_data)
[0m17:28:16.287701 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.base_trip_data
[0m17:28:16.287701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.base_trip_data"
[0m17:28:16.287701 [debug] [Thread-1 (]: Began executing node model.dbt_proj.base_trip_data
[0m17:28:16.287701 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.287701 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw"
[0m17:28:16.287701 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.287701 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.287701 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'base_trip_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:16.287701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:16.287701 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:16.287701 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:16.312721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.312721 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.312721 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw";');

[0m17:28:16.312721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.312721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.base_trip_data"
[0m17:28:16.312721 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.312721 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" as WITH cleaned_data AS (
SELECT
    newid() as FHV_Trip_ID,
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    CONVERT(datetime, request_datetime) AS request_datetime,
    CONVERT(datetime, on_scene_datetime) AS on_scene_datetime,
    CONVERT(datetime, pickup_datetime) AS pickup_datetime,
    CONVERT(datetime, dropoff_datetime) AS dropoff_datetime,
    PULocationID,
    DOLocationID,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM [dbo].[FHV_Trip_Records]
WHERE 
    -- Exclude rows with missing or invalid trip data
    trip_miles IS NOT NULL AND trip_time IS NOT NULL
    AND base_passenger_fare IS NOT NULL
    -- Remove rows with zero values for key metrics
    AND trip_miles > 0 AND trip_time > 0
    -- Keep rows with valid PULocationID and DOLocationID
    AND PULocationID IS NOT NULL AND DOLocationID IS NOT NULL
)

SELECT * FROM cleaned_data;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."base_trip_data__dbt_tmp" FROM "dbt_project"."dbo"."base_trip_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.base_trip_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_base_trip_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_base_trip_data__dbt_tmp')
    )
    DROP index "dbo"."base_trip_data__dbt_tmp".dbo_base_trip_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_base_trip_data__dbt_tmp_cci
    ON "dbo"."base_trip_data__dbt_tmp"

   


  
[0m17:28:16.541432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.557016 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.557016 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data', 'base_trip_data__dbt_backup'
[0m17:28:16.557016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.557016 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.557016 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.base_trip_data__dbt_tmp', 'base_trip_data'
[0m17:28:16.557016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.572637 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: COMMIT
[0m17:28:16.572637 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."base_trip_data__dbt_backup"
[0m17:28:16.572637 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.base_trip_data"
[0m17:28:16.572637 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.base_trip_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."base_trip_data__dbt_backup";');

[0m17:28:16.572637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.572637 [debug] [Thread-1 (]: On model.dbt_proj.base_trip_data: Close
[0m17:28:16.572637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0A95460>]}
[0m17:28:16.572637 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbo.base_trip_data ........................... [[32mOK[0m in 0.28s]
[0m17:28:16.572637 [debug] [Thread-1 (]: Finished running node model.dbt_proj.base_trip_data
[0m17:28:16.572637 [debug] [Thread-1 (]: Began running node model.dbt_proj.daily_trip_trend
[0m17:28:16.572637 [info ] [Thread-1 (]: 3 of 7 START sql table model dbo.daily_trip_trend .............................. [RUN]
[0m17:28:16.572637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.base_trip_data, now model.dbt_proj.daily_trip_trend)
[0m17:28:16.572637 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.daily_trip_trend
[0m17:28:16.588259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.daily_trip_trend"
[0m17:28:16.588259 [debug] [Thread-1 (]: Began executing node model.dbt_proj.daily_trip_trend
[0m17:28:16.588259 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.588259 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw"
[0m17:28:16.588259 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.588259 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.588259 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'daily_trip_trend__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:16.588259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:16.588259 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:16.588259 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:16.613066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.615063 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.615063 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw";');

[0m17:28:16.616110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.616110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.daily_trip_trend"
[0m17:28:16.616110 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.616110 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT
    FORMAT(pickup_datetime, ''yyyy-MM-dd'') AS trip_month,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY  FORMAT(pickup_datetime, ''yyyy-MM-dd''))

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."daily_trip_trend__dbt_tmp" FROM "dbt_project"."dbo"."daily_trip_trend__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.daily_trip_trend__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_daily_trip_trend__dbt_tmp_cci'
        AND object_id=object_id('dbo_daily_trip_trend__dbt_tmp')
    )
    DROP index "dbo"."daily_trip_trend__dbt_tmp".dbo_daily_trip_trend__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_daily_trip_trend__dbt_tmp_cci
    ON "dbo"."daily_trip_trend__dbt_tmp"

   


  
[0m17:28:16.696799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.700790 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.700790 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.daily_trip_trend', 'daily_trip_trend__dbt_backup'
[0m17:28:16.703836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.706830 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.707827 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.daily_trip_trend__dbt_tmp', 'daily_trip_trend'
[0m17:28:16.710341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.710341 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: COMMIT
[0m17:28:16.710341 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."daily_trip_trend__dbt_backup"
[0m17:28:16.710341 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.daily_trip_trend"
[0m17:28:16.710341 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.daily_trip_trend"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."daily_trip_trend__dbt_backup";');

[0m17:28:16.710341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.710341 [debug] [Thread-1 (]: On model.dbt_proj.daily_trip_trend: Close
[0m17:28:16.710341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA04C9A60>]}
[0m17:28:16.710341 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbo.daily_trip_trend ......................... [[32mOK[0m in 0.14s]
[0m17:28:16.710341 [debug] [Thread-1 (]: Finished running node model.dbt_proj.daily_trip_trend
[0m17:28:16.710341 [debug] [Thread-1 (]: Began running node model.dbt_proj.location_details
[0m17:28:16.710341 [info ] [Thread-1 (]: 4 of 7 START sql table model dbo.location_details .............................. [RUN]
[0m17:28:16.710341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.daily_trip_trend, now model.dbt_proj.location_details)
[0m17:28:16.710341 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.location_details
[0m17:28:16.725995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.location_details"
[0m17:28:16.725995 [debug] [Thread-1 (]: Began executing node model.dbt_proj.location_details
[0m17:28:16.741618 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.747310 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw"
[0m17:28:16.748754 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.749814 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.749814 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'location_details__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:16.749814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:16.749814 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:16.749814 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:16.763492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.765458 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.765458 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."location_details__dbt_tmp__dbt_tmp_vw";');

[0m17:28:16.766454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.767562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.location_details"
[0m17:28:16.767562 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.767562 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."location_details__dbt_tmp__dbt_tmp_vw" as WITH LocationDetails AS (
    SELECT 
    FHV_Trip_ID,  
    PULocationID AS pickup_location_id,
    DOLocationID AS dropoff_location_id
FROM dbo.base_trip_data
)
-- Select distinct location details
SELECT *
FROM LocationDetails;;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."location_details__dbt_tmp" FROM "dbt_project"."dbo"."location_details__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.location_details__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_location_details__dbt_tmp_cci'
        AND object_id=object_id('dbo_location_details__dbt_tmp')
    )
    DROP index "dbo"."location_details__dbt_tmp".dbo_location_details__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_location_details__dbt_tmp_cci
    ON "dbo"."location_details__dbt_tmp"

   


  
[0m17:28:16.830444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.834435 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.834435 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details', 'location_details__dbt_backup'
[0m17:28:16.837399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.840393 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.841401 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.location_details__dbt_tmp', 'location_details'
[0m17:28:16.843404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.843404 [debug] [Thread-1 (]: On model.dbt_proj.location_details: COMMIT
[0m17:28:16.843404 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."location_details__dbt_backup"
[0m17:28:16.843404 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.location_details"
[0m17:28:16.843404 [debug] [Thread-1 (]: On model.dbt_proj.location_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.location_details"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."location_details__dbt_backup";');

[0m17:28:16.843404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.843404 [debug] [Thread-1 (]: On model.dbt_proj.location_details: Close
[0m17:28:16.843404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0ADEC60>]}
[0m17:28:16.843404 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbo.location_details ......................... [[32mOK[0m in 0.13s]
[0m17:28:16.843404 [debug] [Thread-1 (]: Finished running node model.dbt_proj.location_details
[0m17:28:16.843404 [debug] [Thread-1 (]: Began running node model.dbt_proj.temporal_data
[0m17:28:16.843404 [info ] [Thread-1 (]: 5 of 7 START sql table model dbo.temporal_data ................................. [RUN]
[0m17:28:16.859027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.location_details, now model.dbt_proj.temporal_data)
[0m17:28:16.859027 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.temporal_data
[0m17:28:16.859027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.temporal_data"
[0m17:28:16.859027 [debug] [Thread-1 (]: Began executing node model.dbt_proj.temporal_data
[0m17:28:16.859027 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.859027 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw"
[0m17:28:16.859027 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.859027 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.859027 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'temporal_data__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:16.859027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:16.859027 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:16.859027 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:16.880868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.880868 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.880868 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw";');

[0m17:28:16.880868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.880868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.temporal_data"
[0m17:28:16.880868 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.880868 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" as with cte as (
SELECT 
    FHV_Trip_ID,  
    CONVERT(DATE, request_datetime) AS request_date,
    DATEPART(HOUR, request_datetime) AS request_hour,
    CONVERT(DATE, pickup_datetime) AS pickup_date,
    DATEPART(HOUR, pickup_datetime) AS pickup_hour,
    CONVERT(DATE, dropoff_datetime) AS dropoff_date,
    DATEPART(HOUR, dropoff_datetime) AS dropoff_hour
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."temporal_data__dbt_tmp" FROM "dbt_project"."dbo"."temporal_data__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.temporal_data__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_temporal_data__dbt_tmp_cci'
        AND object_id=object_id('dbo_temporal_data__dbt_tmp')
    )
    DROP index "dbo"."temporal_data__dbt_tmp".dbo_temporal_data__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_temporal_data__dbt_tmp_cci
    ON "dbo"."temporal_data__dbt_tmp"

   


  
[0m17:28:16.964226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.968217 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.968217 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data', 'temporal_data__dbt_backup'
[0m17:28:16.971232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.975224 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.975224 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.temporal_data__dbt_tmp', 'temporal_data'
[0m17:28:16.976268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.976268 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: COMMIT
[0m17:28:16.976268 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."temporal_data__dbt_backup"
[0m17:28:16.976268 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.temporal_data"
[0m17:28:16.976268 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.temporal_data"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."temporal_data__dbt_backup";');

[0m17:28:16.976268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:16.976268 [debug] [Thread-1 (]: On model.dbt_proj.temporal_data: Close
[0m17:28:16.976268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0445EE0>]}
[0m17:28:16.976268 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbo.temporal_data ............................ [[32mOK[0m in 0.13s]
[0m17:28:16.976268 [debug] [Thread-1 (]: Finished running node model.dbt_proj.temporal_data
[0m17:28:16.976268 [debug] [Thread-1 (]: Began running node model.dbt_proj.top_5_pickup_locations
[0m17:28:16.991919 [info ] [Thread-1 (]: 6 of 7 START sql table model dbo.top_5_pickup_locations ........................ [RUN]
[0m17:28:16.991919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.temporal_data, now model.dbt_proj.top_5_pickup_locations)
[0m17:28:16.991919 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.top_5_pickup_locations
[0m17:28:16.991919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.top_5_pickup_locations"
[0m17:28:16.991919 [debug] [Thread-1 (]: Began executing node model.dbt_proj.top_5_pickup_locations
[0m17:28:16.991919 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.991919 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw"
[0m17:28:16.991919 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:16.991919 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:16.991919 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'top_5_pickup_locations__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:16.991919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:16.991919 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:17.007513 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:17.018330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.020326 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.020326 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw";');

[0m17:28:17.021324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.025314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.026630 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.028129 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" as WITH CTE AS (
SELECT TOP 5
    PULocationID AS pickup_location_id,
    COUNT(FHV_Trip_ID) AS total_trips
FROM dbo.base_trip_data
GROUP BY PULocationID
ORDER BY total_trips DESC)

SELECT * FROM CTE;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp" FROM "dbt_project"."dbo"."top_5_pickup_locations__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.top_5_pickup_locations__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_top_5_pickup_locations__dbt_tmp_cci'
        AND object_id=object_id('dbo_top_5_pickup_locations__dbt_tmp')
    )
    DROP index "dbo"."top_5_pickup_locations__dbt_tmp".dbo_top_5_pickup_locations__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_top_5_pickup_locations__dbt_tmp_cci
    ON "dbo"."top_5_pickup_locations__dbt_tmp"

   


  
[0m17:28:17.042652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.042652 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.042652 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.top_5_pickup_locations', 'top_5_pickup_locations__dbt_backup'
[0m17:28:17.059380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.059380 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.059380 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.top_5_pickup_locations__dbt_tmp', 'top_5_pickup_locations'
[0m17:28:17.059380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.059380 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: COMMIT
[0m17:28:17.059380 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."top_5_pickup_locations__dbt_backup"
[0m17:28:17.059380 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.top_5_pickup_locations"
[0m17:28:17.059380 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.top_5_pickup_locations"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."top_5_pickup_locations__dbt_backup";');

[0m17:28:17.076543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.077542 [debug] [Thread-1 (]: On model.dbt_proj.top_5_pickup_locations: Close
[0m17:28:17.078539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0445D90>]}
[0m17:28:17.079536 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dbo.top_5_pickup_locations ................... [[32mOK[0m in 0.09s]
[0m17:28:17.080149 [debug] [Thread-1 (]: Finished running node model.dbt_proj.top_5_pickup_locations
[0m17:28:17.081178 [debug] [Thread-1 (]: Began running node model.dbt_proj.trips
[0m17:28:17.082147 [info ] [Thread-1 (]: 7 of 7 START sql table model dbo.trips ......................................... [RUN]
[0m17:28:17.082147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.top_5_pickup_locations, now model.dbt_proj.trips)
[0m17:28:17.083144 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.trips
[0m17:28:17.085166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.trips"
[0m17:28:17.086136 [debug] [Thread-1 (]: Began executing node model.dbt_proj.trips
[0m17:28:17.089152 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:17.092122 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw"
[0m17:28:17.093987 [debug] [Thread-1 (]: dbt-sqlserver
[0m17:28:17.094999 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.094999 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

        USE [dbt_project];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'dbt_project'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m17:28:17.095984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:17.096982 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=Calrom-dev161\SQLEXPRESS01;Database=dbt_project;UID={dbt};PWD=***;encrypt=No;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.5
[0m17:28:17.096982 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: dbt_project
[0m17:28:17.098027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.110608 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.110608 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
      
    
    USE [dbt_project];
    EXEC('DROP view IF EXISTS "dbo"."trips__dbt_tmp__dbt_tmp_vw";');

[0m17:28:17.112374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.114370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.trips"
[0m17:28:17.115438 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.115438 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

  
    USE [dbt_project];
    USE [dbt_project];
    
    

    

    
    USE [dbt_project];
    EXEC('
        create view "dbo"."trips__dbt_tmp__dbt_tmp_vw" as With cte as (SELECT 
    FHV_Trip_ID
    hvfhs_license_num,
    dispatching_base_num,
    originating_base_num,
    trip_miles,
    trip_time,
    base_passenger_fare,
    tolls,
    bcf,
    sales_tax,
    congestion_surcharge,
    airport_fee,
    tips,
    driver_pay
FROM dbo.base_trip_data)

select * from cte;
    ')

EXEC('
            SELECT * INTO "dbt_project"."dbo"."trips__dbt_tmp" FROM "dbt_project"."dbo"."trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS dbo.trips__dbt_tmp__dbt_tmp_vw')



    
    use [dbt_project];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'dbo_trips__dbt_tmp_cci'
        AND object_id=object_id('dbo_trips__dbt_tmp')
    )
    DROP index "dbo"."trips__dbt_tmp".dbo_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX dbo_trips__dbt_tmp_cci
    ON "dbo"."trips__dbt_tmp"

   


  
[0m17:28:17.225358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.225358 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.225358 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips', 'trips__dbt_backup'
[0m17:28:17.225358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.240980 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.240980 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */
USE [dbt_project];
      EXEC sp_rename 'dbo.trips__dbt_tmp', 'trips'
[0m17:28:17.240980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.240980 [debug] [Thread-1 (]: On model.dbt_proj.trips: COMMIT
[0m17:28:17.240980 [debug] [Thread-1 (]: Applying DROP to: "dbt_project"."dbo"."trips__dbt_backup"
[0m17:28:17.240980 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_proj.trips"
[0m17:28:17.240980 [debug] [Thread-1 (]: On model.dbt_proj.trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.trips"} */

      
    USE [dbt_project];
    EXEC('DROP table IF EXISTS "dbo"."trips__dbt_backup";');

[0m17:28:17.240980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:17.240980 [debug] [Thread-1 (]: On model.dbt_proj.trips: Close
[0m17:28:17.256601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dac5e3-7e91-42f2-a6ea-883ad1faaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA0AABFB0>]}
[0m17:28:17.256601 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbo.trips .................................... [[32mOK[0m in 0.17s]
[0m17:28:17.256601 [debug] [Thread-1 (]: Finished running node model.dbt_proj.trips
[0m17:28:17.256601 [debug] [MainThread]: On master: COMMIT
[0m17:28:17.256601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:17.256601 [debug] [MainThread]: Connection 'list_dbt_project' was properly closed.
[0m17:28:17.256601 [debug] [MainThread]: Connection 'list_dbt_project_dbo' was properly closed.
[0m17:28:17.256601 [debug] [MainThread]: Connection 'model.dbt_proj.trips' was properly closed.
[0m17:28:17.256601 [info ] [MainThread]: 
[0m17:28:17.256601 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m17:28:17.266208 [debug] [MainThread]: Command end result
[0m17:28:17.297551 [info ] [MainThread]: 
[0m17:28:17.298563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:17.299555 [info ] [MainThread]: 
[0m17:28:17.299555 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:28:17.300561 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:17.300561 after 4.07 seconds
[0m17:28:17.300561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9D30A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9D30B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F9DE61760>]}
[0m17:28:17.300561 [debug] [MainThread]: Flushing usage events
